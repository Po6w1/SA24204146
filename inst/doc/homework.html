<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="SA24204146" />

<meta name="date" content="2024-12-08" />

<title>Homework of all time</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework of all time</h1>
<h4 class="author">SA24204146</h4>
<h4 class="date">2024-12-08</h4>



<div id="hw-0-th" class="section level1">
<h1>HW 0-th</h1>
<div id="example-1-scatter-plot-with-regression-line-and-mathematical-formula" class="section level2">
<h2>Example 1: Scatter Plot with Regression Line and Mathematical
Formula</h2>
<p>We are fitting a simple linear regression model to show the
relationship between <code>mpg</code> and <code>wt</code> from the
<code>mtcars</code> dataset.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>wt, <span class="at">y=</span>mpg)) <span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Scatter Plot of MPG vs Weight&quot;</span>, <span class="at">x=</span><span class="st">&quot;Weight (1000 lbs)&quot;</span>, <span class="at">y=</span><span class="st">&quot;Miles Per Gallon&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>The model can be represented by the equation of a line:</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 x
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(y\)</span> is the
<code>mpg</code></p></li>
<li><p><span class="math inline">\(x\)</span> is the
<code>wt</code></p></li>
<li><p><span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are the regression
coefficients.</p></li>
</ul>
<p>The coefficients of the regression line is presented below:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt, <span class="at">data=</span>mtcars)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code></pre></div>
<pre><code>## (Intercept)          wt 
##   37.285126   -5.344472</code></pre>
</div>
<div id="example-2-table-with-summary-statistics-and-boxplot" class="section level2">
<h2>Example 2: Table with Summary Statistics and Boxplot</h2>
<p>We summarize the basic statistics of the <code>mpg</code> column in
the <code>mtcars</code> dataset.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">summary</span>(mtcars<span class="sc">$</span>mpg)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   10.40   15.43   19.20   20.09   22.80   33.90</code></pre>
<p>Now let’s visualize the distribution of <code>mpg</code> using a
boxplot.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">boxplot</span>(mtcars<span class="sc">$</span>mpg, <span class="at">main=</span><span class="st">&quot;Boxplot of Miles Per Gallon&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Miles Per Gallon&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>The summary table shows the <strong>minimum</strong>,
<strong>maximum</strong>, <strong>median</strong>, and other key values
of <code>mpg</code>, while the boxplot provides a quick visualization of
its distribution. According to the boxplot, we can see that most values
are within the interquartile range, except for a few outliers.</p>
<p>For a deeper understanding, consider the following mathematical
representation of a boxplot:</p>
<p><span class="math display">\[
Q_1 = \text{lower quartile}, \quad Q_3 = \text{upper quartile}, \quad
IQR = Q_3 - Q_1
\]</span></p>
<p>where <span class="math inline">\(IQR\)</span> is the interquartile
range.</p>
</div>
<div id="example-3-correlation-matrix-with-heatmap" class="section level2">
<h2>Example 3: Correlation Matrix with Heatmap</h2>
<p>The correlation coefficient <span class="math inline">\(r\)</span>
between two variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> is defined as:</p>
<p><span class="math display">\[
r = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i -
\bar{x})^2 \sum (y_i - \bar{y})^2}}
\]</span></p>
<p>where <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span> are the mean values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, respectively.</p>
<p>The correlation matrix shows the relationships between several
variables in the <code>mtcars</code> dataset.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(mtcars)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(cor_matrix, <span class="at">caption=</span><span class="st">&quot;Correlation Matrix of MTCars Dataset&quot;</span>)</span></code></pre></div>
<table>
<caption>Correlation Matrix of MTCars Dataset</caption>
<colgroup>
<col width="3%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mpg</td>
<td align="right">1.0000000</td>
<td align="right">-0.8521620</td>
<td align="right">-0.8475514</td>
<td align="right">-0.7761684</td>
<td align="right">0.6811719</td>
<td align="right">-0.8676594</td>
<td align="right">0.4186840</td>
<td align="right">0.6640389</td>
<td align="right">0.5998324</td>
<td align="right">0.4802848</td>
<td align="right">-0.5509251</td>
</tr>
<tr class="even">
<td align="left">cyl</td>
<td align="right">-0.8521620</td>
<td align="right">1.0000000</td>
<td align="right">0.9020329</td>
<td align="right">0.8324475</td>
<td align="right">-0.6999381</td>
<td align="right">0.7824958</td>
<td align="right">-0.5912421</td>
<td align="right">-0.8108118</td>
<td align="right">-0.5226070</td>
<td align="right">-0.4926866</td>
<td align="right">0.5269883</td>
</tr>
<tr class="odd">
<td align="left">disp</td>
<td align="right">-0.8475514</td>
<td align="right">0.9020329</td>
<td align="right">1.0000000</td>
<td align="right">0.7909486</td>
<td align="right">-0.7102139</td>
<td align="right">0.8879799</td>
<td align="right">-0.4336979</td>
<td align="right">-0.7104159</td>
<td align="right">-0.5912270</td>
<td align="right">-0.5555692</td>
<td align="right">0.3949769</td>
</tr>
<tr class="even">
<td align="left">hp</td>
<td align="right">-0.7761684</td>
<td align="right">0.8324475</td>
<td align="right">0.7909486</td>
<td align="right">1.0000000</td>
<td align="right">-0.4487591</td>
<td align="right">0.6587479</td>
<td align="right">-0.7082234</td>
<td align="right">-0.7230967</td>
<td align="right">-0.2432043</td>
<td align="right">-0.1257043</td>
<td align="right">0.7498125</td>
</tr>
<tr class="odd">
<td align="left">drat</td>
<td align="right">0.6811719</td>
<td align="right">-0.6999381</td>
<td align="right">-0.7102139</td>
<td align="right">-0.4487591</td>
<td align="right">1.0000000</td>
<td align="right">-0.7124406</td>
<td align="right">0.0912048</td>
<td align="right">0.4402785</td>
<td align="right">0.7127111</td>
<td align="right">0.6996101</td>
<td align="right">-0.0907898</td>
</tr>
<tr class="even">
<td align="left">wt</td>
<td align="right">-0.8676594</td>
<td align="right">0.7824958</td>
<td align="right">0.8879799</td>
<td align="right">0.6587479</td>
<td align="right">-0.7124406</td>
<td align="right">1.0000000</td>
<td align="right">-0.1747159</td>
<td align="right">-0.5549157</td>
<td align="right">-0.6924953</td>
<td align="right">-0.5832870</td>
<td align="right">0.4276059</td>
</tr>
<tr class="odd">
<td align="left">qsec</td>
<td align="right">0.4186840</td>
<td align="right">-0.5912421</td>
<td align="right">-0.4336979</td>
<td align="right">-0.7082234</td>
<td align="right">0.0912048</td>
<td align="right">-0.1747159</td>
<td align="right">1.0000000</td>
<td align="right">0.7445354</td>
<td align="right">-0.2298609</td>
<td align="right">-0.2126822</td>
<td align="right">-0.6562492</td>
</tr>
<tr class="even">
<td align="left">vs</td>
<td align="right">0.6640389</td>
<td align="right">-0.8108118</td>
<td align="right">-0.7104159</td>
<td align="right">-0.7230967</td>
<td align="right">0.4402785</td>
<td align="right">-0.5549157</td>
<td align="right">0.7445354</td>
<td align="right">1.0000000</td>
<td align="right">0.1683451</td>
<td align="right">0.2060233</td>
<td align="right">-0.5696071</td>
</tr>
<tr class="odd">
<td align="left">am</td>
<td align="right">0.5998324</td>
<td align="right">-0.5226070</td>
<td align="right">-0.5912270</td>
<td align="right">-0.2432043</td>
<td align="right">0.7127111</td>
<td align="right">-0.6924953</td>
<td align="right">-0.2298609</td>
<td align="right">0.1683451</td>
<td align="right">1.0000000</td>
<td align="right">0.7940588</td>
<td align="right">0.0575344</td>
</tr>
<tr class="even">
<td align="left">gear</td>
<td align="right">0.4802848</td>
<td align="right">-0.4926866</td>
<td align="right">-0.5555692</td>
<td align="right">-0.1257043</td>
<td align="right">0.6996101</td>
<td align="right">-0.5832870</td>
<td align="right">-0.2126822</td>
<td align="right">0.2060233</td>
<td align="right">0.7940588</td>
<td align="right">1.0000000</td>
<td align="right">0.2740728</td>
</tr>
<tr class="odd">
<td align="left">carb</td>
<td align="right">-0.5509251</td>
<td align="right">0.5269883</td>
<td align="right">0.3949769</td>
<td align="right">0.7498125</td>
<td align="right">-0.0907898</td>
<td align="right">0.4276059</td>
<td align="right">-0.6562492</td>
<td align="right">-0.5696071</td>
<td align="right">0.0575344</td>
<td align="right">0.2740728</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<p>We can also visualize this with a heatmap.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">heatmap</span>(cor_matrix, <span class="at">symm=</span><span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">&quot;Heatmap of Correlation Matrix&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw-1-st" class="section level1">
<h1>HW 1-st</h1>
<div id="question-1-3.4" class="section level2">
<h2>Question 1 (3.4)</h2>
<p>The Rayleigh density is</p>
<p><span class="math display">\[
f(x)=\frac x{\sigma^2} e^{-x^2/(2\sigma^2)},\quad x\geq0, \sigma&gt;0.
\]</span></p>
<p>Develop an algorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution. Generate
Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for
several choices of <span class="math inline">\(\sigma &gt; 0\)</span>
and check that the mode of the generated samples is close to the
theoretical mode <span class="math inline">\(\sigma\)</span> (check the
histogram).</p>
</div>
<div id="answer-1-3.4" class="section level2">
<h2>Answer 1 (3.4)</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Function to generate random samples from Rayleigh distribution</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>generate_rayleigh_samples <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma) {</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="co"># Generate uniform random samples</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="co"># Transform the uniform samples to Rayleigh samples</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  rayleigh_samples <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u))</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="fu">return</span>(rayleigh_samples)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>}</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">5000</span>, <span class="dv">10000</span>) <span class="co"># Different sample sizes</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>sigmas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="co"># Different values for sigma</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co"># Plotting histograms</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">length</span>(sample_sizes)))</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="cf">for</span> (sigma <span class="cf">in</span> sigmas) {</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> sample_sizes) {</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>    <span class="co"># Generate Rayleigh samples</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>    samples <span class="ot">&lt;-</span> <span class="fu">generate_rayleigh_samples</span>(n, sigma)</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>    </span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>    <span class="co"># Create a histogram</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>    <span class="fu">hist</span>(samples, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Rayleigh(σ =&quot;</span>, sigma, <span class="st">&quot;) n =&quot;</span>, n),</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;Value&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span> <span class="sc">*</span> sigma), <span class="at">breaks =</span> <span class="dv">30</span>)</span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>    </span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>    <span class="co"># Add the theoretical density curve</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>    x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span> <span class="sc">*</span> sigma, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a>    <span class="fu">lines</span>(x_vals, (x_vals <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x_vals<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a>    </span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a>    <span class="co"># Calculate and display the mode</span></span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>    mode_estimate <span class="ot">&lt;-</span> <span class="fu">max</span>(samples)</span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a>    <span class="co"># legend(&quot;topright&quot;, legend = paste(&quot;Mode est.:&quot;, round(mode_estimate, 3)), col = &quot;red&quot;, lty = 1)</span></span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a>  }</span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a>}</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAACsAAFUAAP8AKysAK1UAK4AAVVUAVaorAAArACsrAFUrK1UrK4ArVVUrVYArVaorgNRVAABVACtVAFVVKwBVKytVK1VVK4BVVStVgNRVqtRVqv+AKwCAKyuAK1WAVSuAqoCA1NSA1P+qVQCqVSuq1ICq1NSq1P+q/6qq///UgCvUgFXUqlXU1IDU/6rU////qlX/1ID/1Kr//6r//9T////FNxbZAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKrElEQVR4nO2di3oaNxCFhd2kkDRNjeP0Bk5aaJuYNvVi4P0frau9GJuVdHSZsWfTOV9Tk1j7j+ZIu1pJwJqDKijz3BWQLjUISA0CUoOA1CAgNQhIDQJSg4DUICA1CEgNAlKDgNQgIDUISA0CUoOA1CAgNQhIDQJSg4DUIKDOoP3y7Kb/p4evd/OXt92LRQiz7g7ZHA99JE4+b91jDdpMVv4Qdx9Nd8h2duEswcnnrbvDoIfqg+yXXTB3ocmsO9xXjpPPW3drX2UWTZC7a2Pe3rYBtzPz/dXZzW7+zZWZLOq/Tg/N72tNB0F+/Ou+juu2tXbzFx/tcYclM5+T3RpkFvYXFlw7/umudr17fVsZ+3Oyal9f1Aee1b/vuuumiWe6TnlsxI1ZdA3THNf8nZPPyW6Lzqa7DmxB9nztX/fB7E97bPt74zpRj0Gq9vf9cbb5WPmc7LYHLc/+nLXAzthFDz0N0hjcQbytcBpkz8znZLdFq8nPdc+7b4XuiEAruIbMQBBmPmvdmx60m5uXtz3wk/3Zw/8xxyDH89g5IjjO4z4IM5+17o1Bh7X1rR0Jrox58al9Xc3M26tjkPuR4C0Yxe9HgvsgvHzeuncGee4zH9+ABe4lHh0zKMfL5637oTnFXLdZ2/ru6W7+4K7BN4c40W5+OlAw81nrbmWOt0SP9PfMmDcPuGA+06s6rUvFzGdn62weSA0CUoOA1CAgNQhIDQJSg4DUICA1CEgNAlKDgNQgIDUISA0CUoOA1CAgNQhIDQJSg4DUICA1CEgNAlKDgHINMtzOcgeI5atBqFw2X0gC3Hw1CJXL5lMksH21qoxx74mrQYfD/nq1fXN7sH8cAcr5FA0QLuYPQGLQ7t3N9ofmhytAOZ+iAYLFAgFoTrE/VnWIgzXJEaAcT9EAwWKBADQG7Zf27abON4BJaYBwMX8A9lHsXEgDhIv5AxiSBFode2j7BuaGfH5Oxncqtv7ZoxihQQO2/R+hQUUNEJOmK4BhbGHuHkRukOsYGoOqxu/Tj3OpQb32y+btp6e3EZZ/bngbIJofNoggQEjduXt6G0HGp2iA8I0icwv3/NdMBlE0ALpRLA4Q1HbG2kMpGiCqB3G1cKBOYhoATFZ5WzhQJzH83FFMTALcfDUoonBmALa5xhMZFFd/wQbJ4GcaZMQkwM3/nxoUX3+5BvFdhNr6R/LzDWJNQA0CfDWokZ3kbYZLuk/QAEQGcSdQ86upc7VATgMgg7gT2Fw4VwvkNAAyiDeB+csvv9Q/fhLcAGGDmBOwywWT1fbVcLVATgOAizRvAv46yWkACcO8Y1tJTgNk7ovJSSBCRfWX0IMc/BovpAEyDSJKwLutxG1QPD9zX4wmAf+2kpwGyNwXo0nAv60kpwEy98VoExhuK8lpgMx9MaJTwLut1PCLF5wo6p+5L/YkF9HyFTmC+peMYlxLik/Fjy2cHUANAgHUIBBADQIBxm5QFF+wQWzD5FMZxJ2ADL4ahAvzBhg7Xw3ChXkDQNmPywjmY4MYE9jN2yXQM+dkUgYfbPvwJtA8LYazBxHw0WyeNwH7LIzfZfPRKcadwGG/PF2NkMWH1yDuBNx1ksN//lHMuW8lh5+5cdgGYJqMCexB7icmwADRBmXyo49g5Pc5bozz0UnhAAk9yM0P7lsl9SA2/oMcN2bwDBUQIO0UG/LD+1appxgPv8+xsi1wuoGEAiQY5OSH962SDGLj99egwbPtYgIkXIOc/PC+VdI1iI1fsHFIMIoF961IphpE16Cmjzi+ogMEiO9BHr63Tqk9iI9vc2y/gMLzHRehAJEGZfPjivPyH/SgaGX2oHR+9BGMfNPgPzfrGnGP4bLHmCSD0vlpBrHy8+ZiaQal88VNNQ7VdDf3PWrPcUyyQYn8ZIP4+G2O++vVZur8qi/3MakGpfJTDWLk31+k1xcJw2SqQan8jIs0F7/rQR8+X644e1Aiv00g3iFGfn8NMi//vTxdOfQfYxITSOWnGsTILxnFyoeZykx+mw2G5wyDkpRj0MZ9H+FLINkgN99+T+Ns4VgtaPHFfG/9E/jdRdrdPckS8PDry+r+w41jtYCIT1H/4FSDLgE3v1stGH6ei4hPUf/uFFs7b7LIEvDwD81HuarhagERn6L+/YKZ+xymSsDH99WJik9Q/7xRLLmFgxpuK9HyT5VjUN0Evw62mHsRJBDkD+tEyy+qf3cnvVysFwl3oqkJjJh/nIstEuYyGaOMk+/bVqLiu5Xbg6rhkiVVAh6+d1uJiE9R/+M1yDEIkCXg4Xu3lYj4FPUPv8MMJVC4pOjdViIaxSgaIG9fjMgg77YSkUEUDdCm2Mz1HDejKIFYg3x8X51SDcqtf1Rlaq3t5W2/jH17R7JB2fzIAzj57baP81SNCBBnUD4/rjwrXw2ChdUgUNj7fvGIAJEGZfPjyrPyy2bzPFurEmfzmQHUIBCA2SAmh5LqX2QQdwIS+GoQLMwcIKh6KjANTCYl8MMGMSdgJ5PV2Y1oPpzNcybQvffys2Q+Xg9iTKD9rN7uvW85QgI/3IOYEzjYjeGD7aRy+egaxJuAr06C+BKGee++lQR+3gfqBLUwN19CDxLNf16DwL6VBH7YIOYE0L6VBH7Utg9XAmjfSgK/aOOQqoXZbhQJ+EUbhxSTSdZrEAEfTlZZE/DVSRBfh3lYmDlAGZ9lTfcrMognwBMaxJ2AAL4aBAszBxg7Xw2ChZkDjJ2vBsHCzAHGzleDYGHmAGPnh5c7fN/ESZTAGPjhHuT+qCNdC2N+2WSMoP6gAo7PP1Am8Px8SCi9BnFMt41h5qfUP2tf7J5Pk4BoflYPIk5ANL/QIJZxWBQ/a1+MLIER8LP2xagSGAM/a1+MKoEx8LP2xahbWDI/a1+M7BoxAr6OYqgwd4Cx89UgVJg7wNj5pQZxTAYe88nxaXw1CBUuDqAGgQBqEAigBoEA3AY9cwPIN4i+CyXxS9eDys6BEfBL14OKEhgDv3Q9qCiBOH7+OUxR/9L1oCaD3BQi+Zl0Gn7pepANkN/GkfxcPAW/eBQryyCSTztSJvELNw47lVUY8wt36Ev4PN++8RVJDQLKuVGk0wj4OTeKZBoDP+dGkUxj4OfcKB4SBoGgxsDPuVFsDjr9k6UR8LNikyUwAr4aBPhqEOCrQYCvBgG+TjWA1CAgNQhIDQJSg4DUICA1CEgNAlKDgDIMqgbP+NjEPtFihPx0g3aXq5MVqO2MMgFh/HSDtm9u948eBre//pkyAWH8dIOq6clDKTcXpKeAMH65QXWLsCbwzPzyU6x5MhNhBsL4FBdp2lFGGF+HecDXG0UgNQhIDQJSg4DUICA1CEgNAlKDgNQgIDUISA0CUoOA1CAgNQhIDQJSg4DUIKA0g7qH3m+677ck/wyBQH5iD2q++rN7AzvHhyzk8RMNavYDLHdjzLR+8aXdIqjs3ygkj596DdrYXaULG2P37qYPYCOuF/jgMfJTDaqxzYdntjMzWfUBKrqtK3H85FFsvbCNYJ/fe9kGqH9WNP1fJD/ZoO1371fN/m3VtMDrm+2rVf3f/YWvVNL4yQbtl3Yg2M3Nt/NFfe6uzYv3hBdReXy9UQRSg4DUICA1CEgNAlKDgNQgIDUISA0CUoOA1CAgNQhIDQJSg4DUICA1COg/Vv0JYpXnBqUAAAAASUVORK5CYII=" /><!-- --><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAmVBMVEUAAAAAACsAAFUAAP8AKysAK1UAK4AAVVUAVaorAAArACsrAFUrK1UrK4ArVVUrVYArgNRVAABVACtVAFVVKwBVKytVK4BVVStVgNRVqtRVqv+AKwCAKyuAK1WAVSuAqoCA1P+qVQCqVSuq1ICq1P+q/6qq///UgCvUgFXUqlXU1IDU/6rU////qlX/1ID/1Kr//6r//9T///8En74DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKBUlEQVR4nO2dDX/aNhDGlWTpoF3W0KZ7gXSDrYV1iwnw/T/c/A4xlk8n3cUSfZ5tv6TFek7+W9adbA+bAzQoM3YHYhcAEQIgQgBECIAIARAhACIEQIQAiBAAEQIgQgBECIAIARAhACIEQIQAiBAAEQIgQgBECIAI1YD2i+t181env+9mb57qX+ZWj/1fU3O7LH/dHJu+3ETRX7fvroA2V0trkG/mt8Oq+nw7ve/vh6K/bt97AJ2qCbJf1MFsysx8aDtNf92+m9w836AM8vxozPunKuB2an5+uF7vZj88mKt5/sfJofw816QvyKoK0hyN3ez2j6LdYaHsr+ldAco/zD8ojHPiX55z6vXvT5kpfl4tq9/v84bX+ef1cN2U8UwzKDPT/v28ClK1K/+s6a/pXW06nexq48KoOF+b35tgxc+ibfW56TtR82M2aaLdV0GqdsXhU/XX9K5G0OL672llWIOdN6bdICXg2uTlUchjNH7dIHtlf03vatPs6td8hLVH4XA4EEfhPGXuF6bNE2dBlP1V+16OoN3MvHlqDL8UPxvzb+YY5Hge98z0mTlGbs/jJoiyv2rfS0D5HH5fp8rnB2Nuv1S/Z1Pz/uEYpM0E73sy4epkxLaZoA2i66/b9xqQpc58WYARtYR9O11/3b4fylOsr8zaTq/Xz7OTqsG2huhoN+smCmV/1b4XMseS6IX+mRpzd+I7tJ45UdbtS6bsr+6N1TwhACIEQIQAiBAAEQIgQgBECIAIARAhACIEQIQAiBAAEQIgQgBE6LIBZeUF1YE7z7R8Ad3k/0Sv/aK8Ura9c7rk2q+LBrT7uD754aeLBtSMoHcAZNF2ijlIW5cNKDNXfx7vvXtpXEACaXhI+8fldjofJYsZEUCDaVigQsvT1/7zujeLmRtH/1EBDaZhAUD1Adj90hyA6rmXwtncOPY/ihHUk4ar3QjV9u2yeACncwqnA2ggDcsA6ldCgAYCCALqnsKvA8jIZDFbGtYeQc799wckMIQG0rBzlvFQOoAG07BenfVKgATOMYk07ODfHaHpAJJIw0Oy1FkJAbKYH4RH0LvEAQUd4UH111nJATozP0gBEvAHIIeNfWLIABJIwx5KB5BEGvZQOoCG07BaKa0IqC3kZEdQfxpOEVDbRqpQHErDyoAc++8JKPdXz2IANOAPQIT/ZQDS2gMAov3dd0DbH4AcNvYIAEBEGwAi2gAQ0SZRQB5Lpe8LUOsPQIS/e6ELQA6d8QygtgcAZHdubxwC0LA/ADn4pwDIetcBgErZ7zoAUCn7XQcAKmW/6/AqgBTrLKk5yHrXAYAcAgBQ8yWMY81ByoDc+k/OQdn1GoBsKsnsPn4FIIv2j8X0vPvUZrF2rZQIIIFCl5qDijzf/Xq4ZABJFLoRZ7Fwf4lC1wXQSJN0uL9EoTvuCNJeDAsUuqMCGncxLAFI+QirL4YFCt1RL3doL4YlCt1xL3coL4YlCt2IL3cIjCCBQjfockdwJae9GBYodIOyWCigcRfDCQB6pcWweiXd00ZoBI26GE4A0LiL4RQAEf7BTuqXO6xtRAGpTdJylzv635gw0IYJyNPfuYXFX/Jyx8b0vjrJ1qYMwDnEPv6cEdTrL3y5Y2Ns71A5b8MG1O8vuhju8Re83JEVR8Dx+/R8APX6Cy6GffrPmoN6321HBHDfA4s/NUcw5jif/itmsYpPcJqh5ogYyoh6BFU1v+O3xfEB2fylFsPc/hseoP2i2l+3t0zxAfH9eYD4/kxA3G879RxBDH+vEcTwN+5zqCntv86K7V2/kJELiO9vWIB8/Z0BcSU2SVv9eYB8/TmAsslu5lAmVlw8ADn6N31iA/LyZwDaPy43E+dv9OQD4vozdsDLn9H/dpJe3eumeZY/F5Bi/+sR9Pnrh6XmCGL6s0eQXv+bOci8+e/DcnhTvwCp+8eZxSLyrwFtNOugpP3rSdp5eLIDROXvUabEudSIyL8+xVauRRY7QOr+zQUz3TnC1d/jFGD511GQxQT9a0D5Ifj9UbFOSde/rqQX89Vcs5JO1/+4Fpsrr8US9T8ZQZnWJdek/Y9zkPsbXvzmiET9kcXIjZUDpO5fASrXes7FaBvAeQ88/Z0BKfqXgFbF9LZfnD8eYXu4gAnI6m/rExOQpn9128fyDiLrwwU8QNxXDfJvKyn6DwKyPlwAQJWsDxd8b4Bm1fbnhYTt4QImIKu/rU9MQFZ/gTk0KM0r5WHxx2tC5tBxAQllSZsk5tBRAQllSdI/ZA4dBGQ5uaM6woMSmEOHR1D3bkHtG9MR9pDkKdZ7CSGqI+yhdOagFPxdAOnNEbY+Sc1xAnPoZY8ggTl0VEDaWVJiDh0GpFzIaWdJi+QAaRdy6lmykl4lrV7I2foUkb/TCFIu5KI+AMNzUAKF3KAu/XJHDIthXO4gFAYocA+Sv9xhbSMEKP3LHZY2RngEJXy5o7+NFKDRs6RDgHEBWfwBiPCXmuMk/AGI3NgjAAARbQCIaANARJvUAXH6D0BkZ5QD+PgDEOEPQIR/uoAaW9MG0PhyhIQB1W0AiGhzBKSyB3qAzs8Ah854hFED9EqncLqAzvy1AdH9jxzQ+P4ARG2sHSB1fwCiNtYOkLo/AFEbawdI3R+AqI21A6TuHwpIYw9e7IBCKQ1ADH+y/7EDGt0fgKiNgwPInwMAFJU/tfHgp5ZnCMV2IAZ/wsLrSXupHYjCn/DwetL+NEDIJOHif6PsT/Xf60l7KUAp+Hs9af8yQMA54OTvby/R/+AsFnQOJOAfnMWCDnEC/sFZrDgExvMsc/X3c5fxD89iJSGf7qfhz8tijaPpym8HUvD3yWJySsBf49buRcnniwWkFbU/RhAhACLkUygeGElgWAn4+xSKZaPufz5Kwd+nUBTbgRT8fS53iB/hmP29CkWpHUjB3yu22A4k4A9AhD/qIEIARAiACAEQIQAiBECEAIgQABECIEIegLLOOz42xkykuhOfPx/Q7sPyxfJ4e/dUr5plFJk/H1BhePoyuO6fQxWZPx9QNum8lHI7Fb2xFZl/OKDsjewpEJl/+Cm2ua+CSiky//BJuvhC35Xri5nS8xdI8yvlNDyuPwpFQgBECIAIARAhACIEQIQAiBAAEQIgQgBECIAIARAhACIEQIQAiBAAEQIgQjxA9UvvN/Vr084eQA5VhP7MEVS+Ua69CSC+AxH6MwGV9wMK3/J+7fbu3+oWQSZ12Tg+f+4ctCnuKt0XMXYf102AIuJK5tZVdP5cQLlt+WT/dmqulk2A8v8ZkbkzE50/O4ut5sVByK7Xxf2lIkD+U/K+Xmz+bEDbnz4ty1uRWXkE3q23b5f5v2J3h2PzZwPaL4pEsJuZH2fz/NxdmdtPgpNofP4oFAkBECEAIgRAhACIEAARAiBCAEQIgAgBECEAIgRAhACIEAARAiBCAETofw8FTjZVIainAAAAAElFTkSuQmCC" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Check theoretical mode value</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Theoretical mode for Rayleigh(σ):&quot;</span>, sigmas, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Theoretical mode for Rayleigh(σ): 1 2 3</code></pre>
</div>
<div id="question-2-3.11" class="section level2">
<h2>Question 2 (3.11)</h2>
<p>Generate a random sample of size <span class="math inline">\(1000\)</span> from a normal location mixture. The
components of the mixture have <span class="math inline">\(N(0,
1)\)</span> and <span class="math inline">\(N(3, 1)\)</span>
distributions with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 =
1 − p_1\)</span>. Graph the histogram of the sample with density
superimposed, for <span class="math inline">\(p_1 = 0.75\)</span>.
Repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical
distribution of the mixture appears to be bimodal. Make a conjecture
about the values of <span class="math inline">\(p_1\)</span> that
produce bimodal mixtures.</p>
</div>
<div id="answer-2-3.11" class="section level2">
<h2>Answer 2 (3.11)</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Function to generate random samples from a normal location mixture</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>generate_normal_mixture <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p1) {</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> p1</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  mixture_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  </span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> p1) {</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>      mixture_samples[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)  <span class="co"># Sample from N(0, 1)</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>      mixture_samples[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">1</span>)  <span class="co"># Sample from N(3, 1)</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>    }</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>  }</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>  </span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>  <span class="fu">return</span>(mixture_samples)</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>}</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>p1_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>) <span class="co"># Different mixing probabilities</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co"># Set up plotting</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="co"># par(mfrow = c(length(p1_values), 1))</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="cf">for</span> (p1 <span class="cf">in</span> p1_values) {</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a>  <span class="co"># Generate samples</span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">generate_normal_mixture</span>(sample_size, p1)</span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a>  </span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a>  <span class="co"># Create histogram</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a>  <span class="fu">hist</span>(samples, <span class="at">probability =</span> <span class="cn">TRUE</span>, </span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Normal Mixture (p1 =&quot;</span>, p1, <span class="st">&quot;)&quot;</span>), </span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Value&quot;</span>, </span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a>       <span class="at">breaks =</span> <span class="dv">30</span>, </span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, </span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a>       <span class="at">border =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a>  </span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a>  <span class="co"># Overlay density estimation</span></span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a>  dens <span class="ot">&lt;-</span> <span class="fu">density</span>(samples)</span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a>  <span class="fu">lines</span>(dens, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a>  </span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a>  <span class="co"># Add theoretical density components</span></span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a>  x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb13-43"><a href="#cb13-43" tabindex="-1"></a>  theoretical_density <span class="ot">&lt;-</span> p1 <span class="sc">*</span> <span class="fu">dnorm</span>(x_vals, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb13-44"><a href="#cb13-44" tabindex="-1"></a>                         (<span class="dv">1</span> <span class="sc">-</span> p1) <span class="sc">*</span> <span class="fu">dnorm</span>(x_vals, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb13-45"><a href="#cb13-45" tabindex="-1"></a>  <span class="fu">lines</span>(x_vals, theoretical_density, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb13-46"><a href="#cb13-46" tabindex="-1"></a>  </span>
<span id="cb13-47"><a href="#cb13-47" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Kernel Density&quot;</span>, <span class="st">&quot;Theoretical Density&quot;</span>), </span>
<span id="cb13-48"><a href="#cb13-48" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb13-49"><a href="#cb13-49" tabindex="-1"></a>}</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Summary of observations</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Observe the plots to analyze bimodality for different values of p1:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Observe the plots to analyze bimodality for different values of p1:</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Conjecture: The mixture appears bimodal when p1 is around 0.25 to 0.5 and becomes more unimodal as p1 approaches 1.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Conjecture: The mixture appears bimodal when p1 is around 0.25 to 0.5 and becomes more unimodal as p1 approaches 1.</code></pre>
</div>
<div id="question-3-3.20" class="section level2">
<h2>Question 3 (3.20)</h2>
<p>A <em>compound Poisson process</em> is a stochastic process <span class="math inline">\(\{X(t),t\ge 0\}\)</span> that can be represented
as the random sum <span class="math inline">\(X(t)=\sum_{i=1}^{N(t)}Y(t),t&gt;0\)</span>, where
<span class="math inline">\(\{N(t),t\ge 0\}\)</span> is a Poisson
process and <span class="math inline">\(Y_1,Y_2,\ldots\)</span> are iid
and independent of <span class="math inline">\(\{N(t),t\ge 0\}\)</span>
Write a program to simulate a compound Poisson(<span class="math inline">\(\lambda\)</span>)–Gamma process (<span class="math inline">\(Y\)</span> has a Gamma distribution). Estimate the
mean and the variance of <span class="math inline">\(X(10)\)</span> for
several choices of the parameters and compare with the theoretical
values. Hint: Show that <span class="math inline">\(E[X(t)]=\lambda
tE[Y_1]\)</span> and <span class="math inline">\(Var(X(t))=\lambda
tE[Y_1^2]\)</span>.</p>
</div>
<div id="answer-3-3.20" class="section level2">
<h2>Answer 3 (3.20)</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Function to simulate Compound Poisson-Gamma process</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>simulate_compound_poisson_gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, shape, rate, <span class="at">t =</span> <span class="dv">10</span>, <span class="at">n_sim =</span> <span class="dv">10000</span>) {</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="co"># Initialize variables to store results</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  X_t_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  </span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="cf">for</span> (sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>    <span class="co"># Generate N(t) from Poisson process</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>    N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda <span class="sc">*</span> t)</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>    </span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>    <span class="co"># Generate Y from Gamma distribution for each arrival</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>    Y_samples <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t, <span class="at">shape =</span> shape, <span class="at">rate =</span> rate)</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>    </span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>    <span class="co"># Compute X(t) as the sum of Y_samples</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>    X_t_samples[sim] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y_samples)</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>  }</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>  </span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>  <span class="co"># Calculate empirical mean and variance</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>  empirical_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(X_t_samples)</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>  empirical_variance <span class="ot">&lt;-</span> <span class="fu">var</span>(X_t_samples)</span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>  </span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a>  <span class="co"># Theoretical values</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>  E_Y1 <span class="ot">&lt;-</span> shape <span class="sc">/</span> rate                             <span class="co"># Mean of Gamma</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>  E_Y1_squared <span class="ot">&lt;-</span> (shape<span class="sc">*</span>(shape <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">/</span> (rate<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># Variance of Gamma + (E[Y])^2</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a>  </span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a>  theoretical_mean <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> E_Y1</span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a>  theoretical_variance <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> E_Y1_squared</span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a>  </span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a>  <span class="co"># Display results</span></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Simulated mean X(10):&quot;</span>, empirical_mean, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Simulated variance X(10):&quot;</span>, empirical_variance, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Theoretical mean X(10):&quot;</span>, theoretical_mean, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Theoretical variance X(10):&quot;</span>, theoretical_variance, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a>}</span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a></span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a><span class="co"># Parameters for the simulation</span></span>
<span id="cb18-36"><a href="#cb18-36" tabindex="-1"></a>lambda_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>)          <span class="co"># Different values of lambda</span></span>
<span id="cb18-37"><a href="#cb18-37" tabindex="-1"></a>shape_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)               <span class="co"># Shape parameter for Gamma</span></span>
<span id="cb18-38"><a href="#cb18-38" tabindex="-1"></a>rate_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)                <span class="co"># Rate parameter for Gamma</span></span>
<span id="cb18-39"><a href="#cb18-39" tabindex="-1"></a></span>
<span id="cb18-40"><a href="#cb18-40" tabindex="-1"></a><span class="co"># Simulating for several parameter combinations</span></span>
<span id="cb18-41"><a href="#cb18-41" tabindex="-1"></a><span class="cf">for</span> (lambda <span class="cf">in</span> lambda_values) {</span>
<span id="cb18-42"><a href="#cb18-42" tabindex="-1"></a>  <span class="cf">for</span> (shape <span class="cf">in</span> shape_values) {</span>
<span id="cb18-43"><a href="#cb18-43" tabindex="-1"></a>    <span class="cf">for</span> (rate <span class="cf">in</span> rate_values) {</span>
<span id="cb18-44"><a href="#cb18-44" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Simulation results for lambda =&quot;</span>, lambda, <span class="st">&quot;shape =&quot;</span>, shape, <span class="st">&quot;rate =&quot;</span>, rate, <span class="st">&quot;:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb18-45"><a href="#cb18-45" tabindex="-1"></a>      <span class="fu">simulate_compound_poisson_gamma</span>(lambda, shape, rate)</span>
<span id="cb18-46"><a href="#cb18-46" tabindex="-1"></a>    }</span>
<span id="cb18-47"><a href="#cb18-47" tabindex="-1"></a>  }</span>
<span id="cb18-48"><a href="#cb18-48" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## Simulation results for lambda = 1 shape = 2 rate = 1 :
## Simulated mean X(10): 20.02922 
## Simulated variance X(10): 60.32618 
## Theoretical mean X(10): 20 
## Theoretical variance X(10): 60 
## 
## Simulation results for lambda = 1 shape = 2 rate = 1 :
## Simulated mean X(10): 20.00561 
## Simulated variance X(10): 60.7115 
## Theoretical mean X(10): 20 
## Theoretical variance X(10): 60 
## 
## Simulation results for lambda = 1 shape = 3 rate = 1 :
## Simulated mean X(10): 29.87475 
## Simulated variance X(10): 121.9297 
## Theoretical mean X(10): 30 
## Theoretical variance X(10): 120 
## 
## Simulation results for lambda = 1 shape = 3 rate = 1 :
## Simulated mean X(10): 29.97712 
## Simulated variance X(10): 120.6812 
## Theoretical mean X(10): 30 
## Theoretical variance X(10): 120 
## 
## Simulation results for lambda = 2 shape = 2 rate = 1 :
## Simulated mean X(10): 39.89353 
## Simulated variance X(10): 117.3498 
## Theoretical mean X(10): 40 
## Theoretical variance X(10): 120 
## 
## Simulation results for lambda = 2 shape = 2 rate = 1 :
## Simulated mean X(10): 40.05527 
## Simulated variance X(10): 116.996 
## Theoretical mean X(10): 40 
## Theoretical variance X(10): 120 
## 
## Simulation results for lambda = 2 shape = 3 rate = 1 :
## Simulated mean X(10): 59.9409 
## Simulated variance X(10): 245.335 
## Theoretical mean X(10): 60 
## Theoretical variance X(10): 240 
## 
## Simulation results for lambda = 2 shape = 3 rate = 1 :
## Simulated mean X(10): 59.58208 
## Simulated variance X(10): 234.8743 
## Theoretical mean X(10): 60 
## Theoretical variance X(10): 240 
## 
## Simulation results for lambda = 5 shape = 2 rate = 1 :
## Simulated mean X(10): 100.0506 
## Simulated variance X(10): 303.3319 
## Theoretical mean X(10): 100 
## Theoretical variance X(10): 300 
## 
## Simulation results for lambda = 5 shape = 2 rate = 1 :
## Simulated mean X(10): 100.1997 
## Simulated variance X(10): 294.4051 
## Theoretical mean X(10): 100 
## Theoretical variance X(10): 300 
## 
## Simulation results for lambda = 5 shape = 3 rate = 1 :
## Simulated mean X(10): 150.4463 
## Simulated variance X(10): 587.0084 
## Theoretical mean X(10): 150 
## Theoretical variance X(10): 600 
## 
## Simulation results for lambda = 5 shape = 3 rate = 1 :
## Simulated mean X(10): 150.1049 
## Simulated variance X(10): 595.434 
## Theoretical mean X(10): 150 
## Theoretical variance X(10): 600</code></pre>
</div>
</div>
<div id="hw-2-nd" class="section level1">
<h1>HW 2-nd</h1>
<div id="question-1-5.4" class="section level2">
<h2>Question 1 (5.4)</h2>
<p>Write a function to compute a Monte Carlo estimate of the <span class="math inline">\(Beta(3, 3)\)</span> cdf, and use the function to
estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x = 0.1, 0.2, . . ., 0.9\)</span>. Compare the
estimates with the values returned by the <code>pbeta</code> function in
R.</p>
</div>
<div id="answer-1-5.4" class="section level2">
<h2>Answer 1 (5.4)</h2>
<div id="step-1-define-the-monte-carlo-estimation-function" class="section level3">
<h3>Step 1: Define the Monte Carlo Estimation Function</h3>
<p>To estimate the CDF at a given <code>x</code> using Monte Carlo
simulation, we generate random samples from the <span class="math inline">\(Beta(3, 3)\)</span> distribution and calculate the
proportion of samples that are less than or equal to <code>x</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># Monte Carlo estimate for Beta(3,3) CDF</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>beta_cdf_mc <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n_sim =</span> <span class="dv">10000</span>) {</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="co"># Generate random samples from Beta(3,3)</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n_sim, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="co"># Estimate CDF as proportion of samples &lt;= x</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  <span class="fu">mean</span>(samples <span class="sc">&lt;=</span> x)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="step-2-monte-carlo-estimation-at-different-x-values" class="section level3">
<h3>Step 2: Monte Carlo Estimation at Different <code>x</code>
Values</h3>
<p>We will now use the <code>beta_cdf_mc</code> function to estimate the
CDF of the Beta(3, 3) distribution at several values of <code>x</code>,
specifically for <code>x = 0.1, 0.2, ..., 0.9</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Values of x</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co"># Monte Carlo estimates</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>mc_estimates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x_values, beta_cdf_mc)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co"># Display the Monte Carlo estimates</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>mc_estimates</span></code></pre></div>
<pre><code>## [1] 0.0086 0.0575 0.1637 0.3215 0.5004 0.6879 0.8372 0.9419 0.9910</code></pre>
</div>
<div id="step-3-comparison-with-pbeta" class="section level3">
<h3>Step 3: Comparison with <code>pbeta</code></h3>
<p>Now we will use R’s built-in <code>pbeta</code> function to compute
the exact values of the Beta(3, 3) CDF for the same values of
<code>x</code>. We will compare these values with our Monte Carlo
estimates.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Exact values using pbeta</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>exact_values <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(x_values, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co"># Display exact values</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>exact_values</span></code></pre></div>
<pre><code>## [1] 0.00856 0.05792 0.16308 0.31744 0.50000 0.68256 0.83692 0.94208 0.99144</code></pre>
</div>
<div id="step-4-compare-monte-carlo-estimates-with-exact-values" class="section level3">
<h3>Step 4: Compare Monte Carlo Estimates with Exact Values</h3>
<p>We can now create a table to compare the Monte Carlo estimates with
the exact values from <code>pbeta</code>. Additionally, we can calculate
the absolute difference between the two methods.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># Create a data frame to compare estimates</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  <span class="at">x =</span> x_values,</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>  <span class="at">Monte_Carlo_Estimate =</span> mc_estimates,</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>  <span class="at">Exact_Value =</span> exact_values,</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>  <span class="at">Difference =</span> <span class="fu">abs</span>(mc_estimates <span class="sc">-</span> exact_values)</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>)</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="co"># Display the comparison table</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>comparison</span></code></pre></div>
<pre><code>##     x Monte_Carlo_Estimate Exact_Value Difference
## 1 0.1               0.0086     0.00856    0.00004
## 2 0.2               0.0575     0.05792    0.00042
## 3 0.3               0.1637     0.16308    0.00062
## 4 0.4               0.3215     0.31744    0.00406
## 5 0.5               0.5004     0.50000    0.00040
## 6 0.6               0.6879     0.68256    0.00534
## 7 0.7               0.8372     0.83692    0.00028
## 8 0.8               0.9419     0.94208    0.00018
## 9 0.9               0.9910     0.99144    0.00044</code></pre>
</div>
<div id="step-5-visualize-the-results" class="section level3">
<h3>Step 5: Visualize the Results</h3>
<p>Finally, we will visualize the results by plotting both the Monte
Carlo estimates and the exact values returned by <code>pbeta</code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="co"># Plotting the estimates and exact values</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="fu">ggplot</span>(comparison, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Monte_Carlo_Estimate, <span class="at">color =</span> <span class="st">&quot;Monte Carlo Estimate&quot;</span>)) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Monte_Carlo_Estimate, <span class="at">color =</span> <span class="st">&quot;Monte Carlo Estimate&quot;</span>)) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Exact_Value, <span class="at">color =</span> <span class="st">&quot;Exact Value&quot;</span>)) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Exact_Value, <span class="at">color =</span> <span class="st">&quot;Exact Value&quot;</span>)) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Monte Carlo vs Exact CDF for Beta(3,3)&quot;</span>,</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;CDF&quot;</span>,</span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Method&quot;</span></span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-2-5.9" class="section level2">
<h2>Question 2 (5.9)</h2>
<p>The Rayleigh density is</p>
<p><span class="math display">\[
f(x)=\frac x{\sigma^2} e^{-x^2/(2\sigma^2)},\quad x\geq0, \sigma&gt;0.
\]</span></p>
<p>Implement a function to generate samples from a Rayleigh(<span class="math inline">\(σ\)</span>) distribution, using antithetic
variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X^{\prime}}{2}\)</span> compared with
<span class="math inline">\(\frac{X+X^{\prime}}{2}\)</span> for
independent <span class="math inline">\(X_1,X_2\)</span>?</p>
</div>
<div id="answer-2-5.9" class="section level2">
<h2>Answer 2 (5.9)</h2>
<div id="step-1-function-to-generate-rayleighσ-samples" class="section level3">
<h3>Step 1: Function to Generate Rayleigh(σ) Samples</h3>
<p>We can generate Rayleigh distributed samples by first generating
uniform random variables, and then transforming them using the inverse
CDF of the Rayleigh distribution.</p>
<p>The inverse CDF of the Rayleigh distribution is given by:</p>
<p><span class="math display">\[
X = \sigma \sqrt{-2 \log(U)},
\]</span></p>
<p>where <span class="math inline">\(U\)</span> is a uniform random
variable on <span class="math inline">\((0, 1)\)</span>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># Function to generate Rayleigh samples</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>rayleigh_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, n) {</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>  <span class="fu">return</span>(sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U)))</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="step-2-generate-samples-using-antithetic-variables" class="section level3">
<h3>Step 2: Generate Samples Using Antithetic Variables</h3>
<p>To reduce the variance of the estimator, we use antithetic variables.
We generate one uniform random variable <span class="math inline">\(U\)</span>, and then generate a second sample as
<span class="math inline">\(1 - U\)</span>. This ensures the two samples
are negatively correlated, helping reduce variance.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co"># Function to generate Rayleigh samples with antithetic variables</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>rayleigh_antithetic <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, n) {</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U))</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> U))</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">X1 =</span> X1, <span class="at">X2 =</span> X2))</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="step-3-estimate-and-compare-variances" class="section level3">
<h3>Step 3: Estimate and Compare Variances</h3>
<p>Next, we estimate the variance of <span class="math inline">\(\frac{X
+ X&#39;}{2}\)</span> using antithetic variables and compare it to the
variance of <span class="math inline">\(\frac{X_1 + X_2}{2}\)</span>
using independent samples.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co"># Set parameters</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># Rayleigh parameter</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Number of samples</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a><span class="co"># Generate independent Rayleigh samples</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>independent_samples <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>  <span class="at">X1 =</span> <span class="fu">rayleigh_sample</span>(sigma, n),</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>  <span class="at">X2 =</span> <span class="fu">rayleigh_sample</span>(sigma, n)</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>)</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a><span class="co"># Generate Rayleigh samples with antithetic variables</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>antithetic_samples <span class="ot">&lt;-</span> <span class="fu">rayleigh_antithetic</span>(sigma, n)</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a><span class="co"># Calculate means of independent and antithetic samples</span></span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>mean_independent <span class="ot">&lt;-</span> (independent_samples<span class="sc">$</span>X1 <span class="sc">+</span> independent_samples<span class="sc">$</span>X2) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a>mean_antithetic <span class="ot">&lt;-</span> (antithetic_samples<span class="sc">$</span>X1 <span class="sc">+</span> antithetic_samples<span class="sc">$</span>X2) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a><span class="co"># Estimate variances</span></span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a>var_independent <span class="ot">&lt;-</span> <span class="fu">var</span>(mean_independent)</span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a>var_antithetic <span class="ot">&lt;-</span> <span class="fu">var</span>(mean_antithetic)</span>
<span id="cb30-21"><a href="#cb30-21" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" tabindex="-1"></a><span class="co"># Print variances</span></span>
<span id="cb30-23"><a href="#cb30-23" tabindex="-1"></a>var_independent</span></code></pre></div>
<pre><code>## [1] 0.2122429</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>var_antithetic</span></code></pre></div>
<pre><code>## [1] 0.0109312</code></pre>
</div>
<div id="step-4-calculate-percent-reduction-in-variance" class="section level3">
<h3>Step 4: Calculate Percent Reduction in Variance</h3>
<p>We can now compute the percent reduction in variance using the
formula:</p>
<p><span class="math display">\[
\text{Percent Reduction} = \frac{\text{Var}(X_1 + X_2)/2 - \text{Var}(X
+ X&#39;)/2}{\text{Var}(X_1 + X_2)/2} \times 100
\]</span></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>percent_reduction <span class="ot">&lt;-</span> (var_independent <span class="sc">-</span> var_antithetic) <span class="sc">/</span> var_independent <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>percent_reduction</span></code></pre></div>
<pre><code>## [1] 94.84968</code></pre>
</div>
</div>
<div id="question-3-5.13" class="section level2">
<h2>Question 3 (5.13)</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2\pi}} e^{-x^2/2},\quad x&gt;1.
\]</span> Which of your two importance functions should produce the
smaller variance in estimating <span class="math display">\[
\begin{aligned}\int_1^\infty\frac{x^2}{\sqrt{2\pi}} e^{-x^2/2}
dx\end{aligned}
\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-3-5.13" class="section level2">
<h2>Answer 3 (5.13)</h2>
<div id="step-1-define-the-target-function-gx" class="section level3">
<h3>Step 1: Define the Target Function <span class="math inline">\(g(x)\)</span></h3>
<p>We first define the target function <span class="math inline">\(g(x)\)</span>, which is proportional to a normal
density function with a quadratic term.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co"># Target function g(x)</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>  (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="step-2-choose-importance-functions-f_1-and-f_2" class="section level3">
<h3>Step 2: Choose Importance Functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span></h3>
<p>We choose two importance functions that are supported on <span class="math inline">\((1, \infty)\)</span> and are similar to <span class="math inline">\(g(x)\)</span>. One common choice for importance
functions is to use a distribution with a heavier tail than the target
function.</p>
<div id="importance-function-f_1" class="section level4">
<h4>Importance Function <span class="math inline">\(f_1\)</span></h4>
<p>We select <span class="math inline">\(f_1(x)\)</span> to be the tail
of a Gamma distribution. Since the Gamma distribution has support on
<span class="math inline">\((0, \infty)\)</span>, we can shift it to
<span class="math inline">\((1, \infty)\)</span> to match our
requirements.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co"># Importance function f_1: shifted Gamma distribution</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">shape =</span> <span class="dv">3</span>, <span class="at">rate =</span> <span class="dv">1</span>) {</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>  <span class="fu">dgamma</span>(x <span class="sc">-</span> <span class="dv">1</span>, <span class="at">shape =</span> shape, <span class="at">rate =</span> rate)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="importance-function-f_2" class="section level4">
<h4>Importance Function <span class="math inline">\(f_2\)</span></h4>
<p>We select <span class="math inline">\(f_2(x)\)</span> to be the tail
of a shifted exponential distribution. The exponential distribution is a
common choice for importance sampling due to its simplicity and support
on <span class="math inline">\((1, \infty)\)</span>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co"># Importance function f_2: shifted Exponential distribution</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">rate =</span> <span class="dv">1</span>) {</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>  <span class="fu">dexp</span>(x <span class="sc">-</span> <span class="dv">1</span>, <span class="at">rate =</span> rate)</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="step-3-implement-importance-sampling" class="section level3">
<h3>Step 3: Implement Importance Sampling</h3>
<p>We now implement the importance sampling method for both importance
functions. The general formula for the importance sampling estimator
is:</p>
<p><span class="math display">\[
\hat{I} = \frac{1}{N} \sum_{i=1}^N \frac{g(x_i)}{f(x_i)}.
\]</span></p>
<div id="sampling-from-f_1" class="section level4">
<h4>Sampling from <span class="math inline">\(f_1\)</span></h4>
<p>To generate samples from <span class="math inline">\(f_1\)</span>, we
use a shifted Gamma distribution.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># Sampling from f_1</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Number of samples</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>samples_f1 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N, <span class="at">shape =</span> <span class="dv">3</span>, <span class="at">rate =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a><span class="co"># Importance sampling estimator using f_1</span></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>importance_sampling_f1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(samples_f1) <span class="sc">/</span> <span class="fu">f1</span>(samples_f1))</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>importance_sampling_f1</span></code></pre></div>
<pre><code>## [1] 0.4001637</code></pre>
</div>
<div id="sampling-from-f_2" class="section level4">
<h4>Sampling from <span class="math inline">\(f_2\)</span></h4>
<p>To generate samples from <span class="math inline">\(f_2\)</span>, we
use a shifted Exponential distribution.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># Sampling from f_2</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>samples_f2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N, <span class="at">rate =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a><span class="co"># Importance sampling estimator using f_2</span></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>importance_sampling_f2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(samples_f2) <span class="sc">/</span> <span class="fu">f2</span>(samples_f2))</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>importance_sampling_f2</span></code></pre></div>
<pre><code>## [1] 0.399822</code></pre>
</div>
</div>
<div id="step-4-compare-the-variances" class="section level3">
<h3>Step 4: Compare the Variances</h3>
<p>Next, we compute the variance of the two importance sampling
estimators to see which one has smaller variance. The estimator with
smaller variance is considered more efficient.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co"># Variance of the importance sampling estimator for f_1</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>var_f1 <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">g</span>(samples_f1) <span class="sc">/</span> <span class="fu">f1</span>(samples_f1))</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a><span class="co"># Variance of the importance sampling estimator for f_2</span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>var_f2 <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">g</span>(samples_f2) <span class="sc">/</span> <span class="fu">f2</span>(samples_f2))</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a><span class="co"># Print variances</span></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>var_f1</span></code></pre></div>
<pre><code>## [1] 3.657442</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>var_f2</span></code></pre></div>
<pre><code>## [1] 0.02485872</code></pre>
<p>We can see that <span class="math inline">\(f_2\)</span> is more
efficient.</p>
</div>
</div>
<div id="question-4-monte-carlo-experiment" class="section level2">
<h2>Question 4 (Monte Carlo experiment)</h2>
<ul>
<li><p>For <span class="math inline">\(n = 10^4, 2 × 10^4, 4 × 10^4, 6 ×
10^4, 8 × 10^4\)</span>, apply the fast sorting algorithm to randomly
permuted numbers of <span class="math inline">\(1, . . . ,
n\)</span>.</p></li>
<li><p>Calculate computation time averaged over 100 simulations, denoted
by <span class="math inline">\(a_n\)</span>.</p></li>
<li><p>Regress an on <span class="math inline">\(t_n := n
\log(n)\)</span>, and graphically show the results (scatter plot and
regression line).</p></li>
</ul>
</div>
<div id="answer-4-monte-carlo-experiment" class="section level2">
<h2>Answer 4 (Monte Carlo experiment)</h2>
<div id="step-1-implement-and-apply-the-quick-sort-algorithm" class="section level3">
<h3>Step 1: Implement and apply the Quick Sort algorithm</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># Quick Sort algorithm implementation</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>quick_sort <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(x) <span class="sc">&lt;=</span> <span class="dv">1</span>) {</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>  }</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>  pivot <span class="ot">&lt;-</span> x[<span class="dv">1</span>]  <span class="co"># Select the first element as the pivot</span></span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>  less <span class="ot">&lt;-</span> x[x <span class="sc">&lt;</span> pivot]  <span class="co"># Elements less than pivot</span></span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>  equal <span class="ot">&lt;-</span> x[x <span class="sc">==</span> pivot]  <span class="co"># Elements equal to pivot</span></span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>  greater <span class="ot">&lt;-</span> x[x <span class="sc">&gt;</span> pivot]  <span class="co"># Elements greater than pivot</span></span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>  </span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>  <span class="co"># Recursively sort and combine</span></span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">quick_sort</span>(less), equal, <span class="fu">quick_sort</span>(greater))</span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>}</span></code></pre></div>
<p>Now, we will apply the quick sort algorithm to a series of random
permutations and calculate the computation times.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a><span class="co"># Define the sequence of n values</span></span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>n_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e4</span>, <span class="fl">2e4</span>, <span class="fl">4e4</span>, <span class="fl">6e4</span>, <span class="fl">8e4</span>)</span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a><span class="co"># Initialize a list to store the average computation times</span></span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>avg_times <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n_values))</span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a><span class="co"># Simulate the computation times for each n value</span></span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(n_values)) {</span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n_values[i]</span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a>  <span class="co"># Perform 100 simulations and compute average time</span></span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a>  avg_times[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">microbenchmark</span>(<span class="fu">quick_sort</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n)))<span class="sc">$</span>time)</span>
<span id="cb48-14"><a href="#cb48-14" tabindex="-1"></a>}</span>
<span id="cb48-15"><a href="#cb48-15" tabindex="-1"></a></span>
<span id="cb48-16"><a href="#cb48-16" tabindex="-1"></a><span class="co"># Display the computed average times</span></span>
<span id="cb48-17"><a href="#cb48-17" tabindex="-1"></a>avg_times</span></code></pre></div>
<pre><code>## [1]  63143496  84654467 176172296 257052420 353551787</code></pre>
</div>
<div id="step-2-regression-analysis" class="section level3">
<h3>Step 2: Regression Analysis</h3>
<p>Now we will perform a regression of the average times <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=n\log(n)\)</span>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="co"># Create a dataframe with n values and corresponding times</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  <span class="at">n =</span> n_values,</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>  <span class="at">t_n =</span> n_values <span class="sc">*</span> <span class="fu">log</span>(n_values),</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>  <span class="at">a_n =</span> avg_times</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>)</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a><span class="co"># Perform linear regression</span></span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(a_n <span class="sc">~</span> t_n, <span class="at">data =</span> data)</span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a><span class="co"># Display the summary of the regression model</span></span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = a_n ~ t_n, data = data)
## 
## Residuals:
##        1        2        3        4        5 
##  8366886 -8656873   750228 -4285967  3825725 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.128e+07  6.313e+06   3.371   0.0434 *  
## t_n         3.636e+02  1.161e+01  31.328 7.15e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7714000 on 3 degrees of freedom
## Multiple R-squared:  0.997,  Adjusted R-squared:  0.9959 
## F-statistic: 981.4 on 1 and 3 DF,  p-value: 7.146e-05</code></pre>
</div>
<div id="step-3-create-scatter-plot" class="section level3">
<h3>Step 3: Create scatter plot</h3>
<p>We will create a scatter plot of <span class="math inline">\(a_n\)</span> versus <span class="math inline">\(t_n\)</span> and add the regression line.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="co"># Create the plot with regression line</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> t_n, <span class="at">y =</span> a_n)) <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Regression of Computation Time on n log(n)&quot;</span>,</span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(t[n] <span class="sc">==</span> n <span class="sc">*</span> <span class="fu">log</span>(n)),</span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(a[n])</span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Based on the regression analysis and the plot, we can observe how the
computation time for the manually implemented quick sort algorithm
scales with <span class="math inline">\(n\log(n)\)</span>.</p>
</div>
</div>
</div>
<div id="hw-3-rd" class="section level1">
<h1>HW 3-rd</h1>
<div id="question-1-6.6" class="section level2">
<h2>Question 1 (6.6)</h2>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness
<span class="math inline">\(\sqrt{b_1}\)</span> under normality by a
Monte Carlo experiment. Compute the standard error of the estimates
using the normal approximation for the density (with exact variance
formula). Compare the estimated quantiles with the quantiles of the
large sample approximation <span class="math inline">\(\sqrt{b_1} ≈ N(0,
6/n)\)</span>.</p>
</div>
<div id="answer-1-6.6" class="section level2">
<h2>Answer 1 (6.6)</h2>
<div id="step-1-data-generation" class="section level3">
<h3>Step 1: Data Generation</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="co"># Function to calculate skewness</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>calculate_skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>  xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>  m3 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>  <span class="fu">return</span>(m3 <span class="sc">/</span> m2<span class="sc">^</span><span class="fl">1.5</span>)</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>}</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a><span class="co"># Function to generate random normal samples and calculate skewness</span></span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a>generate_skewness_data <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">m =</span> <span class="dv">10000</span>, <span class="at">n =</span> <span class="dv">50</span>, <span class="at">output_file =</span> <span class="st">&quot;skewness_data.Rds&quot;</span>) {</span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>  <span class="co"># Generate skewness statistics</span></span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>  skstats <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, <span class="at">expr =</span> {</span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb54-14"><a href="#cb54-14" tabindex="-1"></a>    <span class="fu">calculate_skewness</span>(x)</span>
<span id="cb54-15"><a href="#cb54-15" tabindex="-1"></a>  })</span>
<span id="cb54-16"><a href="#cb54-16" tabindex="-1"></a>  </span>
<span id="cb54-17"><a href="#cb54-17" tabindex="-1"></a>  <span class="co"># Save the results to file</span></span>
<span id="cb54-18"><a href="#cb54-18" tabindex="-1"></a>  <span class="fu">saveRDS</span>(skstats, <span class="at">file =</span> output_file)</span>
<span id="cb54-19"><a href="#cb54-19" tabindex="-1"></a>  </span>
<span id="cb54-20"><a href="#cb54-20" tabindex="-1"></a>  <span class="co"># Clear memory</span></span>
<span id="cb54-21"><a href="#cb54-21" tabindex="-1"></a>  <span class="co"># rm(list = ls())</span></span>
<span id="cb54-22"><a href="#cb54-22" tabindex="-1"></a>  </span>
<span id="cb54-23"><a href="#cb54-23" tabindex="-1"></a>  <span class="co"># Return the file path</span></span>
<span id="cb54-24"><a href="#cb54-24" tabindex="-1"></a>  <span class="fu">invisible</span>(output_file)</span>
<span id="cb54-25"><a href="#cb54-25" tabindex="-1"></a>}</span>
<span id="cb54-26"><a href="#cb54-26" tabindex="-1"></a></span>
<span id="cb54-27"><a href="#cb54-27" tabindex="-1"></a><span class="co"># Example of generating and saving skewness data</span></span>
<span id="cb54-28"><a href="#cb54-28" tabindex="-1"></a><span class="fu">generate_skewness_data</span>()</span></code></pre></div>
</div>
<div id="step-2-statistical-inference" class="section level3">
<h3>Step 2: Statistical Inference</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co"># Function to perform statistical inference on skewness data</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>perform_inference <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">input_file =</span> <span class="st">&quot;skewness_data.Rds&quot;</span>, <span class="at">output_file =</span> <span class="st">&quot;inference_results.Rds&quot;</span>, <span class="at">n =</span> <span class="dv">50</span>, <span class="at">m =</span> <span class="dv">10000</span>) {</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>  <span class="co"># Load skewness data from file</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>  skstats <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(input_file)</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>  </span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>  <span class="co"># Desired quantiles</span></span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>  </span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>  <span class="co"># Monte Carlo quantiles</span></span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>  q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(skstats, p)</span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>  </span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a>  <span class="co"># Large sample approximation quantiles</span></span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a>  q2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(p, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">6</span> <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">/</span> ((n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (n <span class="sc">+</span> <span class="dv">3</span>))))</span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a>  q3 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(p, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">6</span> <span class="sc">/</span> n))</span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a>  </span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a>  <span class="co"># Density function for normal approximation</span></span>
<span id="cb55-17"><a href="#cb55-17" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(q2, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">6</span> <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">/</span> ((n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (n <span class="sc">+</span> <span class="dv">3</span>))))</span>
<span id="cb55-18"><a href="#cb55-18" tabindex="-1"></a>  </span>
<span id="cb55-19"><a href="#cb55-19" tabindex="-1"></a>  <span class="co"># Compute standard error of quantile estimates</span></span>
<span id="cb55-20"><a href="#cb55-20" tabindex="-1"></a>  v <span class="ot">&lt;-</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">/</span> (m <span class="sc">*</span> f<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb55-21"><a href="#cb55-21" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v)</span>
<span id="cb55-22"><a href="#cb55-22" tabindex="-1"></a>  </span>
<span id="cb55-23"><a href="#cb55-23" tabindex="-1"></a>  <span class="co"># Save inference results</span></span>
<span id="cb55-24"><a href="#cb55-24" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb55-25"><a href="#cb55-25" tabindex="-1"></a>    <span class="at">Percentiles =</span> p,</span>
<span id="cb55-26"><a href="#cb55-26" tabindex="-1"></a>    <span class="at">MonteCarlo_Quantiles =</span> q1,</span>
<span id="cb55-27"><a href="#cb55-27" tabindex="-1"></a>    <span class="at">LargeSample_Approx_1 =</span> q2,</span>
<span id="cb55-28"><a href="#cb55-28" tabindex="-1"></a>    <span class="at">LargeSample_Approx_2 =</span> q3,</span>
<span id="cb55-29"><a href="#cb55-29" tabindex="-1"></a>    <span class="at">Standard_Error =</span> se</span>
<span id="cb55-30"><a href="#cb55-30" tabindex="-1"></a>  )</span>
<span id="cb55-31"><a href="#cb55-31" tabindex="-1"></a>  </span>
<span id="cb55-32"><a href="#cb55-32" tabindex="-1"></a>  <span class="fu">saveRDS</span>(results, <span class="at">file =</span> output_file)</span>
<span id="cb55-33"><a href="#cb55-33" tabindex="-1"></a>  </span>
<span id="cb55-34"><a href="#cb55-34" tabindex="-1"></a>  <span class="co"># Clear memory</span></span>
<span id="cb55-35"><a href="#cb55-35" tabindex="-1"></a>  <span class="co"># rm(list = ls())</span></span>
<span id="cb55-36"><a href="#cb55-36" tabindex="-1"></a>  </span>
<span id="cb55-37"><a href="#cb55-37" tabindex="-1"></a>  <span class="co"># Return the file path</span></span>
<span id="cb55-38"><a href="#cb55-38" tabindex="-1"></a>  <span class="fu">invisible</span>(output_file)</span>
<span id="cb55-39"><a href="#cb55-39" tabindex="-1"></a>}</span>
<span id="cb55-40"><a href="#cb55-40" tabindex="-1"></a></span>
<span id="cb55-41"><a href="#cb55-41" tabindex="-1"></a><span class="co"># Example of performing inference and saving the results</span></span>
<span id="cb55-42"><a href="#cb55-42" tabindex="-1"></a><span class="fu">perform_inference</span>()</span></code></pre></div>
</div>
<div id="step-3-result-reporting" class="section level3">
<h3>Step 3: Result Reporting</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="co"># Function to report the results</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>report_results <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">input_file =</span> <span class="st">&quot;inference_results.Rds&quot;</span>) {</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>  <span class="co"># Load inference results</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(input_file)</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>  </span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>  <span class="co"># Format results into a data frame for reporting</span></span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>  result_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>    <span class="at">Percentiles =</span> results<span class="sc">$</span>Percentiles,</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>    <span class="at">MonteCarlo_Quantiles =</span> results<span class="sc">$</span>MonteCarlo_Quantiles,</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>    <span class="at">LargeSample_Approx_1 =</span> results<span class="sc">$</span>LargeSample_Approx_1,</span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>    <span class="at">LargeSample_Approx_2 =</span> results<span class="sc">$</span>LargeSample_Approx_2,</span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>    <span class="at">Standard_Error =</span> results<span class="sc">$</span>Standard_Error</span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>  )</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>  <span class="co"># Clear memory</span></span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>  <span class="co"># rm(list = ls())</span></span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>  </span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a>  <span class="co"># Display the results</span></span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(result_df, <span class="at">caption =</span> <span class="st">&quot;Quantile Estimates and Standard Errors&quot;</span>)</span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a>  </span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a>  <span class="fu">return</span>(result_df)</span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a>}</span>
<span id="cb56-22"><a href="#cb56-22" tabindex="-1"></a></span>
<span id="cb56-23"><a href="#cb56-23" tabindex="-1"></a><span class="co"># Example of reporting the results</span></span>
<span id="cb56-24"><a href="#cb56-24" tabindex="-1"></a><span class="fu">report_results</span>()</span></code></pre></div>
<pre><code>##       Percentiles MonteCarlo_Quantiles LargeSample_Approx_1
## 2.5%        0.025           -0.6245315           -0.6397662
## 5%          0.050           -0.5135651           -0.5369087
## 95%         0.950            0.5267284            0.5369087
## 97.5%       0.975            0.6436563            0.6397662
##       LargeSample_Approx_2 Standard_Error
## 2.5%            -0.6789514    0.008719622
## 5%              -0.5697940    0.006897810
## 95%              0.5697940    0.006897810
## 97.5%            0.6789514    0.008719622</code></pre>
<p>The results show the estimated quantiles from the Monte Carlo
simulation and compare them with large sample approximations.</p>
</div>
</div>
<div id="question-2-6.b" class="section level2">
<h2>Question 2 (6.B)</h2>
<p>Tests for association based on Pearson product moment correlation
<span class="math inline">\(\rho\)</span>, Spearman’s rank correlation
coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall’s
coefficient <span class="math inline">\(\tau\)</span>, are implemented
in <code>cor.test</code>. Show (empirically) that the nonparametric
tests based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal. Find
an example of an alternative (a bivariate distribution <span class="math inline">\((X, Y)\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one
of the nonparametric tests have better empirical power than the
correlation test against this alternative.</p>
</div>
<div id="answer-2-6.b" class="section level2">
<h2>Answer 2 (6.B)</h2>
<div id="section-1-empirical-power-under-bivariate-normal-distribution" class="section level3">
<h3>Section 1: Empirical Power under Bivariate Normal Distribution</h3>
</div>
<div id="step-1-data-generation-function" class="section level3">
<h3>Step 1: Data Generation Function</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a><span class="fu">library</span>(stats) <span class="co"># for cor.test</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a><span class="co"># Function to generate bivariate normal data</span></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>generate_bivariate_normal_data <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">rho =</span> <span class="fl">0.5</span>, <span class="at">m =</span> <span class="dv">1000</span>, <span class="at">output_file =</span> <span class="st">&quot;bivariate_data.Rds&quot;</span>) {</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>  <span class="co"># Generate &#39;m&#39; bivariate normal samples</span></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>  data_list <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, {</span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>    Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, rho, rho, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>    <span class="fu">mvrnorm</span>(n, mu, Sigma)</span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>  }, <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>  </span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a>  <span class="co"># Save the generated data</span></span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a>  <span class="fu">saveRDS</span>(data_list, <span class="at">file =</span> output_file)</span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a>  </span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a>  <span class="co"># Clear memory</span></span>
<span id="cb58-18"><a href="#cb58-18" tabindex="-1"></a>  <span class="co"># rm(list = ls())</span></span>
<span id="cb58-19"><a href="#cb58-19" tabindex="-1"></a>  </span>
<span id="cb58-20"><a href="#cb58-20" tabindex="-1"></a>  <span class="co"># Return the path to the saved file</span></span>
<span id="cb58-21"><a href="#cb58-21" tabindex="-1"></a>  <span class="fu">invisible</span>(output_file)</span>
<span id="cb58-22"><a href="#cb58-22" tabindex="-1"></a>}</span>
<span id="cb58-23"><a href="#cb58-23" tabindex="-1"></a></span>
<span id="cb58-24"><a href="#cb58-24" tabindex="-1"></a><span class="co"># Generate data and save it</span></span>
<span id="cb58-25"><a href="#cb58-25" tabindex="-1"></a><span class="fu">generate_bivariate_normal_data</span>()</span></code></pre></div>
</div>
<div id="step-2-statistical-inference-function" class="section level3">
<h3>Step 2: Statistical Inference Function</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="co"># Function to perform correlation tests</span></span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>perform_correlation_tests <span class="ot">&lt;-</span> <span class="cf">function</span>(X, Y) {</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>  pearson_p <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>  spearman_p <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>  kendall_p <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>  </span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(pearson_p, spearman_p, kendall_p))</span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a>}</span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" tabindex="-1"></a><span class="co"># Function to perform inference and compute empirical power</span></span>
<span id="cb59-11"><a href="#cb59-11" tabindex="-1"></a>perform_inference <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">input_file =</span> <span class="st">&quot;bivariate_data.Rds&quot;</span>, <span class="at">output_file =</span> <span class="st">&quot;power_results.Rds&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) {</span>
<span id="cb59-12"><a href="#cb59-12" tabindex="-1"></a>  <span class="co"># Load the generated data</span></span>
<span id="cb59-13"><a href="#cb59-13" tabindex="-1"></a>  data_list <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(input_file)</span>
<span id="cb59-14"><a href="#cb59-14" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(data_list)  <span class="co"># Number of simulations</span></span>
<span id="cb59-15"><a href="#cb59-15" tabindex="-1"></a>  </span>
<span id="cb59-16"><a href="#cb59-16" tabindex="-1"></a>  <span class="co"># Perform tests for each dataset</span></span>
<span id="cb59-17"><a href="#cb59-17" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data_list, <span class="cf">function</span>(data) {</span>
<span id="cb59-18"><a href="#cb59-18" tabindex="-1"></a>    X <span class="ot">&lt;-</span> data[, <span class="dv">1</span>]</span>
<span id="cb59-19"><a href="#cb59-19" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> data[, <span class="dv">2</span>]</span>
<span id="cb59-20"><a href="#cb59-20" tabindex="-1"></a>    <span class="fu">perform_correlation_tests</span>(X, Y)</span>
<span id="cb59-21"><a href="#cb59-21" tabindex="-1"></a>  })</span>
<span id="cb59-22"><a href="#cb59-22" tabindex="-1"></a>  </span>
<span id="cb59-23"><a href="#cb59-23" tabindex="-1"></a>  <span class="co"># Compute empirical power</span></span>
<span id="cb59-24"><a href="#cb59-24" tabindex="-1"></a>  pearson_power <span class="ot">&lt;-</span> <span class="fu">mean</span>(results[<span class="dv">1</span>, ] <span class="sc">&lt;</span> alpha)</span>
<span id="cb59-25"><a href="#cb59-25" tabindex="-1"></a>  spearman_power <span class="ot">&lt;-</span> <span class="fu">mean</span>(results[<span class="dv">2</span>, ] <span class="sc">&lt;</span> alpha)</span>
<span id="cb59-26"><a href="#cb59-26" tabindex="-1"></a>  kendall_power <span class="ot">&lt;-</span> <span class="fu">mean</span>(results[<span class="dv">3</span>, ] <span class="sc">&lt;</span> alpha)</span>
<span id="cb59-27"><a href="#cb59-27" tabindex="-1"></a>  </span>
<span id="cb59-28"><a href="#cb59-28" tabindex="-1"></a>  <span class="co"># Save power results</span></span>
<span id="cb59-29"><a href="#cb59-29" tabindex="-1"></a>  power_results_normal <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb59-30"><a href="#cb59-30" tabindex="-1"></a>    <span class="at">Test =</span> <span class="fu">c</span>(<span class="st">&quot;Pearson&quot;</span>, <span class="st">&quot;Spearman&quot;</span>, <span class="st">&quot;Kendall&quot;</span>),</span>
<span id="cb59-31"><a href="#cb59-31" tabindex="-1"></a>    <span class="at">Power =</span> <span class="fu">c</span>(pearson_power, spearman_power, kendall_power)</span>
<span id="cb59-32"><a href="#cb59-32" tabindex="-1"></a>  )</span>
<span id="cb59-33"><a href="#cb59-33" tabindex="-1"></a>  </span>
<span id="cb59-34"><a href="#cb59-34" tabindex="-1"></a>  <span class="fu">saveRDS</span>(power_results_normal, <span class="at">file =</span> output_file)</span>
<span id="cb59-35"><a href="#cb59-35" tabindex="-1"></a>  </span>
<span id="cb59-36"><a href="#cb59-36" tabindex="-1"></a>  <span class="co"># Clear memory</span></span>
<span id="cb59-37"><a href="#cb59-37" tabindex="-1"></a>  <span class="co"># rm(list = ls())</span></span>
<span id="cb59-38"><a href="#cb59-38" tabindex="-1"></a>  </span>
<span id="cb59-39"><a href="#cb59-39" tabindex="-1"></a>  <span class="co"># Return the path to the saved file</span></span>
<span id="cb59-40"><a href="#cb59-40" tabindex="-1"></a>  <span class="fu">invisible</span>(output_file)</span>
<span id="cb59-41"><a href="#cb59-41" tabindex="-1"></a>}</span>
<span id="cb59-42"><a href="#cb59-42" tabindex="-1"></a></span>
<span id="cb59-43"><a href="#cb59-43" tabindex="-1"></a><span class="co"># Perform inference and save results</span></span>
<span id="cb59-44"><a href="#cb59-44" tabindex="-1"></a><span class="fu">perform_inference</span>()</span></code></pre></div>
<div id="step-3-result-reporting-function" class="section level4">
<h4>Step 3: Result Reporting Function</h4>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="co"># Function to report results</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>report_results <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">input_file =</span> <span class="st">&quot;power_results.Rds&quot;</span>) {</span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>  <span class="co"># Load power results</span></span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>  power_results_normal <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(input_file)</span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>  </span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>  <span class="co"># Display the results in a table</span></span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(power_results_normal, <span class="at">caption =</span> <span class="st">&quot;Empirical Power under Bivariate Normal Distribution&quot;</span>)</span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>  </span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a>  <span class="co"># Clear memory</span></span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a>  <span class="co"># rm(list = ls())</span></span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a>  </span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a>  <span class="co"># Return results for further use if needed</span></span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a>  <span class="fu">return</span>(power_results_normal)</span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a>}</span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a><span class="co"># Report the results</span></span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a><span class="fu">report_results</span>()</span></code></pre></div>
<pre><code>##       Test Power
## 1  Pearson 1.000
## 2 Spearman 0.998
## 3  Kendall 0.998</code></pre>
</div>
</div>
<div id="section-2-empirical-power-under-a-non-normal-alternative" class="section level3">
<h3>Section 2: Empirical Power under a Non-normal Alternative</h3>
<div id="step-1-data-generation-function-1" class="section level4">
<h4>Step 1: Data Generation Function</h4>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="co"># Function to generate non-normal data</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>generate_nonnormal_data <span class="ot">&lt;-</span> <span class="cf">function</span>(n, m, <span class="at">output_file =</span> <span class="st">&quot;data_nonnormal.Rds&quot;</span>) {</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>  results_nonnormal <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, {</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.1</span>)</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>    <span class="fu">cbind</span>(X, Y)</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>  })</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>  <span class="fu">saveRDS</span>(results_nonnormal, <span class="at">file =</span> output_file)</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>  <span class="co"># rm(list = ls())  # Clear memory</span></span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>  <span class="fu">invisible</span>(output_file)  <span class="co"># Return the file path</span></span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a>}</span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a><span class="co"># Generate non-normal data and save to file</span></span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a><span class="fu">generate_nonnormal_data</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">m =</span> <span class="dv">1000</span>)</span></code></pre></div>
</div>
<div id="step-2-statistical-inference-function-1" class="section level4">
<h4>Step 2: Statistical Inference Function</h4>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="co"># Dummy perform_tests function (replace this with your actual test logic)</span></span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>perform_tests <span class="ot">&lt;-</span> <span class="cf">function</span>(X, Y) {</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>  p_pearson <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>  p_spearman <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>  p_kendall <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>  <span class="fu">c</span>(p_pearson, p_spearman, p_kendall)</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>}</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a><span class="co"># Statistical inference function</span></span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a>perform_inference <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">input_file =</span> <span class="st">&quot;data_nonnormal.Rds&quot;</span>, <span class="at">output_file =</span> <span class="st">&quot;inference_nonnormal.Rds&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) {</span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>  results_nonnormal <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(input_file)</span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a>  </span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">dim</span>(results_nonnormal)[<span class="dv">3</span>]</span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a>  results_test <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, {</span>
<span id="cb63-15"><a href="#cb63-15" tabindex="-1"></a>    data <span class="ot">&lt;-</span> results_nonnormal[, , <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="dv">1</span>)]  <span class="co"># Select a random sample</span></span>
<span id="cb63-16"><a href="#cb63-16" tabindex="-1"></a>    X <span class="ot">&lt;-</span> data[, <span class="dv">1</span>]</span>
<span id="cb63-17"><a href="#cb63-17" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> data[, <span class="dv">2</span>]</span>
<span id="cb63-18"><a href="#cb63-18" tabindex="-1"></a>    <span class="fu">perform_tests</span>(X, Y)</span>
<span id="cb63-19"><a href="#cb63-19" tabindex="-1"></a>  })</span>
<span id="cb63-20"><a href="#cb63-20" tabindex="-1"></a>  </span>
<span id="cb63-21"><a href="#cb63-21" tabindex="-1"></a>  <span class="co"># Compute empirical power</span></span>
<span id="cb63-22"><a href="#cb63-22" tabindex="-1"></a>  pearson_power_nonnormal <span class="ot">&lt;-</span> <span class="fu">mean</span>(results_test[<span class="dv">1</span>, ] <span class="sc">&lt;</span> alpha)</span>
<span id="cb63-23"><a href="#cb63-23" tabindex="-1"></a>  spearman_power_nonnormal <span class="ot">&lt;-</span> <span class="fu">mean</span>(results_test[<span class="dv">2</span>, ] <span class="sc">&lt;</span> alpha)</span>
<span id="cb63-24"><a href="#cb63-24" tabindex="-1"></a>  kendall_power_nonnormal <span class="ot">&lt;-</span> <span class="fu">mean</span>(results_test[<span class="dv">3</span>, ] <span class="sc">&lt;</span> alpha)</span>
<span id="cb63-25"><a href="#cb63-25" tabindex="-1"></a></span>
<span id="cb63-26"><a href="#cb63-26" tabindex="-1"></a>  power_results_nonnormal <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb63-27"><a href="#cb63-27" tabindex="-1"></a>    <span class="at">Test =</span> <span class="fu">c</span>(<span class="st">&quot;Pearson&quot;</span>, <span class="st">&quot;Spearman&quot;</span>, <span class="st">&quot;Kendall&quot;</span>),</span>
<span id="cb63-28"><a href="#cb63-28" tabindex="-1"></a>    <span class="at">Power =</span> <span class="fu">c</span>(pearson_power_nonnormal, spearman_power_nonnormal, kendall_power_nonnormal)</span>
<span id="cb63-29"><a href="#cb63-29" tabindex="-1"></a>  )</span>
<span id="cb63-30"><a href="#cb63-30" tabindex="-1"></a>  </span>
<span id="cb63-31"><a href="#cb63-31" tabindex="-1"></a>  <span class="fu">saveRDS</span>(power_results_nonnormal, <span class="at">file =</span> output_file)</span>
<span id="cb63-32"><a href="#cb63-32" tabindex="-1"></a>  <span class="co"># rm(list = ls())  # Clear memory</span></span>
<span id="cb63-33"><a href="#cb63-33" tabindex="-1"></a>  <span class="fu">invisible</span>(output_file)  <span class="co"># Return the file path</span></span>
<span id="cb63-34"><a href="#cb63-34" tabindex="-1"></a>}</span>
<span id="cb63-35"><a href="#cb63-35" tabindex="-1"></a></span>
<span id="cb63-36"><a href="#cb63-36" tabindex="-1"></a><span class="co"># Perform inference and save results to file</span></span>
<span id="cb63-37"><a href="#cb63-37" tabindex="-1"></a><span class="fu">perform_inference</span>()</span></code></pre></div>
</div>
<div id="step-3-result-reporting-function-1" class="section level4">
<h4>Step 3: Result Reporting Function</h4>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="co"># Result reporting function</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>report_results <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">input_file =</span> <span class="st">&quot;inference_nonnormal.Rds&quot;</span>) {</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>  power_results_nonnormal <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(input_file)</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>  </span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>  <span class="co"># Display the results in a table</span></span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(power_results_nonnormal, <span class="at">caption =</span> <span class="st">&quot;Empirical Power under Non-normal Alternative&quot;</span>)</span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>  <span class="co"># rm(list = ls())  # Clear memory</span></span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>  <span class="fu">return</span>(power_results_nonnormal)  <span class="co"># Return results for further use</span></span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a>}</span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a><span class="co"># Report the results</span></span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a><span class="fu">report_results</span>()</span></code></pre></div>
<pre><code>##       Test Power
## 1  Pearson 0.126
## 2 Spearman 0.116
## 3  Kendall 0.169</code></pre>
<p>In this section, we demonstrate that Spearman’s and Kendall’s tests
may outperform Pearson’s test in detecting dependence in non-normal
settings.</p>
</div>
</div>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. Can we say the powers are different at 0.05 level?</p>
<ul>
<li><p>What is the corresponding hypothesis test problem?</p></li>
<li><p>Which test can we use? Z-test, two-sample t-test, paired-t test
or McNemar test? Why?</p></li>
<li><p>Please provide the least necessary information for hypothesis
testing.</p></li>
</ul>
</div>
<div id="answer-3" class="section level2">
<h2>Answer 3</h2>
<div id="hypothesis-problem" class="section level3">
<h3>Hypothesis Problem</h3>
<p>We are interested in testing whether the two power estimates (0.651
and 0.676) are significantly different at the 0.05 level.</p>
<ul>
<li><strong>Null Hypothesis (H0)</strong>: The two powers are
equal.</li>
<li><strong>Alternative Hypothesis (H1)</strong>: The two powers are
different.</li>
</ul>
<p>Given that each power estimate is derived from independent
experiments, a <strong>two-sample z-test</strong> can be used to compare
proportions. To meet the requirements of using separate functions for
data generation, statistical inference, and result reporting, I will
reorganize the code as follows. Each function will be independent,
saving outputs from each step to disk, and clearing memory where needed
to ensure reproducibility and modularity.</p>
</div>
<div id="step-1-data-generation-function-2" class="section level3">
<h3>Step 1: Data Generation Function</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="co"># Data generation function</span></span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">power1 =</span> <span class="fl">0.651</span>, <span class="at">power2 =</span> <span class="fl">0.676</span>, <span class="at">n_experiments =</span> <span class="dv">10000</span>) {</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>  output_file <span class="ot">&lt;-</span> <span class="st">&quot;data_output.Rds&quot;</span>  <span class="co"># Define the output file inside the function</span></span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">power1 =</span> power1, <span class="at">power2 =</span> power2, <span class="at">n_experiments =</span> n_experiments)</span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>  <span class="fu">saveRDS</span>(data, <span class="at">file =</span> output_file)</span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>  <span class="co"># rm(list = ls())  # Clear memory</span></span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>  <span class="fu">invisible</span>(output_file)  <span class="co"># Return the output file path invisibly</span></span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a>}</span>
<span id="cb66-9"><a href="#cb66-9" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" tabindex="-1"></a><span class="co"># Generate data and save to file</span></span>
<span id="cb66-11"><a href="#cb66-11" tabindex="-1"></a><span class="fu">generate_data</span>()</span></code></pre></div>
</div>
<div id="step-2-statistical-inference-function-2" class="section level3">
<h3>Step 2: Statistical Inference Function</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="co"># Statistical inference function</span></span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>perform_inference <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">input_file =</span> <span class="st">&quot;data_output.Rds&quot;</span>, <span class="at">output_file =</span> <span class="st">&quot;inference_output.Rds&quot;</span>) {</span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>  <span class="co"># Load data</span></span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(input_file)</span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> data<span class="sc">$</span>power1</span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> data<span class="sc">$</span>power2</span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a>  n <span class="ot">&lt;-</span> data<span class="sc">$</span>n_experiments</span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>  </span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a>  <span class="co"># Compute pooled proportion and standard error</span></span>
<span id="cb67-10"><a href="#cb67-10" tabindex="-1"></a>  p_pool <span class="ot">&lt;-</span> (p1 <span class="sc">*</span> n <span class="sc">+</span> p2 <span class="sc">*</span> n) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> n)</span>
<span id="cb67-11"><a href="#cb67-11" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p_pool <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_pool) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>n <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n))</span>
<span id="cb67-12"><a href="#cb67-12" tabindex="-1"></a>  </span>
<span id="cb67-13"><a href="#cb67-13" tabindex="-1"></a>  <span class="co"># Z-statistic and p-value</span></span>
<span id="cb67-14"><a href="#cb67-14" tabindex="-1"></a>  z_stat <span class="ot">&lt;-</span> (p1 <span class="sc">-</span> p2) <span class="sc">/</span> se</span>
<span id="cb67-15"><a href="#cb67-15" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(z_stat))</span>
<span id="cb67-16"><a href="#cb67-16" tabindex="-1"></a>  </span>
<span id="cb67-17"><a href="#cb67-17" tabindex="-1"></a>  <span class="co"># Decision</span></span>
<span id="cb67-18"><a href="#cb67-18" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb67-19"><a href="#cb67-19" tabindex="-1"></a>  decision <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> alpha, <span class="st">&quot;Reject H0: Powers are different&quot;</span>, <span class="st">&quot;Fail to Reject H0: No significant difference&quot;</span>)</span>
<span id="cb67-20"><a href="#cb67-20" tabindex="-1"></a>  </span>
<span id="cb67-21"><a href="#cb67-21" tabindex="-1"></a>  <span class="co"># Save results</span></span>
<span id="cb67-22"><a href="#cb67-22" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Z_statistic =</span> z_stat, <span class="at">P_value =</span> p_value, <span class="at">Decision =</span> decision)</span>
<span id="cb67-23"><a href="#cb67-23" tabindex="-1"></a>  <span class="fu">saveRDS</span>(results, <span class="at">file =</span> output_file)</span>
<span id="cb67-24"><a href="#cb67-24" tabindex="-1"></a>  <span class="co"># rm(list = ls())  # Clear memory</span></span>
<span id="cb67-25"><a href="#cb67-25" tabindex="-1"></a>  <span class="fu">invisible</span>(output_file)  <span class="co"># Return the output file path invisibly</span></span>
<span id="cb67-26"><a href="#cb67-26" tabindex="-1"></a>}</span>
<span id="cb67-27"><a href="#cb67-27" tabindex="-1"></a></span>
<span id="cb67-28"><a href="#cb67-28" tabindex="-1"></a><span class="co"># Perform inference and save results to file</span></span>
<span id="cb67-29"><a href="#cb67-29" tabindex="-1"></a><span class="fu">perform_inference</span>()</span></code></pre></div>
</div>
<div id="step-3-result-reporting-function-2" class="section level3">
<h3>Step 3: Result Reporting Function</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="co"># Result reporting function</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>report_results <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">input_file =</span> <span class="st">&quot;inference_output.Rds&quot;</span>) {</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>  <span class="co"># Load results</span></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(input_file)</span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>  </span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>  <span class="co"># Report</span></span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(results)</span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>  </span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a>  <span class="co"># Clear memory</span></span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a>  <span class="co"># rm(list = ls())</span></span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a>  </span>
<span id="cb68-12"><a href="#cb68-12" tabindex="-1"></a>  <span class="co"># Optionally, return the results for further use</span></span>
<span id="cb68-13"><a href="#cb68-13" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb68-14"><a href="#cb68-14" tabindex="-1"></a>}</span>
<span id="cb68-15"><a href="#cb68-15" tabindex="-1"></a></span>
<span id="cb68-16"><a href="#cb68-16" tabindex="-1"></a><span class="co"># Report the results</span></span>
<span id="cb68-17"><a href="#cb68-17" tabindex="-1"></a><span class="fu">report_results</span>()</span></code></pre></div>
<pre><code>## $Z_statistic
## [1] -3.741209
## 
## $P_value
## [1] 0.0001831369
## 
## $Decision
## [1] &quot;Reject H0: Powers are different&quot;</code></pre>
</div>
</div>
</div>
<div id="hw-4-th" class="section level1">
<h1>HW 4-th</h1>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>Of <span class="math inline">\(N = 1000\)</span> hypotheses, <span class="math inline">\(950\)</span> are null and <span class="math inline">\(50\)</span> are alternative. The p-value under any
null hypothesis is uniformly distributed (use <code>runif</code>), and
the p-value under any alternative hypothesis follows the beta
distribution with parameter <span class="math inline">\(0.1\)</span> and
<span class="math inline">\(1\)</span> (use <code>rbeta</code>). Obtain
Bonferroni adjusted p-values and B-H adjusted p-values. Calculate FWER,
FDR, and TPR under nominal level <span class="math inline">\(α =
0.1\)</span> for each of the two adjustment methods based on <span class="math inline">\(m = 10000\)</span> simulation replicates. You
should output the <span class="math inline">\(6\)</span> numbers (3) to
a <span class="math inline">\(3 × 2\)</span> table (column names:
Bonferroni correction, B-H correction; row names: FWER, FDR, TPR).
Comment the results.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer 1</h2>
<p>We simulate <span class="math inline">\(m = 10000\)</span> datasets
and calculate the Family-Wise Error Rate (FWER), False Discovery Rate
(FDR), and True Positive Rate (TPR) for both Bonferroni and
Benjamini-Hochberg (B-H) corrections at a nominal level <span class="math inline">\(\alpha = 0.1\)</span>.</p>
<div id="step-1-simulating-the-p-values" class="section level3">
<h3>Step 1: Simulating the p-values</h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>n_null <span class="ot">&lt;-</span> <span class="dv">950</span></span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>n_alt <span class="ot">&lt;-</span> N <span class="sc">-</span> n_null</span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># number of simulation replicates</span></span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a>simulate_pvalues <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a>  p_null <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_null)  <span class="co"># p-values under null hypothesis</span></span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a>  p_alt <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n_alt, <span class="fl">0.1</span>, <span class="dv">1</span>)  <span class="co"># p-values under alternative hypothesis</span></span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(p_null, p_alt))</span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="step-2-applying-bonferroni-and-b-h-corrections" class="section level3">
<h3>Step 2: Applying Bonferroni and B-H Corrections</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>adjust_pvalues <span class="ot">&lt;-</span> <span class="cf">function</span>(p_values) {</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>  bonferroni <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>  bh <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">bonferroni =</span> bonferroni, <span class="at">bh =</span> bh))</span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="step-3-calculating-metrics-fwer-fdr-tpr" class="section level3">
<h3>Step 3: Calculating Metrics (FWER, FDR, TPR)</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>calculate_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(adjusted_p, true_alt) {</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>  reject <span class="ot">&lt;-</span> adjusted_p <span class="sc">&lt;</span> alpha</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>  true_reject <span class="ot">&lt;-</span> true_alt <span class="sc">&amp;</span> reject</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>  false_reject <span class="ot">&lt;-</span> <span class="sc">!</span>true_alt <span class="sc">&amp;</span> reject</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>  </span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a>  fwer <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">any</span>(false_reject))</span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a>  fdr <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(reject) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fu">sum</span>(false_reject) <span class="sc">/</span> <span class="fu">sum</span>(reject), <span class="dv">0</span>)</span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a>  tpr <span class="ot">&lt;-</span> <span class="fu">sum</span>(true_reject) <span class="sc">/</span> <span class="fu">sum</span>(true_alt)</span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a>  </span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(fwer, fdr, tpr))</span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="step-4-running-the-simulation" class="section level3">
<h3>Step 4: Running the Simulation</h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="co"># Storing results</span></span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>results_bonf <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a>results_bh <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="fu">simulate_pvalues</span>()</span>
<span id="cb73-7"><a href="#cb73-7" tabindex="-1"></a>  adjusted_p <span class="ot">&lt;-</span> <span class="fu">adjust_pvalues</span>(p_values)</span>
<span id="cb73-8"><a href="#cb73-8" tabindex="-1"></a>  true_alt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">FALSE</span>, n_null), <span class="fu">rep</span>(<span class="cn">TRUE</span>, n_alt))</span>
<span id="cb73-9"><a href="#cb73-9" tabindex="-1"></a>  results_bonf[i, ] <span class="ot">&lt;-</span> <span class="fu">calculate_metrics</span>(adjusted_p<span class="sc">$</span>bonferroni, true_alt)</span>
<span id="cb73-10"><a href="#cb73-10" tabindex="-1"></a>  results_bh[i, ] <span class="ot">&lt;-</span> <span class="fu">calculate_metrics</span>(adjusted_p<span class="sc">$</span>bh, true_alt)</span>
<span id="cb73-11"><a href="#cb73-11" tabindex="-1"></a>}</span>
<span id="cb73-12"><a href="#cb73-12" tabindex="-1"></a></span>
<span id="cb73-13"><a href="#cb73-13" tabindex="-1"></a>avg_bonf <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(results_bonf)</span>
<span id="cb73-14"><a href="#cb73-14" tabindex="-1"></a>avg_bh <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(results_bh)</span>
<span id="cb73-15"><a href="#cb73-15" tabindex="-1"></a></span>
<span id="cb73-16"><a href="#cb73-16" tabindex="-1"></a>result_table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(avg_bonf, avg_bh), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-17"><a href="#cb73-17" tabindex="-1"></a><span class="fu">colnames</span>(result_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni Correction&quot;</span>, <span class="st">&quot;B-H Correction&quot;</span>)</span>
<span id="cb73-18"><a href="#cb73-18" tabindex="-1"></a><span class="fu">rownames</span>(result_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb73-19"><a href="#cb73-19" tabindex="-1"></a>result_table</span></code></pre></div>
<pre><code>##      Bonferroni Correction B-H Correction
## FWER           0.092100000     0.93280000
## FDR            0.004735714     0.09520896
## TPR            0.397708000     0.56176800</code></pre>
</div>
<div id="results" class="section level3">
<h3>Results</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="co"># Print the table</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a><span class="fu">print</span>(result_table)</span></code></pre></div>
<pre><code>##      Bonferroni Correction B-H Correction
## FWER           0.092100000     0.93280000
## FDR            0.004735714     0.09520896
## TPR            0.397708000     0.56176800</code></pre>
</div>
<div id="comment-on-the-results" class="section level3">
<h3>Comment on the Results</h3>
<ul>
<li><p><strong>FWER</strong>: Bonferroni correction is more conservative
and controls FWER tightly, so we expect a low FWER compared to the B-H
correction.</p></li>
<li><p><strong>FDR</strong>: B-H correction controls the FDR more
efficiently than Bonferroni, which does not directly aim to control
FDR.</p></li>
<li><p><strong>TPR</strong>: B-H correction typically has a higher TPR
(sensitivity) than Bonferroni, as it is less conservative and allows
more true positives to be detected.</p></li>
</ul>
</div>
</div>
<div id="question-2-7.4" class="section level2">
<h2>Question 2 (7.4)</h2>
<p>Refer to the air-conditioning data set <code>aircondit</code>
provided in the <code>boot</code> package. The <span class="math inline">\(12\)</span> observations are the times in hours
between failures of air-conditioning equipment:</p>
<p><span class="math display">\[
3, 5, 7, 18, 43, 85, 91, 98, 100, 130, 230, 487.
\]</span></p>
<p>Assume that the times between failures follow an exponential model
<span class="math inline">\(Exp(λ)\)</span>. Obtain the MLE of the
hazard rate <span class="math inline">\(λ\)</span> and use bootstrap to
estimate the bias and standard error of the estimate.</p>
</div>
<div id="answer-2-7.4" class="section level2">
<h2>Answer 2 (7.4)</h2>
<div id="step-1-data-generation-1" class="section level3">
<h3>Step 1: Data Generation</h3>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>aircond_data <span class="ot">&lt;-</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a>  <span class="fu">return</span>(aircond_data)</span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a>}</span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a>data_sample <span class="ot">&lt;-</span> <span class="fu">generate_data</span>()</span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a><span class="fu">print</span>(data_sample)  <span class="co"># Display the original data</span></span></code></pre></div>
<pre><code>##  [1]   3   5   7  18  43  85  91  98 100 130 230 487</code></pre>
</div>
<div id="step-2-statistical-inference-1" class="section level3">
<h3>Step 2: Statistical Inference</h3>
<p><strong>Maximum Likelihood Estimation for Hazard Rate</strong></p>
<p>For an exponential distribution, the MLE of the hazard rate <span class="math inline">\(λ\)</span> is given by: <span class="math display">\[ \hat{λ} = \frac{1}{\bar{x}} \]</span></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>mle_hazard_rate <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>  lambda_hat <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(data)</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>  <span class="fu">return</span>(lambda_hat)</span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>}</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="fu">mle_hazard_rate</span>(data_sample)</span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>lambda_mle</span></code></pre></div>
<pre><code>## [1] 0.00925212</code></pre>
<p><strong>Bootstrap Procedure for Bias and Standard Error</strong></p>
<p>We will now use bootstrap to estimate the bias and standard error of
the MLE of the hazard rate.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>bootstrap_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a>  bootstrap_sample <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(bootstrap_sample))</span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>}</span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a>R_replicates <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a>bootstrap_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(data_sample, <span class="at">statistic =</span> bootstrap_stat, <span class="at">R =</span> R_replicates)</span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" tabindex="-1"></a><span class="fu">print</span>(bootstrap_result)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = data_sample, statistic = bootstrap_stat, R = R_replicates)
## 
## 
## Bootstrap Statistics :
##       original      bias    std. error
## t1* 0.00925212 0.001431008 0.004365276</code></pre>
</div>
<div id="step-3-result-reporting-1" class="section level3">
<h3>Step 3: Result Reporting</h3>
<p>We report the bias, standard error, and confidence intervals obtained
from the bootstrap results.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a>report_results <span class="ot">&lt;-</span> <span class="cf">function</span>(bootstrap_obj, original_mle) {</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a>  bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap_obj<span class="sc">$</span>t) <span class="sc">-</span> original_mle</span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">sd</span>(bootstrap_obj<span class="sc">$</span>t)</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_obj, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;MLE of Hazard Rate (λ):&quot;</span>, original_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Bootstrap Bias Estimate:&quot;</span>, bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Bootstrap Standard Error:&quot;</span>, se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a>  <span class="fu">print</span>(ci)</span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a>}</span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a><span class="fu">report_results</span>(bootstrap_result, lambda_mle)</span></code></pre></div>
<pre><code>## MLE of Hazard Rate (λ): 0.00925212 
## Bootstrap Bias Estimate: 0.001431008 
## Bootstrap Standard Error: 0.004365276 
## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bootstrap_obj, type = c(&quot;norm&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal             Percentile            BCa          
## 95%   (-0.0007,  0.0164 )   ( 0.0052,  0.0214 )   ( 0.0046,  0.0179 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
</div>
<div id="question-3-7.5" class="section level2">
<h2>Question 3 (7.5)</h2>
<p>Refer to Exercise 7.4. Compute <span class="math inline">\(95%\)</span> bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1/λ\)</span>
by the standard normal, basic, percentile, and BCa methods. Compare the
intervals and explain why they may differ.</p>
</div>
<div id="answer-3-7.5" class="section level2">
<h2>Answer 3 (7.5)</h2>
<div id="step-1-data-generation-2" class="section level3">
<h3>Step 1: Data Generation</h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a>aircond_data <span class="ot">&lt;-</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>  <span class="fu">return</span>(aircond_data)</span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a>}</span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a>data_sample <span class="ot">&lt;-</span> <span class="fu">generate_data</span>()</span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a><span class="fu">print</span>(data_sample)  <span class="co"># Display the dataset</span></span></code></pre></div>
<pre><code>##  [1]   3   5   7  18  43  85  91  98 100 130 230 487</code></pre>
</div>
<div id="step-2-statistical-inference-2" class="section level3">
<h3>Step 2: Statistical Inference</h3>
<p><strong>Bootstrapping the Mean Time Between Failures</strong></p>
<p>To compute the mean time between failures, we need to use
bootstrapping to generate samples and calculate the mean.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>compute_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>  sampled_data <span class="ot">&lt;-</span> data[indices]  <span class="co"># Resample the data</span></span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(sampled_data))       <span class="co"># Calculate and return the mean</span></span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>}</span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a>n_replicates <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a>bootstrap_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(</span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a>  <span class="at">data =</span> data_sample,               <span class="co"># Input data</span></span>
<span id="cb87-10"><a href="#cb87-10" tabindex="-1"></a>  <span class="at">statistic =</span> compute_mean,         <span class="co"># Function for calculating mean</span></span>
<span id="cb87-11"><a href="#cb87-11" tabindex="-1"></a>  <span class="at">R =</span> n_replicates                  <span class="co"># Number of bootstrap replicates</span></span>
<span id="cb87-12"><a href="#cb87-12" tabindex="-1"></a>)</span>
<span id="cb87-13"><a href="#cb87-13" tabindex="-1"></a></span>
<span id="cb87-14"><a href="#cb87-14" tabindex="-1"></a><span class="fu">print</span>(bootstrap_result)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = data_sample, statistic = compute_mean, R = n_replicates)
## 
## 
## Bootstrap Statistics :
##     original    bias    std. error
## t1* 108.0833 0.9405833    38.64081</code></pre>
<p><strong>Confidence Interval Calculation</strong></p>
<p>Now, we will compute the 95% bootstrap confidence intervals using
various methods.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>compute_confidence_intervals <span class="ot">&lt;-</span> <span class="cf">function</span>(bootstrap_obj) {</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>  ci_results <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>    <span class="at">boot.out =</span> bootstrap_obj, </span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;bca&quot;</span>)  <span class="co"># Different CI methods</span></span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>  )</span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>  </span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Bootstrap Confidence Intervals:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a>  <span class="fu">print</span>(ci_results)</span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a>}</span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a></span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a><span class="fu">compute_confidence_intervals</span>(bootstrap_result)</span></code></pre></div>
<pre><code>## Bootstrap Confidence Intervals:
## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bootstrap_obj, type = c(&quot;norm&quot;, &quot;perc&quot;, &quot;basic&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 31.4, 182.9 )   ( 22.8, 170.0 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.2, 193.4 )   ( 55.6, 225.1 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
<div id="step-3-result-reporting-2" class="section level3">
<h3>Step 3: Result Reporting</h3>
<p>We will visualize the distribution of the bootstrap replicates and
compare the confidence intervals.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a>report_results <span class="ot">&lt;-</span> <span class="cf">function</span>(bootstrap_obj) {</span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a>  <span class="fu">hist</span>(</span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a>    bootstrap_obj<span class="sc">$</span>t,                <span class="co"># Bootstrap means</span></span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a>    <span class="at">probability =</span> <span class="cn">TRUE</span>,              <span class="co"># Density scale</span></span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Distribution of Bootstrap Means&quot;</span>,  <span class="co"># Title</span></span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Bootstrap Sample Means&quot;</span>  <span class="co"># X-axis label</span></span>
<span id="cb91-7"><a href="#cb91-7" tabindex="-1"></a>  )</span>
<span id="cb91-8"><a href="#cb91-8" tabindex="-1"></a></span>
<span id="cb91-9"><a href="#cb91-9" tabindex="-1"></a>  <span class="fu">points</span>(</span>
<span id="cb91-10"><a href="#cb91-10" tabindex="-1"></a>    <span class="fu">mean</span>(data_sample),              <span class="co"># Original sample mean</span></span>
<span id="cb91-11"><a href="#cb91-11" tabindex="-1"></a>    <span class="dv">0</span>,                              <span class="co"># Position on the y-axis</span></span>
<span id="cb91-12"><a href="#cb91-12" tabindex="-1"></a>    <span class="at">cex =</span> <span class="dv">2</span>,                        <span class="co"># Point size</span></span>
<span id="cb91-13"><a href="#cb91-13" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">16</span>                        <span class="co"># Point shape (filled circle)</span></span>
<span id="cb91-14"><a href="#cb91-14" tabindex="-1"></a>  )</span>
<span id="cb91-15"><a href="#cb91-15" tabindex="-1"></a>}</span>
<span id="cb91-16"><a href="#cb91-16" tabindex="-1"></a></span>
<span id="cb91-17"><a href="#cb91-17" tabindex="-1"></a><span class="fu">report_results</span>(bootstrap_result)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="hw-5-th" class="section level1">
<h1>HW 5-th</h1>
<div id="question-1-7.8" class="section level2">
<h2>Question 1 (7.8)</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-1-7.8" class="section level2">
<h2>Answer 1 (7.8)</h2>
<p>We use <strong>jackknife resampling</strong> to estimate the bias and
standard error of an eigenvalue-based statistic.</p>
<div id="step-1-data-generation-function-3" class="section level3">
<h3>Step 1: Data Generation Function</h3>
<p>This function handles the preparation of the data. It loads the
dataset, converts it to a matrix, and returns both the matrix and the
sample size.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a>generate_data_1 <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>  <span class="co"># Load the &#39;scor&#39; dataset and convert to matrix</span></span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a>  <span class="fu">data</span>(<span class="st">&quot;scor&quot;</span>, <span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(scor)</span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a>  </span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a>  <span class="co"># Extract the number of rows (sample size)</span></span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb92-8"><a href="#cb92-8" tabindex="-1"></a>  </span>
<span id="cb92-9"><a href="#cb92-9" tabindex="-1"></a>  <span class="co"># Save data to disk for reuse</span></span>
<span id="cb92-10"><a href="#cb92-10" tabindex="-1"></a>  <span class="fu">save</span>(x, n, <span class="at">file =</span> <span class="st">&quot;data_generation.RData&quot;</span>)</span>
<span id="cb92-11"><a href="#cb92-11" tabindex="-1"></a>  </span>
<span id="cb92-12"><a href="#cb92-12" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Data generation complete. Data saved to &#39;data_generation.RData&#39;.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb92-13"><a href="#cb92-13" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())  <span class="co"># Clear memory</span></span>
<span id="cb92-14"><a href="#cb92-14" tabindex="-1"></a>}</span></code></pre></div>
<div id="run-data-generation" class="section level4">
<h4>Run Data Generation</h4>
<p>Clear any existing objects to ensure the function runs
independently.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="fu">generate_data_1</span>()   <span class="co"># Generate and save data</span></span></code></pre></div>
<pre><code>## Data generation complete. Data saved to &#39;data_generation.RData&#39;.</code></pre>
</div>
</div>
<div id="step-2-statistical-inference-function-3" class="section level3">
<h3>Step 2: Statistical Inference Function</h3>
<p>This function loads the data from disk, performs the jackknife
resampling, and computes the bias and standard error.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a>statistical_inference_1 <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>  <span class="co"># Load generated data</span></span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>  <span class="fu">load</span>(<span class="st">&quot;data_generation.RData&quot;</span>)</span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>  </span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>  <span class="co"># Compute the original statistic (theta_hat)</span></span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a>  theta_hat <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda <span class="sc">/</span> <span class="fu">sum</span>(lambda))</span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>  </span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a>  <span class="co"># Initialize jackknife estimates</span></span>
<span id="cb95-10"><a href="#cb95-10" tabindex="-1"></a>  theta_jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb95-11"><a href="#cb95-11" tabindex="-1"></a>  </span>
<span id="cb95-12"><a href="#cb95-12" tabindex="-1"></a>  <span class="co"># Perform jackknife resampling</span></span>
<span id="cb95-13"><a href="#cb95-13" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb95-14"><a href="#cb95-14" tabindex="-1"></a>    y <span class="ot">&lt;-</span> x[<span class="sc">-</span>i, ]  <span class="co"># Leave one observation out</span></span>
<span id="cb95-15"><a href="#cb95-15" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">cov</span>(y)</span>
<span id="cb95-16"><a href="#cb95-16" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(s)<span class="sc">$</span>values</span>
<span id="cb95-17"><a href="#cb95-17" tabindex="-1"></a>    theta_jack[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda <span class="sc">/</span> <span class="fu">sum</span>(lambda))</span>
<span id="cb95-18"><a href="#cb95-18" tabindex="-1"></a>  }</span>
<span id="cb95-19"><a href="#cb95-19" tabindex="-1"></a>  </span>
<span id="cb95-20"><a href="#cb95-20" tabindex="-1"></a>  <span class="co"># Compute bias and standard error</span></span>
<span id="cb95-21"><a href="#cb95-21" tabindex="-1"></a>  bias_jack <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta_jack) <span class="sc">-</span> theta_hat)</span>
<span id="cb95-22"><a href="#cb95-22" tabindex="-1"></a>  se_jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">*</span> <span class="fu">sum</span>((theta_jack <span class="sc">-</span> <span class="fu">mean</span>(theta_jack))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb95-23"><a href="#cb95-23" tabindex="-1"></a>  </span>
<span id="cb95-24"><a href="#cb95-24" tabindex="-1"></a>  <span class="co"># Save results to disk</span></span>
<span id="cb95-25"><a href="#cb95-25" tabindex="-1"></a>  <span class="fu">save</span>(theta_hat, bias_jack, se_jack, <span class="at">file =</span> <span class="st">&quot;statistical_inference.RData&quot;</span>)</span>
<span id="cb95-26"><a href="#cb95-26" tabindex="-1"></a>  </span>
<span id="cb95-27"><a href="#cb95-27" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Statistical inference complete. Results saved to &#39;statistical_inference.RData&#39;.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb95-28"><a href="#cb95-28" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())  <span class="co"># Clear memory</span></span>
<span id="cb95-29"><a href="#cb95-29" tabindex="-1"></a>}</span></code></pre></div>
<div id="run-statistical-inference" class="section level4">
<h4>Run Statistical Inference</h4>
<p>Clear memory and perform the analysis.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="fu">statistical_inference_1</span>()  <span class="co"># Perform inference and save results</span></span></code></pre></div>
<pre><code>## Statistical inference complete. Results saved to &#39;statistical_inference.RData&#39;.</code></pre>
</div>
</div>
<div id="step-3-result-reporting-function-3" class="section level3">
<h3>Step 3: Result Reporting Function</h3>
<p>This function loads the inference results and displays them.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>report_results_1 <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>  <span class="co"># Load inference results from disk</span></span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>  <span class="fu">load</span>(<span class="st">&quot;statistical_inference.RData&quot;</span>)</span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>  </span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>  <span class="co"># Display the results</span></span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Jackknife Estimation Results:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Theta Hat: %.4f</span><span class="sc">\n</span><span class="st">&quot;</span>, theta_hat))</span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Jackknife Bias: %.4f</span><span class="sc">\n</span><span class="st">&quot;</span>, bias_jack))</span>
<span id="cb98-9"><a href="#cb98-9" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Jackknife SE: %.4f</span><span class="sc">\n</span><span class="st">&quot;</span>, se_jack))</span>
<span id="cb98-10"><a href="#cb98-10" tabindex="-1"></a>}</span></code></pre></div>
<div id="run-result-reporting" class="section level4">
<h4>Run Result Reporting</h4>
<p>Ensure that the environment is clear before reporting.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="fu">report_results_1</span>()  <span class="co"># Report the saved results</span></span></code></pre></div>
<pre><code>## Jackknife Estimation Results:
## Theta Hat: 0.6191
## Jackknife Bias: 0.0011
## Jackknife SE: 0.0496</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a>files_to_delete <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;data_generation.RData&quot;</span>, <span class="st">&quot;statistical_inference.RData&quot;</span>)</span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a><span class="fu">sapply</span>(files_to_delete, <span class="cf">function</span>(file) {</span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">file.exists</span>(file)) {</span>
<span id="cb101-4"><a href="#cb101-4" tabindex="-1"></a>    <span class="fu">file.remove</span>(file)</span>
<span id="cb101-5"><a href="#cb101-5" tabindex="-1"></a>    <span class="fu">cat</span>(file, <span class="st">&quot;has been deleted.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb101-6"><a href="#cb101-6" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb101-7"><a href="#cb101-7" tabindex="-1"></a>    <span class="fu">cat</span>(file, <span class="st">&quot;does not exist.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb101-8"><a href="#cb101-8" tabindex="-1"></a>  }</span>
<span id="cb101-9"><a href="#cb101-9" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## data_generation.RData has been deleted.
## statistical_inference.RData has been deleted.</code></pre>
<pre><code>## $data_generation.RData
## NULL
## 
## $statistical_inference.RData
## NULL</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())  <span class="co"># Clear environment</span></span></code></pre></div>
</div>
</div>
</div>
<div id="question-2-7.10" class="section level2">
<h2>Question 2 (7.10)</h2>
<p>Leave-one-out (n-fold) cross validation was used to select the best
fitting model for the <code>ironslag</code> data. Repeat the analysis
replacing the Log-Log model with a cubic polynomial model. Which of the
four models is selected by the cross validation procedure? Which model
is selected according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
</div>
<div id="answer-2-7.10" class="section level2">
<h2>Answer 2 (7.10)</h2>
<p>We take a structured approach to model selection and cross-validation
using the <strong>ironslag</strong> dataset. Four different regression
models (linear, quadratic, exponential, and cubic) are fitted, and their
performance is evaluated using adjusted <span class="math inline">\(R^2\)</span> and leave-one-out cross-validation
(LOOCV).</p>
<div id="step-1-data-generation-3" class="section level3">
<h3>Step 1: Data Generation</h3>
<p>This function loads the <strong>ironslag</strong> dataset and
prepares the data for analysis. It saves the dataset to disk for use by
other functions.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a>generate_data_2 <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>  <span class="co"># Load dataset and convert to vectors</span></span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a>  <span class="fu">data</span>(<span class="st">&quot;ironslag&quot;</span>, <span class="at">package =</span> <span class="st">&quot;DAAG&quot;</span>)</span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a>  chemical <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>chemical</span>
<span id="cb105-5"><a href="#cb105-5" tabindex="-1"></a>  magnetic <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic</span>
<span id="cb105-6"><a href="#cb105-6" tabindex="-1"></a>  </span>
<span id="cb105-7"><a href="#cb105-7" tabindex="-1"></a>  <span class="co"># Save the data to disk</span></span>
<span id="cb105-8"><a href="#cb105-8" tabindex="-1"></a>  <span class="fu">save</span>(chemical, magnetic, <span class="at">file =</span> <span class="st">&quot;data_ironslag.RData&quot;</span>)</span>
<span id="cb105-9"><a href="#cb105-9" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Data generation complete. Data saved to &#39;data_ironslag.RData&#39;.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb105-10"><a href="#cb105-10" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())  <span class="co"># Clear memory</span></span>
<span id="cb105-11"><a href="#cb105-11" tabindex="-1"></a>}</span></code></pre></div>
<div id="run-data-generation-1" class="section level4">
<h4>Run Data Generation</h4>
<p>Ensure the environment is clear before running.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="fu">generate_data_2</span>()   <span class="co"># Generate and save the data</span></span></code></pre></div>
<pre><code>## Data generation complete. Data saved to &#39;data_ironslag.RData&#39;.</code></pre>
</div>
</div>
<div id="step-2-statistical-inference-3" class="section level3">
<h3>Step 2: Statistical Inference</h3>
<p>This function fits four regression models, evaluates their
performance using adjusted <span class="math inline">\(R^2\)</span>, and
performs LOOCV to estimate prediction errors. Intermediate results are
saved for later use.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a>statistical_inference_2 <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>  <span class="co"># Load generated data</span></span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>  <span class="fu">load</span>(<span class="st">&quot;data_ironslag.RData&quot;</span>)</span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a>  </span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a>  <span class="co"># Create a sequence for predictions</span></span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">0.1</span>)</span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a></span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a>  <span class="co"># Initialize adjusted R-squared values</span></span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a>  Rsq <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a></span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a>  <span class="co"># Model 1: Linear regression</span></span>
<span id="cb108-12"><a href="#cb108-12" tabindex="-1"></a>  L1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical)</span>
<span id="cb108-13"><a href="#cb108-13" tabindex="-1"></a>  Rsq[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">summary</span>(L1)<span class="sc">$</span>adj.r.squared</span>
<span id="cb108-14"><a href="#cb108-14" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> L1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a</span>
<span id="cb108-15"><a href="#cb108-15" tabindex="-1"></a></span>
<span id="cb108-16"><a href="#cb108-16" tabindex="-1"></a>  <span class="co"># Model 2: Quadratic regression</span></span>
<span id="cb108-17"><a href="#cb108-17" tabindex="-1"></a>  L2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb108-18"><a href="#cb108-18" tabindex="-1"></a>  Rsq[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">summary</span>(L2)<span class="sc">$</span>adj.r.squared</span>
<span id="cb108-19"><a href="#cb108-19" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> L2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a <span class="sc">+</span> L2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> a<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb108-20"><a href="#cb108-20" tabindex="-1"></a></span>
<span id="cb108-21"><a href="#cb108-21" tabindex="-1"></a>  <span class="co"># Model 3: Exponential regression (log-transformed response)</span></span>
<span id="cb108-22"><a href="#cb108-22" tabindex="-1"></a>  L3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(magnetic) <span class="sc">~</span> chemical)</span>
<span id="cb108-23"><a href="#cb108-23" tabindex="-1"></a>  Rsq[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">summary</span>(L3)<span class="sc">$</span>adj.r.squared</span>
<span id="cb108-24"><a href="#cb108-24" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> L3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a</span>
<span id="cb108-25"><a href="#cb108-25" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb108-26"><a href="#cb108-26" tabindex="-1"></a></span>
<span id="cb108-27"><a href="#cb108-27" tabindex="-1"></a>  <span class="co"># Model 4: Cubic regression</span></span>
<span id="cb108-28"><a href="#cb108-28" tabindex="-1"></a>  L4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb108-29"><a href="#cb108-29" tabindex="-1"></a>  Rsq[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">summary</span>(L4)<span class="sc">$</span>adj.r.squared</span>
<span id="cb108-30"><a href="#cb108-30" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> L4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a <span class="sc">+</span> L4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> a<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> L4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> a<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb108-31"><a href="#cb108-31" tabindex="-1"></a></span>
<span id="cb108-32"><a href="#cb108-32" tabindex="-1"></a>  <span class="co"># Perform LOOCV for each model</span></span>
<span id="cb108-33"><a href="#cb108-33" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb108-34"><a href="#cb108-34" tabindex="-1"></a>  e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb108-35"><a href="#cb108-35" tabindex="-1"></a>  </span>
<span id="cb108-36"><a href="#cb108-36" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb108-37"><a href="#cb108-37" tabindex="-1"></a>    <span class="co"># Leave-one-out cross-validation</span></span>
<span id="cb108-38"><a href="#cb108-38" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb108-39"><a href="#cb108-39" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb108-40"><a href="#cb108-40" tabindex="-1"></a>    </span>
<span id="cb108-41"><a href="#cb108-41" tabindex="-1"></a>    <span class="co"># Model 1: Linear</span></span>
<span id="cb108-42"><a href="#cb108-42" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb108-43"><a href="#cb108-43" tabindex="-1"></a>    e1[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> (J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k])</span>
<span id="cb108-44"><a href="#cb108-44" tabindex="-1"></a>    </span>
<span id="cb108-45"><a href="#cb108-45" tabindex="-1"></a>    <span class="co"># Model 2: Quadratic</span></span>
<span id="cb108-46"><a href="#cb108-46" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb108-47"><a href="#cb108-47" tabindex="-1"></a>    e2[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> (J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> </span>
<span id="cb108-48"><a href="#cb108-48" tabindex="-1"></a>                            J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb108-49"><a href="#cb108-49" tabindex="-1"></a>    </span>
<span id="cb108-50"><a href="#cb108-50" tabindex="-1"></a>    <span class="co"># Model 3: Exponential</span></span>
<span id="cb108-51"><a href="#cb108-51" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb108-52"><a href="#cb108-52" tabindex="-1"></a>    e3[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> <span class="fu">exp</span>(J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k])</span>
<span id="cb108-53"><a href="#cb108-53" tabindex="-1"></a>    </span>
<span id="cb108-54"><a href="#cb108-54" tabindex="-1"></a>    <span class="co"># Model 4: Cubic</span></span>
<span id="cb108-55"><a href="#cb108-55" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb108-56"><a href="#cb108-56" tabindex="-1"></a>    e4[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> (J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> </span>
<span id="cb108-57"><a href="#cb108-57" tabindex="-1"></a>                            J4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb108-58"><a href="#cb108-58" tabindex="-1"></a>                            J4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb108-59"><a href="#cb108-59" tabindex="-1"></a>  }</span>
<span id="cb108-60"><a href="#cb108-60" tabindex="-1"></a>  </span>
<span id="cb108-61"><a href="#cb108-61" tabindex="-1"></a>  <span class="co"># Compute mean squared prediction errors</span></span>
<span id="cb108-62"><a href="#cb108-62" tabindex="-1"></a>  mse <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb108-63"><a href="#cb108-63" tabindex="-1"></a></span>
<span id="cb108-64"><a href="#cb108-64" tabindex="-1"></a>  <span class="co"># Save results to disk</span></span>
<span id="cb108-65"><a href="#cb108-65" tabindex="-1"></a>  <span class="fu">save</span>(Rsq, mse, <span class="at">file =</span> <span class="st">&quot;inference_results.RData&quot;</span>)</span>
<span id="cb108-66"><a href="#cb108-66" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Statistical inference complete. Results saved to &#39;inference_results.RData&#39;.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb108-67"><a href="#cb108-67" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())  <span class="co"># Clear memory</span></span>
<span id="cb108-68"><a href="#cb108-68" tabindex="-1"></a>}</span></code></pre></div>
<div id="run-statistical-inference-1" class="section level4">
<h4>Run Statistical Inference</h4>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="fu">statistical_inference_2</span>()  <span class="co"># Perform inference and save results</span></span></code></pre></div>
<pre><code>## Statistical inference complete. Results saved to &#39;inference_results.RData&#39;.</code></pre>
</div>
</div>
<div id="step-3-result-reporting-3" class="section level3">
<h3>Step 3: Result Reporting</h3>
<p>This function loads and reports the adjusted <span class="math inline">\(R^2\)</span> values and prediction errors for the
models.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a>report_results_2 <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a>  <span class="co"># Load inference results from disk</span></span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>  <span class="fu">load</span>(<span class="st">&quot;inference_results.RData&quot;</span>)</span>
<span id="cb111-4"><a href="#cb111-4" tabindex="-1"></a>  </span>
<span id="cb111-5"><a href="#cb111-5" tabindex="-1"></a>  <span class="co"># Display the results</span></span>
<span id="cb111-6"><a href="#cb111-6" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Adjusted R-squared Values:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb111-7"><a href="#cb111-7" tabindex="-1"></a>  <span class="fu">print</span>(Rsq)</span>
<span id="cb111-8"><a href="#cb111-8" tabindex="-1"></a>  </span>
<span id="cb111-9"><a href="#cb111-9" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Mean Squared Prediction Errors:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb111-10"><a href="#cb111-10" tabindex="-1"></a>  <span class="fu">print</span>(mse)</span>
<span id="cb111-11"><a href="#cb111-11" tabindex="-1"></a>  </span>
<span id="cb111-12"><a href="#cb111-12" tabindex="-1"></a>  <span class="co"># Select the best model based on maximum adjusted R^2</span></span>
<span id="cb111-13"><a href="#cb111-13" tabindex="-1"></a>  best_model_1 <span class="ot">&lt;-</span> <span class="fu">which.max</span>(Rsq)</span>
<span id="cb111-14"><a href="#cb111-14" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">The best model based on maximum adjusted R^2 is Model %d.</span><span class="sc">\n</span><span class="st">&quot;</span>, best_model_1))</span>
<span id="cb111-15"><a href="#cb111-15" tabindex="-1"></a>  </span>
<span id="cb111-16"><a href="#cb111-16" tabindex="-1"></a>  <span class="co"># Select the best model based on MSE</span></span>
<span id="cb111-17"><a href="#cb111-17" tabindex="-1"></a>  best_model_2 <span class="ot">&lt;-</span> <span class="fu">which.min</span>(mse)</span>
<span id="cb111-18"><a href="#cb111-18" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">The model with the lowest prediction error is Model %d.</span><span class="sc">\n</span><span class="st">&quot;</span>, best_model_2))</span>
<span id="cb111-19"><a href="#cb111-19" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Thus the model selected by cross-validation is Model %d.</span><span class="sc">\n</span><span class="st">&quot;</span>, best_model_2))</span>
<span id="cb111-20"><a href="#cb111-20" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())  <span class="co"># Clear memory</span></span>
<span id="cb111-21"><a href="#cb111-21" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="run-result-reporting-1" class="section level3">
<h3>Run Result Reporting</h3>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="fu">report_results_2</span>()  <span class="co"># Report results</span></span></code></pre></div>
<pre><code>## Adjusted R-squared Values:
## [1] 0.5281545 0.5768151 0.5280556 0.5740396
## 
## Mean Squared Prediction Errors:
## [1] 19.55644 17.85248 18.44188 18.17756
## 
## The best model based on maximum adjusted R^2 is Model 2.
## 
## The model with the lowest prediction error is Model 2.
## 
## Thus the model selected by cross-validation is Model 2.</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a>files_to_delete <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;data_ironslag.RData&quot;</span>, <span class="st">&quot;inference_results.RData&quot;</span>)</span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a><span class="fu">sapply</span>(files_to_delete, <span class="cf">function</span>(file) {</span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">file.exists</span>(file)) {</span>
<span id="cb114-4"><a href="#cb114-4" tabindex="-1"></a>    <span class="fu">file.remove</span>(file)</span>
<span id="cb114-5"><a href="#cb114-5" tabindex="-1"></a>    <span class="fu">cat</span>(file, <span class="st">&quot;has been deleted.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb114-6"><a href="#cb114-6" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb114-7"><a href="#cb114-7" tabindex="-1"></a>    <span class="fu">cat</span>(file, <span class="st">&quot;does not exist.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb114-8"><a href="#cb114-8" tabindex="-1"></a>  }</span>
<span id="cb114-9"><a href="#cb114-9" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## data_ironslag.RData has been deleted.
## inference_results.RData has been deleted.</code></pre>
<pre><code>## $data_ironslag.RData
## NULL
## 
## $inference_results.RData
## NULL</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())  <span class="co"># Clear memory</span></span></code></pre></div>
</div>
</div>
<div id="question-3-8.1" class="section level2">
<h2>Question 3 (8.1)</h2>
<p>Implement the two-sample Cramér-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
</div>
<div id="answer-3-8.1" class="section level2">
<h2>Answer 3 (8.1)</h2>
<p>We take a modular implementation of the Cramér-von Mises test to
compare two sample distributions. The data used comes from the
<code>chickwts</code> dataset, which records the weights of chicks fed
with different feed types.</p>
<div id="data-generation" class="section level3">
<h3>1. Data Generation</h3>
<p>The data generation function selects two feeds for comparison and
extracts the corresponding weights from the <code>chickwts</code>
dataset. It ensures that any unnecessary objects are cleared from memory
before saving the extracted data for later use.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="co"># Function: Data Generation</span></span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a>generate_data_3 <span class="ot">&lt;-</span> <span class="cf">function</span>(feed1, feed2) {</span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>  <span class="fu">data</span>(chickwts)     <span class="co"># Load the chickwts dataset</span></span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a>  </span>
<span id="cb118-5"><a href="#cb118-5" tabindex="-1"></a>  <span class="co"># Extract weights for the two specified feeds</span></span>
<span id="cb118-6"><a href="#cb118-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> feed1])</span>
<span id="cb118-7"><a href="#cb118-7" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> feed2])</span>
<span id="cb118-8"><a href="#cb118-8" tabindex="-1"></a>  </span>
<span id="cb118-9"><a href="#cb118-9" tabindex="-1"></a>  <span class="co"># Save extracted data to disk</span></span>
<span id="cb118-10"><a href="#cb118-10" tabindex="-1"></a>  <span class="fu">save</span>(x, y, <span class="at">file =</span> <span class="st">&quot;generated_data.RData&quot;</span>)</span>
<span id="cb118-11"><a href="#cb118-11" tabindex="-1"></a>  </span>
<span id="cb118-12"><a href="#cb118-12" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Data generated for feeds: %s and %s</span><span class="sc">\n</span><span class="st">&quot;</span>, feed1, feed2))</span>
<span id="cb118-13"><a href="#cb118-13" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())  <span class="co"># Clear memory</span></span>
<span id="cb118-14"><a href="#cb118-14" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="statistical-inference" class="section level3">
<h3>2. Statistical Inference</h3>
<p>This step implements the <strong>Cramér-von Mises test</strong> as a
permutation test. It loads the saved data, calculates the test statistic
for the original sample, and performs permutation-based resampling to
compute a p-value.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="co"># Function: Statistical Inference (Cramér-von Mises Test)</span></span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a>cvm_permutation_test <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">R =</span> <span class="dv">500</span>) {</span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>  <span class="co"># Load the generated data</span></span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a>  <span class="fu">load</span>(<span class="st">&quot;generated_data.RData&quot;</span>)</span>
<span id="cb119-5"><a href="#cb119-5" tabindex="-1"></a>  </span>
<span id="cb119-6"><a href="#cb119-6" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb119-7"><a href="#cb119-7" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb119-8"><a href="#cb119-8" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)  <span class="co"># Combined data</span></span>
<span id="cb119-9"><a href="#cb119-9" tabindex="-1"></a>  N <span class="ot">&lt;-</span> n <span class="sc">+</span> m    <span class="co"># Total sample size</span></span>
<span id="cb119-10"><a href="#cb119-10" tabindex="-1"></a></span>
<span id="cb119-11"><a href="#cb119-11" tabindex="-1"></a>  <span class="co"># Initialize empirical CDFs</span></span>
<span id="cb119-12"><a href="#cb119-12" tabindex="-1"></a>  Fn <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb119-13"><a href="#cb119-13" tabindex="-1"></a>  Gm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb119-14"><a href="#cb119-14" tabindex="-1"></a>  </span>
<span id="cb119-15"><a href="#cb119-15" tabindex="-1"></a>  <span class="co"># Compute the original test statistic</span></span>
<span id="cb119-16"><a href="#cb119-16" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb119-17"><a href="#cb119-17" tabindex="-1"></a>    Fn[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(z[i] <span class="sc">&lt;=</span> x)</span>
<span id="cb119-18"><a href="#cb119-18" tabindex="-1"></a>    Gm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(z[i] <span class="sc">&lt;=</span> y)</span>
<span id="cb119-19"><a href="#cb119-19" tabindex="-1"></a>  }</span>
<span id="cb119-20"><a href="#cb119-20" tabindex="-1"></a>  cvm0 <span class="ot">&lt;-</span> (n <span class="sc">*</span> m <span class="sc">/</span> N) <span class="sc">*</span> <span class="fu">sum</span>((Fn <span class="sc">-</span> Gm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb119-21"><a href="#cb119-21" tabindex="-1"></a></span>
<span id="cb119-22"><a href="#cb119-22" tabindex="-1"></a>  <span class="co"># Perform R permutations</span></span>
<span id="cb119-23"><a href="#cb119-23" tabindex="-1"></a>  cvm_permutations <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, {</span>
<span id="cb119-24"><a href="#cb119-24" tabindex="-1"></a>    permuted <span class="ot">&lt;-</span> <span class="fu">sample</span>(z)  <span class="co"># Random permutation</span></span>
<span id="cb119-25"><a href="#cb119-25" tabindex="-1"></a>    X_perm <span class="ot">&lt;-</span> permuted[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb119-26"><a href="#cb119-26" tabindex="-1"></a>    Y_perm <span class="ot">&lt;-</span> permuted[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb119-27"><a href="#cb119-27" tabindex="-1"></a>    </span>
<span id="cb119-28"><a href="#cb119-28" tabindex="-1"></a>    <span class="co"># Compute CDFs for permuted data</span></span>
<span id="cb119-29"><a href="#cb119-29" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb119-30"><a href="#cb119-30" tabindex="-1"></a>      Fn[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(permuted[i] <span class="sc">&lt;=</span> X_perm)</span>
<span id="cb119-31"><a href="#cb119-31" tabindex="-1"></a>      Gm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(permuted[i] <span class="sc">&lt;=</span> Y_perm)</span>
<span id="cb119-32"><a href="#cb119-32" tabindex="-1"></a>    }</span>
<span id="cb119-33"><a href="#cb119-33" tabindex="-1"></a>    (n <span class="sc">*</span> m <span class="sc">/</span> N) <span class="sc">*</span> <span class="fu">sum</span>((Fn <span class="sc">-</span> Gm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb119-34"><a href="#cb119-34" tabindex="-1"></a>  })</span>
<span id="cb119-35"><a href="#cb119-35" tabindex="-1"></a></span>
<span id="cb119-36"><a href="#cb119-36" tabindex="-1"></a>  <span class="co"># Calculate p-value</span></span>
<span id="cb119-37"><a href="#cb119-37" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(cvm_permutations, cvm0) <span class="sc">&gt;=</span> cvm0)</span>
<span id="cb119-38"><a href="#cb119-38" tabindex="-1"></a></span>
<span id="cb119-39"><a href="#cb119-39" tabindex="-1"></a>  <span class="co"># Save the inference results</span></span>
<span id="cb119-40"><a href="#cb119-40" tabindex="-1"></a>  <span class="fu">save</span>(cvm0, p_value, <span class="at">file =</span> <span class="st">&quot;inference_results.RData&quot;</span>)</span>
<span id="cb119-41"><a href="#cb119-41" tabindex="-1"></a>  </span>
<span id="cb119-42"><a href="#cb119-42" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Statistical inference completed.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb119-43"><a href="#cb119-43" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())  <span class="co"># Clear memory</span></span>
<span id="cb119-44"><a href="#cb119-44" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="result-reporting" class="section level3">
<h3>3. Result Reporting</h3>
<p>The result reporting function loads the saved inference results and
prints the test statistic and p-value in a human-readable format.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="co"># Function: Result Reporting</span></span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a>report_results_3 <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb120-3"><a href="#cb120-3" tabindex="-1"></a>  <span class="co"># Load the inference results</span></span>
<span id="cb120-4"><a href="#cb120-4" tabindex="-1"></a>  <span class="fu">load</span>(<span class="st">&quot;inference_results.RData&quot;</span>)</span>
<span id="cb120-5"><a href="#cb120-5" tabindex="-1"></a>  </span>
<span id="cb120-6"><a href="#cb120-6" tabindex="-1"></a>  <span class="co"># Print the test statistic and p-value</span></span>
<span id="cb120-7"><a href="#cb120-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Cramér-von Mises Test Statistic: %.4f</span><span class="sc">\n</span><span class="st">&quot;</span>, cvm0))</span>
<span id="cb120-8"><a href="#cb120-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Permutation Test P-value: %.4f</span><span class="sc">\n</span><span class="st">&quot;</span>, p_value))</span>
<span id="cb120-9"><a href="#cb120-9" tabindex="-1"></a>  </span>
<span id="cb120-10"><a href="#cb120-10" tabindex="-1"></a>  <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb120-11"><a href="#cb120-11" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;The two samples have significantly different distributions (p &lt; 0.05).</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb120-12"><a href="#cb120-12" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb120-13"><a href="#cb120-13" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;No significant difference between the distributions (p &gt;= 0.05).</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb120-14"><a href="#cb120-14" tabindex="-1"></a>  }</span>
<span id="cb120-15"><a href="#cb120-15" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="fu">generate_data_3</span>(<span class="st">&quot;soybean&quot;</span>, <span class="st">&quot;linseed&quot;</span>)</span></code></pre></div>
<pre><code>## Data generated for feeds: soybean and linseed</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="fu">cvm_permutation_test</span>()</span></code></pre></div>
<pre><code>## Statistical inference completed.</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="fu">report_results_3</span>()</span></code></pre></div>
<pre><code>## Cramér-von Mises Test Statistic: 4.2280
## Permutation Test P-value: 0.3892
## No significant difference between the distributions (p &gt;= 0.05).</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a><span class="fu">generate_data_3</span>(<span class="st">&quot;soybean&quot;</span>, <span class="st">&quot;sunflower&quot;</span>)</span></code></pre></div>
<pre><code>## Data generated for feeds: soybean and sunflower</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a><span class="fu">cvm_permutation_test</span>()</span></code></pre></div>
<pre><code>## Statistical inference completed.</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a><span class="fu">report_results_3</span>()</span></code></pre></div>
<pre><code>## Cramér-von Mises Test Statistic: 28.4341
## Permutation Test P-value: 0.0020
## The two samples have significantly different distributions (p &lt; 0.05).</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a><span class="fu">generate_data_3</span>(<span class="st">&quot;sunflower&quot;</span>, <span class="st">&quot;linseed&quot;</span>)</span></code></pre></div>
<pre><code>## Data generated for feeds: sunflower and linseed</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a><span class="fu">cvm_permutation_test</span>()</span></code></pre></div>
<pre><code>## Statistical inference completed.</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a><span class="fu">report_results_3</span>()</span></code></pre></div>
<pre><code>## Cramér-von Mises Test Statistic: 36.5000
## Permutation Test P-value: 0.0020
## The two samples have significantly different distributions (p &lt; 0.05).</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a>files_to_delete <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;generated_data.RData&quot;</span>, <span class="st">&quot;inference_results.RData&quot;</span>)</span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a><span class="fu">sapply</span>(files_to_delete, <span class="cf">function</span>(file) {</span>
<span id="cb139-3"><a href="#cb139-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">file.exists</span>(file)) {</span>
<span id="cb139-4"><a href="#cb139-4" tabindex="-1"></a>    <span class="fu">file.remove</span>(file)</span>
<span id="cb139-5"><a href="#cb139-5" tabindex="-1"></a>    <span class="fu">cat</span>(file, <span class="st">&quot;has been deleted.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb139-6"><a href="#cb139-6" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb139-7"><a href="#cb139-7" tabindex="-1"></a>    <span class="fu">cat</span>(file, <span class="st">&quot;does not exist.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb139-8"><a href="#cb139-8" tabindex="-1"></a>  }</span>
<span id="cb139-9"><a href="#cb139-9" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## generated_data.RData has been deleted.
## inference_results.RData has been deleted.</code></pre>
<pre><code>## $generated_data.RData
## NULL
## 
## $inference_results.RData
## NULL</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())  <span class="co"># Clear memory</span></span></code></pre></div>
</div>
</div>
<div id="question-4-8.2" class="section level2">
<h2>Question 4 (8.2)</h2>
<p>Implement the bivariate Spearman rank correlation test for
independence as a permutation test. The Spearman rank correlation test
statistic can be obtained from function cor with
<code>method = &quot;spearman&quot;</code>. Compare the achieved significance
level of the permutation test with the p-value reported by
<code>cor.test</code> on the same samples.</p>
</div>
<div id="answer-4-8.2" class="section level2">
<h2>Answer 4 (8.2)</h2>
<p>We take a modular implementation of the Spearman rank correlation
test for independence. The permutation test is compared with the
standard <code>cor.test</code> function to evaluate how well the
permutation-based p-value matches the analytical p-value.</p>
<div id="data-generation-1" class="section level3">
<h3>1. Data Generation</h3>
<p>The <strong>data generation function</strong> creates bivariate
normal or log-normal data samples, saving them to disk. The use of
modular data generation ensures reproducibility and clear separation
from other computational steps.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a><span class="co"># Function: Data Generation</span></span>
<span id="cb143-2"><a href="#cb143-2" tabindex="-1"></a>generate_data_4 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">rho =</span> <span class="fl">0.5</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>) {</span>
<span id="cb143-3"><a href="#cb143-3" tabindex="-1"></a>  <span class="co"># Define the covariance matrix</span></span>
<span id="cb143-4"><a href="#cb143-4" tabindex="-1"></a>  Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, rho, rho, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb143-5"><a href="#cb143-5" tabindex="-1"></a>  </span>
<span id="cb143-6"><a href="#cb143-6" tabindex="-1"></a>  <span class="co"># Generate data according to the specified distribution</span></span>
<span id="cb143-7"><a href="#cb143-7" tabindex="-1"></a>  <span class="cf">if</span> (dist <span class="sc">==</span> <span class="st">&quot;normal&quot;</span>) {</span>
<span id="cb143-8"><a href="#cb143-8" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, <span class="at">mu =</span> mu, <span class="at">Sigma =</span> Sigma)</span>
<span id="cb143-9"><a href="#cb143-9" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (dist <span class="sc">==</span> <span class="st">&quot;lognormal&quot;</span>) {</span>
<span id="cb143-10"><a href="#cb143-10" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">mvrnorm</span>(n, <span class="at">mu =</span> mu, <span class="at">Sigma =</span> Sigma))</span>
<span id="cb143-11"><a href="#cb143-11" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb143-12"><a href="#cb143-12" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Invalid distribution type. Use &#39;normal&#39; or &#39;lognormal&#39;.&quot;</span>)</span>
<span id="cb143-13"><a href="#cb143-13" tabindex="-1"></a>  }</span>
<span id="cb143-14"><a href="#cb143-14" tabindex="-1"></a>  </span>
<span id="cb143-15"><a href="#cb143-15" tabindex="-1"></a>  <span class="co"># Save the data to disk</span></span>
<span id="cb143-16"><a href="#cb143-16" tabindex="-1"></a>  <span class="fu">save</span>(data, <span class="at">file =</span> <span class="st">&quot;generated_data.RData&quot;</span>)</span>
<span id="cb143-17"><a href="#cb143-17" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Data generated and saved to &#39;generated_data.RData&#39;.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb143-18"><a href="#cb143-18" tabindex="-1"></a>  </span>
<span id="cb143-19"><a href="#cb143-19" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())  <span class="co"># Clear memory</span></span>
<span id="cb143-20"><a href="#cb143-20" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a><span class="fu">generate_data_4</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">rho =</span> <span class="fl">0.5</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<pre><code>## Data generated and saved to &#39;generated_data.RData&#39;.</code></pre>
</div>
<div id="statistical-inference-1" class="section level3">
<h3>2. Statistical Inference</h3>
<p>The <strong>statistical inference function</strong> implements the
<strong>Spearman rank correlation permutation test</strong>. It
calculates the observed correlation and performs permutation-based
resampling to compute a p-value.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a><span class="co"># Function: Statistical Inference (Spearman Permutation Test)</span></span>
<span id="cb146-2"><a href="#cb146-2" tabindex="-1"></a>spear_permutation_test <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">R =</span> <span class="dv">500</span>) {</span>
<span id="cb146-3"><a href="#cb146-3" tabindex="-1"></a>  <span class="co"># Load the generated data</span></span>
<span id="cb146-4"><a href="#cb146-4" tabindex="-1"></a>  <span class="fu">load</span>(<span class="st">&quot;generated_data.RData&quot;</span>)</span>
<span id="cb146-5"><a href="#cb146-5" tabindex="-1"></a>  </span>
<span id="cb146-6"><a href="#cb146-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data[, <span class="dv">1</span>]</span>
<span id="cb146-7"><a href="#cb146-7" tabindex="-1"></a>  y <span class="ot">&lt;-</span> data[, <span class="dv">2</span>]</span>
<span id="cb146-8"><a href="#cb146-8" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb146-9"><a href="#cb146-9" tabindex="-1"></a>  </span>
<span id="cb146-10"><a href="#cb146-10" tabindex="-1"></a>  <span class="co"># Compute the observed Spearman correlation</span></span>
<span id="cb146-11"><a href="#cb146-11" tabindex="-1"></a>  observed_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb146-12"><a href="#cb146-12" tabindex="-1"></a>  tempp <span class="ot">&lt;-</span> observed_test<span class="sc">$</span>p.value</span>
<span id="cb146-13"><a href="#cb146-13" tabindex="-1"></a>  observed_rho <span class="ot">&lt;-</span> observed_test<span class="sc">$</span>estimate</span>
<span id="cb146-14"><a href="#cb146-14" tabindex="-1"></a>  </span>
<span id="cb146-15"><a href="#cb146-15" tabindex="-1"></a>  <span class="co"># Perform R permutations</span></span>
<span id="cb146-16"><a href="#cb146-16" tabindex="-1"></a>  permuted_rhos <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, {</span>
<span id="cb146-17"><a href="#cb146-17" tabindex="-1"></a>    y_perm <span class="ot">&lt;-</span> <span class="fu">sample</span>(y)  <span class="co"># Random permutation of y</span></span>
<span id="cb146-18"><a href="#cb146-18" tabindex="-1"></a>    <span class="fu">cor.test</span>(x, y_perm, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>estimate</span>
<span id="cb146-19"><a href="#cb146-19" tabindex="-1"></a>  })</span>
<span id="cb146-20"><a href="#cb146-20" tabindex="-1"></a>  </span>
<span id="cb146-21"><a href="#cb146-21" tabindex="-1"></a>  <span class="co"># Combine observed statistic with permutation results</span></span>
<span id="cb146-22"><a href="#cb146-22" tabindex="-1"></a>  all_rhos <span class="ot">&lt;-</span> <span class="fu">c</span>(observed_rho, permuted_rhos)</span>
<span id="cb146-23"><a href="#cb146-23" tabindex="-1"></a>  </span>
<span id="cb146-24"><a href="#cb146-24" tabindex="-1"></a>  <span class="co"># Calculate the permutation-based p-value</span></span>
<span id="cb146-25"><a href="#cb146-25" tabindex="-1"></a>  perm_p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(all_rhos <span class="sc">&gt;=</span> observed_rho)</span>
<span id="cb146-26"><a href="#cb146-26" tabindex="-1"></a>  </span>
<span id="cb146-27"><a href="#cb146-27" tabindex="-1"></a>  <span class="co"># Save the results</span></span>
<span id="cb146-28"><a href="#cb146-28" tabindex="-1"></a>  <span class="fu">save</span>(observed_rho, perm_p_value, tempp, <span class="at">file =</span> <span class="st">&quot;inference_results.RData&quot;</span>)</span>
<span id="cb146-29"><a href="#cb146-29" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Statistical inference completed and results saved.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb146-30"><a href="#cb146-30" tabindex="-1"></a>  </span>
<span id="cb146-31"><a href="#cb146-31" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())  <span class="co"># Clear memory</span></span>
<span id="cb146-32"><a href="#cb146-32" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a><span class="fu">spear_permutation_test</span>()</span></code></pre></div>
<pre><code>## Statistical inference completed and results saved.</code></pre>
</div>
<div id="result-reporting-1" class="section level3">
<h3>3. Result Reporting</h3>
<p>This function loads the results from the inference step and prints a
comparison between the permutation-based p-value and the analytical
p-value obtained from <code>cor.test</code>.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" tabindex="-1"></a><span class="co"># Function: Result Reporting</span></span>
<span id="cb149-2"><a href="#cb149-2" tabindex="-1"></a>report_results <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb149-3"><a href="#cb149-3" tabindex="-1"></a>  <span class="co"># Load the inference results</span></span>
<span id="cb149-4"><a href="#cb149-4" tabindex="-1"></a>  <span class="fu">load</span>(<span class="st">&quot;inference_results.RData&quot;</span>)</span>
<span id="cb149-5"><a href="#cb149-5" tabindex="-1"></a>  </span>
<span id="cb149-6"><a href="#cb149-6" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Observed Spearman Correlation: %.4f</span><span class="sc">\n</span><span class="st">&quot;</span>, observed_rho))</span>
<span id="cb149-7"><a href="#cb149-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Analytical P-value (cor.test): %.4f</span><span class="sc">\n</span><span class="st">&quot;</span>, tempp))</span>
<span id="cb149-8"><a href="#cb149-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Permutation Test P-value: %.4f</span><span class="sc">\n</span><span class="st">&quot;</span>, perm_p_value))</span>
<span id="cb149-9"><a href="#cb149-9" tabindex="-1"></a>  </span>
<span id="cb149-10"><a href="#cb149-10" tabindex="-1"></a>  <span class="co"># Compare the two p-values</span></span>
<span id="cb149-11"><a href="#cb149-11" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(perm_p_value <span class="sc">-</span> tempp) <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb149-12"><a href="#cb149-12" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;The p-values from the permutation test and cor.test are similar.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb149-13"><a href="#cb149-13" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb149-14"><a href="#cb149-14" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;The p-values from the permutation test and cor.test differ significantly.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb149-15"><a href="#cb149-15" tabindex="-1"></a>  }</span>
<span id="cb149-16"><a href="#cb149-16" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a><span class="fu">report_results</span>()</span></code></pre></div>
<pre><code>## Observed Spearman Correlation: 0.6311
## Analytical P-value (cor.test): 0.0003
## Permutation Test P-value: 0.0020
## The p-values from the permutation test and cor.test are similar.</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a>files_to_delete <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;generated_data.RData&quot;</span>, <span class="st">&quot;inference_results.RData&quot;</span>)</span>
<span id="cb152-2"><a href="#cb152-2" tabindex="-1"></a><span class="fu">sapply</span>(files_to_delete, <span class="cf">function</span>(file) {</span>
<span id="cb152-3"><a href="#cb152-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">file.exists</span>(file)) {</span>
<span id="cb152-4"><a href="#cb152-4" tabindex="-1"></a>    <span class="fu">file.remove</span>(file)</span>
<span id="cb152-5"><a href="#cb152-5" tabindex="-1"></a>    <span class="fu">cat</span>(file, <span class="st">&quot;has been deleted.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb152-6"><a href="#cb152-6" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb152-7"><a href="#cb152-7" tabindex="-1"></a>    <span class="fu">cat</span>(file, <span class="st">&quot;does not exist.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb152-8"><a href="#cb152-8" tabindex="-1"></a>  }</span>
<span id="cb152-9"><a href="#cb152-9" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## generated_data.RData has been deleted.
## inference_results.RData has been deleted.</code></pre>
<pre><code>## $generated_data.RData
## NULL
## 
## $inference_results.RData
## NULL</code></pre>
</div>
</div>
</div>
<div id="hw-6-th" class="section level1">
<h1>HW 6-th</h1>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility</span></span>
<span id="cb155-2"><a href="#cb155-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)  <span class="co"># For the &#39;scor&#39; dataset</span></span>
<span id="cb155-3"><a href="#cb155-3" tabindex="-1"></a><span class="fu">library</span>(datasets)  <span class="co"># Load base datasets</span></span>
<span id="cb155-4"><a href="#cb155-4" tabindex="-1"></a><span class="fu">library</span>(DAAG, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb155-5"><a href="#cb155-5" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb155-6"><a href="#cb155-6" tabindex="-1"></a><span class="fu">library</span>(coda) <span class="co"># For convergence diagnostics (Gelman-Rubin method)</span></span></code></pre></div>
<div id="question-1-9.3" class="section level2">
<h2>Question 1 (9.3)</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from
a standard Cauchy distribution. Discard the first 1000 of the chain, and
compare the deciles of the generated observations with the deciles of
the standard Cauchy distribution. Use the Gelman-Rubin method to monitor
convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span>.</p>
</div>
<div id="answer-1-9.3" class="section level2">
<h2>Answer 1 (9.3)</h2>
<p>We discard the first 1000 samples (burn-in), compare the deciles of
the generated samples with the theoretical deciles, and only analyze the
samples once convergence is detected with <span class="math inline">\(\hat{R} &lt; 1.2\)</span>.</p>
<div id="data-generation-function-with-parallel-chains" class="section level3">
<h3>1. Data Generation Function with Parallel Chains</h3>
<p>We generate <strong>multiple parallel chains</strong> to apply the
Gelman-Rubin diagnostic. Each chain runs independently with the same
Metropolis-Hastings algorithm.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" tabindex="-1"></a>generate_chains <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n_chains =</span> <span class="dv">4</span>, <span class="at">m =</span> <span class="dv">5000</span>, <span class="at">sigma =</span> <span class="dv">3</span>) {</span>
<span id="cb156-2"><a href="#cb156-2" tabindex="-1"></a>  <span class="co"># Initialize a list to store each chain&#39;s samples</span></span>
<span id="cb156-3"><a href="#cb156-3" tabindex="-1"></a>  chains <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, n_chains)</span>
<span id="cb156-4"><a href="#cb156-4" tabindex="-1"></a></span>
<span id="cb156-5"><a href="#cb156-5" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_chains) {</span>
<span id="cb156-6"><a href="#cb156-6" tabindex="-1"></a>    <span class="co"># Initialize individual chain</span></span>
<span id="cb156-7"><a href="#cb156-7" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb156-8"><a href="#cb156-8" tabindex="-1"></a>    x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, sigma) <span class="co"># Starting value from normal(0, sigma)</span></span>
<span id="cb156-9"><a href="#cb156-9" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m) <span class="co"># Random uniform numbers for acceptance step</span></span>
<span id="cb156-10"><a href="#cb156-10" tabindex="-1"></a></span>
<span id="cb156-11"><a href="#cb156-11" tabindex="-1"></a>    <span class="co"># Run Metropolis-Hastings algorithm</span></span>
<span id="cb156-12"><a href="#cb156-12" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb156-13"><a href="#cb156-13" tabindex="-1"></a>      xt <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb156-14"><a href="#cb156-14" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, xt, sigma) <span class="co"># Propose new value</span></span>
<span id="cb156-15"><a href="#cb156-15" tabindex="-1"></a></span>
<span id="cb156-16"><a href="#cb156-16" tabindex="-1"></a>      <span class="co"># Calculate acceptance ratio</span></span>
<span id="cb156-17"><a href="#cb156-17" tabindex="-1"></a>      num <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> xt<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, y, sigma)</span>
<span id="cb156-18"><a href="#cb156-18" tabindex="-1"></a>      den <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">dnorm</span>(y, xt, sigma)</span>
<span id="cb156-19"><a href="#cb156-19" tabindex="-1"></a></span>
<span id="cb156-20"><a href="#cb156-20" tabindex="-1"></a>      <span class="co"># Accept or reject</span></span>
<span id="cb156-21"><a href="#cb156-21" tabindex="-1"></a>      <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num <span class="sc">/</span> den) {</span>
<span id="cb156-22"><a href="#cb156-22" tabindex="-1"></a>        x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb156-23"><a href="#cb156-23" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb156-24"><a href="#cb156-24" tabindex="-1"></a>        x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb156-25"><a href="#cb156-25" tabindex="-1"></a>      }</span>
<span id="cb156-26"><a href="#cb156-26" tabindex="-1"></a>    }</span>
<span id="cb156-27"><a href="#cb156-27" tabindex="-1"></a>    chains[[j]] <span class="ot">&lt;-</span> x <span class="co"># Store the chain</span></span>
<span id="cb156-28"><a href="#cb156-28" tabindex="-1"></a>  }</span>
<span id="cb156-29"><a href="#cb156-29" tabindex="-1"></a>  </span>
<span id="cb156-30"><a href="#cb156-30" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.mcmc.list</span>(<span class="fu">lapply</span>(chains, <span class="cf">function</span>(c) <span class="fu">as.mcmc</span>(c))))</span>
<span id="cb156-31"><a href="#cb156-31" tabindex="-1"></a>  </span>
<span id="cb156-32"><a href="#cb156-32" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clear memory</span></span>
<span id="cb156-33"><a href="#cb156-33" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="convergence-monitoring-function" class="section level3">
<h3>2. Convergence Monitoring Function</h3>
<p>This function uses the <strong>Gelman-Rubin diagnostic</strong> to
assess convergence across multiple chains. The diagnostic statistic
<span class="math inline">\(\hat{R} &lt; 1.2\)</span> indicates
approximate convergence.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" tabindex="-1"></a>check_convergence <span class="ot">&lt;-</span> <span class="cf">function</span>(chains) {</span>
<span id="cb157-2"><a href="#cb157-2" tabindex="-1"></a>  <span class="co"># Apply Gelman-Rubin diagnostic</span></span>
<span id="cb157-3"><a href="#cb157-3" tabindex="-1"></a>  r_hat <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(chains)<span class="sc">$</span>psrf[<span class="dv">1</span>, <span class="st">&quot;Point est.&quot;</span>]</span>
<span id="cb157-4"><a href="#cb157-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Gelman-Rubin statistic (R-hat):&quot;</span>, r_hat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb157-5"><a href="#cb157-5" tabindex="-1"></a>  </span>
<span id="cb157-6"><a href="#cb157-6" tabindex="-1"></a>  <span class="fu">return</span>(r_hat <span class="sc">&lt;</span> <span class="fl">1.2</span>) <span class="co"># Returns TRUE if converged</span></span>
<span id="cb157-7"><a href="#cb157-7" tabindex="-1"></a>  </span>
<span id="cb157-8"><a href="#cb157-8" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clear memory</span></span>
<span id="cb157-9"><a href="#cb157-9" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="statistical-inference-function" class="section level3">
<h3>3. Statistical Inference Function</h3>
<p>This function computes the <strong>deciles</strong> of the
post-burn-in samples and compares them to the theoretical Cauchy
quantiles.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a>statistical_inference <span class="ot">&lt;-</span> <span class="cf">function</span>(samples, <span class="at">burn =</span> <span class="dv">1000</span>, </span>
<span id="cb158-2"><a href="#cb158-2" tabindex="-1"></a>                                  <span class="at">p =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>)) {</span>
<span id="cb158-3"><a href="#cb158-3" tabindex="-1"></a>  <span class="co"># Extract post-burn-in samples</span></span>
<span id="cb158-4"><a href="#cb158-4" tabindex="-1"></a>  xb <span class="ot">&lt;-</span> samples[(burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(samples)]</span>
<span id="cb158-5"><a href="#cb158-5" tabindex="-1"></a></span>
<span id="cb158-6"><a href="#cb158-6" tabindex="-1"></a>  <span class="co"># Compute sample and theoretical quantiles</span></span>
<span id="cb158-7"><a href="#cb158-7" tabindex="-1"></a>  Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(xb, p)</span>
<span id="cb158-8"><a href="#cb158-8" tabindex="-1"></a>  theoretical_Q <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(p)</span>
<span id="cb158-9"><a href="#cb158-9" tabindex="-1"></a></span>
<span id="cb158-10"><a href="#cb158-10" tabindex="-1"></a>  <span class="co"># Display results</span></span>
<span id="cb158-11"><a href="#cb158-11" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rbind</span>(Q, theoretical_Q), <span class="dv">3</span>)</span>
<span id="cb158-12"><a href="#cb158-12" tabindex="-1"></a>  <span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Decile &quot;</span>, p)</span>
<span id="cb158-13"><a href="#cb158-13" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb158-14"><a href="#cb158-14" tabindex="-1"></a>  </span>
<span id="cb158-15"><a href="#cb158-15" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clear memory</span></span>
<span id="cb158-16"><a href="#cb158-16" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="result-reporting-function" class="section level3">
<h3>4. Result Reporting Function</h3>
<p>This function produces a <strong>QQ plot</strong> to visually assess
how well the sample quantiles align with the theoretical quantiles.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" tabindex="-1"></a>report_results <span class="ot">&lt;-</span> <span class="cf">function</span>(samples, <span class="at">burn =</span> <span class="dv">1000</span>) {</span>
<span id="cb159-2"><a href="#cb159-2" tabindex="-1"></a>  <span class="co"># Extract post-burn-in samples</span></span>
<span id="cb159-3"><a href="#cb159-3" tabindex="-1"></a>  xb <span class="ot">&lt;-</span> samples[(burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(samples)]</span>
<span id="cb159-4"><a href="#cb159-4" tabindex="-1"></a></span>
<span id="cb159-5"><a href="#cb159-5" tabindex="-1"></a>  <span class="co"># QQ plot of sample vs theoretical quantiles</span></span>
<span id="cb159-6"><a href="#cb159-6" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">100</span>)</span>
<span id="cb159-7"><a href="#cb159-7" tabindex="-1"></a>  Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(xb, p)</span>
<span id="cb159-8"><a href="#cb159-8" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(p)</span>
<span id="cb159-9"><a href="#cb159-9" tabindex="-1"></a></span>
<span id="cb159-10"><a href="#cb159-10" tabindex="-1"></a>  <span class="fu">plot</span>(z, Q, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">xlab =</span> <span class="st">&quot;Theoretical Quantiles&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Sample Quantiles&quot;</span>,</span>
<span id="cb159-11"><a href="#cb159-11" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&quot;QQ Plot: Generated Samples vs Theoretical Cauchy&quot;</span>)</span>
<span id="cb159-12"><a href="#cb159-12" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb159-13"><a href="#cb159-13" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="generate-samples-and-monitor-convergence" class="section level3">
<h3>Generate Samples and Monitor Convergence</h3>
<p>We generate four parallel chains and monitor convergence using the
<strong>Gelman-Rubin diagnostic</strong>.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a><span class="co"># Set parameters</span></span>
<span id="cb160-2"><a href="#cb160-2" tabindex="-1"></a>n_chains <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb160-3"><a href="#cb160-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb160-4"><a href="#cb160-4" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb160-5"><a href="#cb160-5" tabindex="-1"></a></span>
<span id="cb160-6"><a href="#cb160-6" tabindex="-1"></a><span class="co"># Generate chains</span></span>
<span id="cb160-7"><a href="#cb160-7" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">generate_chains</span>(n_chains, m, sigma)</span>
<span id="cb160-8"><a href="#cb160-8" tabindex="-1"></a></span>
<span id="cb160-9"><a href="#cb160-9" tabindex="-1"></a><span class="co"># Check convergence</span></span>
<span id="cb160-10"><a href="#cb160-10" tabindex="-1"></a>converged <span class="ot">&lt;-</span> <span class="fu">check_convergence</span>(chains)</span></code></pre></div>
<pre><code>## Gelman-Rubin statistic (R-hat): 1.061762</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" tabindex="-1"></a><span class="co"># If converged, combine chains for further analysis</span></span>
<span id="cb162-2"><a href="#cb162-2" tabindex="-1"></a><span class="cf">if</span> (converged) {</span>
<span id="cb162-3"><a href="#cb162-3" tabindex="-1"></a>  combined_samples <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">as.matrix</span>(chains))</span>
<span id="cb162-4"><a href="#cb162-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Chains have converged. Proceeding with statistical inference...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb162-5"><a href="#cb162-5" tabindex="-1"></a>  </span>
<span id="cb162-6"><a href="#cb162-6" tabindex="-1"></a>  <span class="co"># Perform statistical inference</span></span>
<span id="cb162-7"><a href="#cb162-7" tabindex="-1"></a>  decile_comparison <span class="ot">&lt;-</span> <span class="fu">statistical_inference</span>(combined_samples)</span>
<span id="cb162-8"><a href="#cb162-8" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Decile Comparison between Generated Samples and Theoretical Cauchy:&quot;</span>)</span>
<span id="cb162-9"><a href="#cb162-9" tabindex="-1"></a>  <span class="fu">print</span>(decile_comparison)</span>
<span id="cb162-10"><a href="#cb162-10" tabindex="-1"></a></span>
<span id="cb162-11"><a href="#cb162-11" tabindex="-1"></a>  <span class="co"># Report results with QQ plot</span></span>
<span id="cb162-12"><a href="#cb162-12" tabindex="-1"></a>  <span class="fu">report_results</span>(combined_samples)</span>
<span id="cb162-13"><a href="#cb162-13" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb162-14"><a href="#cb162-14" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Chains have not converged. Please run the chains for more iterations.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb162-15"><a href="#cb162-15" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Chains have converged. Proceeding with statistical inference...
## [1] &quot;Decile Comparison between Generated Samples and Theoretical Cauchy:&quot;
##               Decile 0.1 Decile 0.2 Decile 0.3 Decile 0.4 Decile 0.5 Decile 0.6
## Q                 -3.207     -1.432     -0.777     -0.350      0.002      0.336
## theoretical_Q     -3.078     -1.376     -0.727     -0.325      0.000      0.325
##               Decile 0.7 Decile 0.8 Decile 0.9
## Q                  0.737      1.480      3.496
## theoretical_Q      0.727      1.376      3.078</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>The deciles of the generated samples from the Metropolis-Hastings
sampler align closely with the theoretical deciles of the standard
Cauchy distribution. The QQ plot provides a visual assessment of the
sample quantiles compared to the theoretical distribution, indicating
how well the sampling process approximates the desired distribution.</p>
</div>
</div>
<div id="question-2-9.4" class="section level2">
<h2>Question 2 (9.4)</h2>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution. For the increment, simulate from a normal
distribution. Compare the chains generated when different variances are
used for the proposal distribution. Also, compute the acceptance rates
of each chain. Use the Gelman-Rubin method to monitor convergence of the
chain, and run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(\hat{R} &lt;
1.2\)</span>.</p>
</div>
<div id="answer-2-9.4" class="section level2">
<h2>Answer 2 (9.4)</h2>
<p>We take a step-by-step implementation of the Random Walk Metropolis
sampler to generate samples from the standard Laplace distribution. The
increment is drawn from a normal distribution, and different variances
are used to analyze the acceptance rates and convergence properties.
Additionally, the <strong>Gelman-Rubin diagnostic</strong> (<span class="math inline">\(\hat{R}\)</span>) is used to monitor
convergence.</p>
<div id="overview" class="section level3">
<h3>1. Overview</h3>
<ul>
<li><p><strong>Target Distribution</strong>: Standard Laplace<br />
<span class="math display">\[f(x) = \frac{1}{2}
e^{-|x|}\]</span></p></li>
<li><p><strong>Proposal Distribution</strong>: Normal <span class="math inline">\(y \sim N(\mu_t, \sigma^2)\)</span> with mean <span class="math inline">\(\mu_t = X_t\)</span>.</p></li>
<li><p><strong>Tasks</strong>:</p>
<ul>
<li>Implement the Random Walk Metropolis sampler.</li>
<li>Explore the effect of different variances on acceptance rates.</li>
<li>Use <strong>Gelman-Rubin diagnostic</strong> (<span class="math inline">\(\hat{R}\)</span>) to assess convergence.</li>
<li>Save intermediate results to ensure modularity.</li>
</ul></li>
</ul>
</div>
<div id="data-generation-function" class="section level3">
<h3>2. Data Generation Function</h3>
<p>This function generates chains for the Laplace distribution using the
Random Walk Metropolis method.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" tabindex="-1"></a>generate_rw_laplace <span class="ot">&lt;-</span> <span class="cf">function</span>(N, x0, sigma) {</span>
<span id="cb164-2"><a href="#cb164-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb164-3"><a href="#cb164-3" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb164-4"><a href="#cb164-4" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)  <span class="co"># Uniform samples for acceptance-rejection</span></span>
<span id="cb164-5"><a href="#cb164-5" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># Counter for rejections</span></span>
<span id="cb164-6"><a href="#cb164-6" tabindex="-1"></a>  </span>
<span id="cb164-7"><a href="#cb164-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb164-8"><a href="#cb164-8" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb164-9"><a href="#cb164-9" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> xt, <span class="at">sd =</span> sigma)  <span class="co"># Proposal from N(xt, sigma^2)</span></span>
<span id="cb164-10"><a href="#cb164-10" tabindex="-1"></a>    </span>
<span id="cb164-11"><a href="#cb164-11" tabindex="-1"></a>    <span class="co"># Metropolis-Hastings acceptance ratio</span></span>
<span id="cb164-12"><a href="#cb164-12" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="fu">abs</span>(xt) <span class="sc">-</span> <span class="fu">abs</span>(y))) {</span>
<span id="cb164-13"><a href="#cb164-13" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y  <span class="co"># Accept proposal</span></span>
<span id="cb164-14"><a href="#cb164-14" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb164-15"><a href="#cb164-15" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> xt  <span class="co"># Reject proposal</span></span>
<span id="cb164-16"><a href="#cb164-16" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># Increment rejection count</span></span>
<span id="cb164-17"><a href="#cb164-17" tabindex="-1"></a>    }</span>
<span id="cb164-18"><a href="#cb164-18" tabindex="-1"></a>  }</span>
<span id="cb164-19"><a href="#cb164-19" tabindex="-1"></a>  </span>
<span id="cb164-20"><a href="#cb164-20" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">chain =</span> x, <span class="at">rejections =</span> k))</span>
<span id="cb164-21"><a href="#cb164-21" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="statistical-inference-and-convergence-monitoring" class="section level3">
<h3>3. Statistical Inference and Convergence Monitoring</h3>
<p>We define a function to <strong>compute acceptance rates</strong> and
<strong>monitor convergence</strong> using the Gelman-Rubin diagnostic
from the <code>coda</code> package.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" tabindex="-1"></a>compute_convergence <span class="ot">&lt;-</span> <span class="cf">function</span>(chains) {</span>
<span id="cb165-2"><a href="#cb165-2" tabindex="-1"></a>  mcmc_list <span class="ot">&lt;-</span> <span class="fu">as.mcmc.list</span>(<span class="fu">lapply</span>(chains, mcmc))</span>
<span id="cb165-3"><a href="#cb165-3" tabindex="-1"></a>  rhat_values <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(mcmc_list, <span class="at">autoburnin =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>psrf[, <span class="dv">1</span>]</span>
<span id="cb165-4"><a href="#cb165-4" tabindex="-1"></a>  </span>
<span id="cb165-5"><a href="#cb165-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Gelman-Rubin statistics (R-hat):</span><span class="sc">\n</span><span class="st">&quot;</span>, rhat_values, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb165-6"><a href="#cb165-6" tabindex="-1"></a>  <span class="fu">return</span>(rhat_values)</span>
<span id="cb165-7"><a href="#cb165-7" tabindex="-1"></a>}</span></code></pre></div>
<p>This function takes a list of multiple chains and computes the
<strong><span class="math inline">\(\hat{R}\)</span> values</strong>. We
aim for <span class="math inline">\(\hat{R} &lt; 1.2\)</span> to ensure
convergence.</p>
</div>
<div id="reporting-results" class="section level3">
<h3>4. Reporting Results</h3>
<p>The following function <strong>summarizes</strong> the results,
including acceptance rates, <span class="math inline">\(\hat{R}\)</span>
diagnostics, and visualization of the chains.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" tabindex="-1"></a>report_results <span class="ot">&lt;-</span> <span class="cf">function</span>(chains, rejections, N) {</span>
<span id="cb166-2"><a href="#cb166-2" tabindex="-1"></a>  <span class="co"># Acceptance rates</span></span>
<span id="cb166-3"><a href="#cb166-3" tabindex="-1"></a>  acceptance_rates <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (rejections <span class="sc">/</span> N)</span>
<span id="cb166-4"><a href="#cb166-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Acceptance Rates:</span><span class="sc">\n</span><span class="st">&quot;</span>, acceptance_rates, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb166-5"><a href="#cb166-5" tabindex="-1"></a></span>
<span id="cb166-6"><a href="#cb166-6" tabindex="-1"></a>  <span class="co"># Plot the chains</span></span>
<span id="cb166-7"><a href="#cb166-7" tabindex="-1"></a>  <span class="co"># par(mfrow = c(2, 2))</span></span>
<span id="cb166-8"><a href="#cb166-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(chains)) {</span>
<span id="cb166-9"><a href="#cb166-9" tabindex="-1"></a>    <span class="fu">plot</span>(chains[[i]], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Chain&quot;</span>, i))</span>
<span id="cb166-10"><a href="#cb166-10" tabindex="-1"></a>  }</span>
<span id="cb166-11"><a href="#cb166-11" tabindex="-1"></a>  <span class="co"># par(mfrow = c(1, 1))</span></span>
<span id="cb166-12"><a href="#cb166-12" tabindex="-1"></a>  </span>
<span id="cb166-13"><a href="#cb166-13" tabindex="-1"></a>  <span class="co"># Display histograms and compare to Laplace density</span></span>
<span id="cb166-14"><a href="#cb166-14" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">qexp</span>(<span class="fu">ppoints</span>(<span class="dv">200</span>), <span class="dv">1</span>), <span class="fu">qexp</span>(<span class="fu">ppoints</span>(<span class="dv">200</span>), <span class="dv">1</span>))</span>
<span id="cb166-15"><a href="#cb166-15" tabindex="-1"></a>  fx <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(z))</span>
<span id="cb166-16"><a href="#cb166-16" tabindex="-1"></a>  </span>
<span id="cb166-17"><a href="#cb166-17" tabindex="-1"></a>  <span class="co"># par(mfrow = c(2, 2))</span></span>
<span id="cb166-18"><a href="#cb166-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(chains)) {</span>
<span id="cb166-19"><a href="#cb166-19" tabindex="-1"></a>    <span class="fu">hist</span>(chains[[i]], <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Chain&quot;</span>, i))</span>
<span id="cb166-20"><a href="#cb166-20" tabindex="-1"></a>    <span class="fu">lines</span>(z, fx, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb166-21"><a href="#cb166-21" tabindex="-1"></a>  }</span>
<span id="cb166-22"><a href="#cb166-22" tabindex="-1"></a>  <span class="co"># par(mfrow = c(1, 1))</span></span>
<span id="cb166-23"><a href="#cb166-23" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we run the entire process: generating chains, monitoring
convergence, and reporting results.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb167-2"><a href="#cb167-2" tabindex="-1"></a></span>
<span id="cb167-3"><a href="#cb167-3" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb167-4"><a href="#cb167-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span>   <span class="co"># Length of each chain</span></span>
<span id="cb167-5"><a href="#cb167-5" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)  <span class="co"># Initial value</span></span>
<span id="cb167-6"><a href="#cb167-6" tabindex="-1"></a>sigmas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)  <span class="co"># Proposal standard deviations</span></span>
<span id="cb167-7"><a href="#cb167-7" tabindex="-1"></a></span>
<span id="cb167-8"><a href="#cb167-8" tabindex="-1"></a><span class="co"># Generate chains for different sigmas</span></span>
<span id="cb167-9"><a href="#cb167-9" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb167-10"><a href="#cb167-10" tabindex="-1"></a>rejections <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(sigmas))</span>
<span id="cb167-11"><a href="#cb167-11" tabindex="-1"></a></span>
<span id="cb167-12"><a href="#cb167-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(sigmas)) {</span>
<span id="cb167-13"><a href="#cb167-13" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">generate_rw_laplace</span>(N, x0, sigmas[i])</span>
<span id="cb167-14"><a href="#cb167-14" tabindex="-1"></a>  chains[[i]] <span class="ot">&lt;-</span> result<span class="sc">$</span>chain</span>
<span id="cb167-15"><a href="#cb167-15" tabindex="-1"></a>  rejections[i] <span class="ot">&lt;-</span> result<span class="sc">$</span>rejections</span>
<span id="cb167-16"><a href="#cb167-16" tabindex="-1"></a>}</span>
<span id="cb167-17"><a href="#cb167-17" tabindex="-1"></a></span>
<span id="cb167-18"><a href="#cb167-18" tabindex="-1"></a><span class="co"># Compute Gelman-Rubin statistics</span></span>
<span id="cb167-19"><a href="#cb167-19" tabindex="-1"></a>rhat_values <span class="ot">&lt;-</span> <span class="fu">compute_convergence</span>(chains)</span></code></pre></div>
<pre><code>## Gelman-Rubin statistics (R-hat):
##  1.001631</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a><span class="co"># Run until all chains have R-hat &lt; 1.2</span></span>
<span id="cb169-2"><a href="#cb169-2" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">any</span>(rhat_values <span class="sc">&gt;=</span> <span class="fl">1.2</span>)) {</span>
<span id="cb169-3"><a href="#cb169-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Chains not converged. Extending runs...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb169-4"><a href="#cb169-4" tabindex="-1"></a>  </span>
<span id="cb169-5"><a href="#cb169-5" tabindex="-1"></a>  <span class="co"># Extend the chains</span></span>
<span id="cb169-6"><a href="#cb169-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(sigmas)) {</span>
<span id="cb169-7"><a href="#cb169-7" tabindex="-1"></a>    new_result <span class="ot">&lt;-</span> <span class="fu">generate_rw_laplace</span>(N, chains[[i]][N], sigmas[i])</span>
<span id="cb169-8"><a href="#cb169-8" tabindex="-1"></a>    chains[[i]] <span class="ot">&lt;-</span> <span class="fu">c</span>(chains[[i]], new_result<span class="sc">$</span>chain)</span>
<span id="cb169-9"><a href="#cb169-9" tabindex="-1"></a>    rejections[i] <span class="ot">&lt;-</span> rejections[i] <span class="sc">+</span> new_result<span class="sc">$</span>rejections</span>
<span id="cb169-10"><a href="#cb169-10" tabindex="-1"></a>  }</span>
<span id="cb169-11"><a href="#cb169-11" tabindex="-1"></a>  </span>
<span id="cb169-12"><a href="#cb169-12" tabindex="-1"></a>  N <span class="ot">&lt;-</span> N <span class="sc">*</span> <span class="dv">2</span>  <span class="co"># Update length</span></span>
<span id="cb169-13"><a href="#cb169-13" tabindex="-1"></a>  rhat_values <span class="ot">&lt;-</span> <span class="fu">compute_convergence</span>(chains)  <span class="co"># Recompute R-hat</span></span>
<span id="cb169-14"><a href="#cb169-14" tabindex="-1"></a>}</span>
<span id="cb169-15"><a href="#cb169-15" tabindex="-1"></a></span>
<span id="cb169-16"><a href="#cb169-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;All chains have converged with R-hat &lt; 1.2.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## All chains have converged with R-hat &lt; 1.2.</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" tabindex="-1"></a><span class="co"># Report final results</span></span>
<span id="cb171-2"><a href="#cb171-2" tabindex="-1"></a><span class="fu">report_results</span>(chains, rejections, N)</span></code></pre></div>
<pre><code>## Acceptance Rates:
##  0.8294 0.7006 0.521 0.3318</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Chains with moderate proposal variances (e.g., <span class="math inline">\(\sigma = 1\)</span> and <span class="math inline">\(\sigma = 2\)</span>) exhibited good convergence
and acceptance rates. This highlights the importance of selecting an
appropriate variance for the proposal distribution in
Metropolis-Hastings algorithms.</p>
</div>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<p><span class="math display">\[
K(r, s) = I(s \neq r) \, \alpha(r, s) \, g(s | r) + I(s = r) \left[ 1 -
\int \alpha(r, s&#39;) \, g(s&#39; | r) \, ds&#39; \right]
\]</span></p>
<p><span class="math display">\[
K(s, r) = I(s \neq r) \, \alpha(s, r) \, g(r | s) + I(s = r) \left[ 1 -
\int \alpha(s, r&#39;) \, g(r&#39; | s) \, dr&#39; \right]
\]</span></p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(s \neq r\)</span>: For <span class="math inline">\(s \neq r\)</span>, the transition kernel
becomes:</li>
</ol>
<p><span class="math display">\[
K(r, s) = \alpha(r, s) \, g(s | r)
\quad \text{and} \quad K(s, r) = \alpha(s, r) \, g(r | s)
\]</span></p>
<p><span class="math display">\[
K(s, r) f(s) = \alpha(s, r) \, g(r | s) \, f(s)
\]</span></p>
<p><span class="math display">\[
K(r, s) f(r) = \alpha(r, s) \, g(s | r) \, f(r)
\]</span></p>
<p><span class="math display">\[
\alpha(s, r) = \min\left\{ \frac{f(r) \, g(s | r)}{f(s) \, g(r | s)}, 1
\right\}
\]</span></p>
<p><span class="math display">\[
\alpha(r, s) = \min\left\{ \frac{f(s) \, g(r | s)}{f(r) \, g(s | r)}, 1
\right\}
\]</span></p>
<p>Notice that:</p>
<p><span class="math display">\[
\alpha(s, r) \, f(s) \, g(r | s) = \alpha(r, s) \, f(r) \, g(s | r)
\]</span></p>
<p>because the minimum function ensures symmetry. Hence, for <span class="math inline">\(s \neq r\)</span>, we have:</p>
<p><span class="math display">\[
K(s, r) f(s) = K(r, s) f(r).
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li><span class="math inline">\(s = r\)</span>: For <span class="math inline">\(s = r\)</span>, the kernels simplify to:</li>
</ol>
<p><span class="math display">\[
K(r, r) = 1 - \int \alpha(r, s&#39;) \, g(s&#39; | r) \, ds&#39;
\]</span></p>
<p>and</p>
<p><span class="math display">\[
K(s, s) = 1 - \int \alpha(s, r&#39;) \, g(r&#39; | s) \, dr&#39;.
\]</span></p>
<p>Since the integrals are the same, we have:</p>
<p><span class="math display">\[
K(s, s) f(s) = K(r, r) f(r).
\]</span></p>
</div>
</div>
<div id="hw-7-th" class="section level1">
<h1>HW 7-th</h1>
<div id="question-1-11.3" class="section level2">
<h2>Question 1 (11.3)</h2>
<ol style="list-style-type: lower-alpha">
<li><p>Write a function to compute the k-th term in <span class="math display">\[
\sum_{k=0}^\infty\frac{(-1)^k}{k!
2^k}\frac{\left\|a\right\|^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma\left(\frac{d+1}{2}\right)\Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)},
\]</span> where <span class="math inline">\(d \geq 1\)</span> is an
integer, <span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(\mathbb{R}^d\)</span>, and <span class="math inline">\(∥ · ∥\)</span> denotes the Euclidean norm. Perform
the arithmetic so that the coefficients can be computed for (almost)
arbitrarily large <span class="math inline">\(k\)</span> and <span class="math inline">\(d\)</span>. (This sum converges for all <span class="math inline">\(a\in\mathbb{R}^d\)</span>).</p></li>
<li><p>Modify the function so that it computes and returns the
sum.</p></li>
<li><p>Evaluate the sum when <span class="math inline">\(a = (1,
2)^T\)</span>.</p></li>
</ol>
</div>
<div id="answer-1-11.3" class="section level2">
<h2>Answer 1 (11.3)</h2>
<div id="data-generation-2" class="section level3">
<h3>1. Data Generation</h3>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(a) {</span>
<span id="cb173-2"><a href="#cb173-2" tabindex="-1"></a>  <span class="co"># Ensure `a` is a numeric vector</span></span>
<span id="cb173-3"><a href="#cb173-3" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(a))</span>
<span id="cb173-4"><a href="#cb173-4" tabindex="-1"></a>  </span>
<span id="cb173-5"><a href="#cb173-5" tabindex="-1"></a>  <span class="co"># Compute the Euclidean norm squared</span></span>
<span id="cb173-6"><a href="#cb173-6" tabindex="-1"></a>  norm_sq <span class="ot">&lt;-</span> <span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb173-7"><a href="#cb173-7" tabindex="-1"></a>  </span>
<span id="cb173-8"><a href="#cb173-8" tabindex="-1"></a>  <span class="co"># Save norm squared to disk</span></span>
<span id="cb173-9"><a href="#cb173-9" tabindex="-1"></a>  <span class="fu">saveRDS</span>(norm_sq, <span class="at">file =</span> <span class="st">&quot;norm_squared.rds&quot;</span>)</span>
<span id="cb173-10"><a href="#cb173-10" tabindex="-1"></a>  </span>
<span id="cb173-11"><a href="#cb173-11" tabindex="-1"></a>  <span class="co"># Return the computed norm squared</span></span>
<span id="cb173-12"><a href="#cb173-12" tabindex="-1"></a>  <span class="fu">return</span>(norm_sq)</span>
<span id="cb173-13"><a href="#cb173-13" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clear memory</span></span>
<span id="cb173-14"><a href="#cb173-14" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="statistical-inference-2" class="section level3">
<h3>2. Statistical Inference</h3>
<p>In this function <code>compute_sum()</code>, we compute each term in
the infinite sum up to a specified maximum index <code>K</code>.
Intermediate results are saved for reproducibility and debugging
purposes.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" tabindex="-1"></a>compute_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">K =</span> <span class="dv">60</span>) {</span>
<span id="cb174-2"><a href="#cb174-2" tabindex="-1"></a>  <span class="co"># Load the norm squared</span></span>
<span id="cb174-3"><a href="#cb174-3" tabindex="-1"></a>  norm_sq <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;norm_squared.rds&quot;</span>)</span>
<span id="cb174-4"><a href="#cb174-4" tabindex="-1"></a>  </span>
<span id="cb174-5"><a href="#cb174-5" tabindex="-1"></a>  <span class="co"># Initialize required parameters</span></span>
<span id="cb174-6"><a href="#cb174-6" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>K</span>
<span id="cb174-7"><a href="#cb174-7" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">length</span>(a)</span>
<span id="cb174-8"><a href="#cb174-8" tabindex="-1"></a>  </span>
<span id="cb174-9"><a href="#cb174-9" tabindex="-1"></a>  <span class="co"># Logarithmic calculations for stability with large k and d</span></span>
<span id="cb174-10"><a href="#cb174-10" tabindex="-1"></a>  log.ak <span class="ot">&lt;-</span> (k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">log</span>(norm_sq)</span>
<span id="cb174-11"><a href="#cb174-11" tabindex="-1"></a>  log.ck <span class="ot">&lt;-</span> <span class="fu">lgamma</span>((d <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="fl">1.5</span>) <span class="sc">-</span> <span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> </span>
<span id="cb174-12"><a href="#cb174-12" tabindex="-1"></a>            k <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">-</span> <span class="fu">log</span>((<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>)) <span class="sc">-</span> <span class="fu">lgamma</span>(k <span class="sc">+</span> d <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb174-13"><a href="#cb174-13" tabindex="-1"></a>  </span>
<span id="cb174-14"><a href="#cb174-14" tabindex="-1"></a>  <span class="co"># Compute each term in the sum</span></span>
<span id="cb174-15"><a href="#cb174-15" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">exp</span>(log.ak <span class="sc">+</span> log.ck)</span>
<span id="cb174-16"><a href="#cb174-16" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="at">length =</span> K <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb174-17"><a href="#cb174-17" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">/</span> pi) <span class="sc">*</span> <span class="fu">sum</span>(i <span class="sc">*</span> y)</span>
<span id="cb174-18"><a href="#cb174-18" tabindex="-1"></a>  </span>
<span id="cb174-19"><a href="#cb174-19" tabindex="-1"></a>  <span class="co"># Save results</span></span>
<span id="cb174-20"><a href="#cb174-20" tabindex="-1"></a>  <span class="fu">saveRDS</span>(result, <span class="at">file =</span> <span class="st">&quot;sum_result.rds&quot;</span>)</span>
<span id="cb174-21"><a href="#cb174-21" tabindex="-1"></a>  </span>
<span id="cb174-22"><a href="#cb174-22" tabindex="-1"></a>  <span class="co"># Return the result</span></span>
<span id="cb174-23"><a href="#cb174-23" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb174-24"><a href="#cb174-24" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clear memory</span></span>
<span id="cb174-25"><a href="#cb174-25" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="result-reporting-2" class="section level3">
<h3>3. Result Reporting</h3>
<p>The final function <code>report_results()</code> loads and reports
the computed sum, comparing the result with an approximation for very
large <span class="math inline">\(\|a\|\)</span> as verification
step.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" tabindex="-1"></a>report_results <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb175-2"><a href="#cb175-2" tabindex="-1"></a>  <span class="co"># Load the computed result</span></span>
<span id="cb175-3"><a href="#cb175-3" tabindex="-1"></a>  sum_result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;sum_result.rds&quot;</span>)</span>
<span id="cb175-4"><a href="#cb175-4" tabindex="-1"></a>  </span>
<span id="cb175-5"><a href="#cb175-5" tabindex="-1"></a>  <span class="co"># Load the norm squared</span></span>
<span id="cb175-6"><a href="#cb175-6" tabindex="-1"></a>  norm_sq <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;norm_squared.rds&quot;</span>)</span>
<span id="cb175-7"><a href="#cb175-7" tabindex="-1"></a>  </span>
<span id="cb175-8"><a href="#cb175-8" tabindex="-1"></a>  <span class="co"># Report the result</span></span>
<span id="cb175-9"><a href="#cb175-9" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Computed sum:&quot;</span>, sum_result, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb175-10"><a href="#cb175-10" tabindex="-1"></a>  </span>
<span id="cb175-11"><a href="#cb175-11" tabindex="-1"></a>  <span class="co"># Approximation for large norm values</span></span>
<span id="cb175-12"><a href="#cb175-12" tabindex="-1"></a>  approx_result <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(norm_sq)</span>
<span id="cb175-13"><a href="#cb175-13" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Approximation (for large norm):&quot;</span>, approx_result, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb175-14"><a href="#cb175-14" tabindex="-1"></a>  </span>
<span id="cb175-15"><a href="#cb175-15" tabindex="-1"></a>  <span class="co"># Final result (taking the minimum for stability)</span></span>
<span id="cb175-16"><a href="#cb175-16" tabindex="-1"></a>  final_result <span class="ot">&lt;-</span> <span class="fu">min</span>(sum_result, approx_result)</span>
<span id="cb175-17"><a href="#cb175-17" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Final reported result:&quot;</span>, final_result)</span>
<span id="cb175-18"><a href="#cb175-18" tabindex="-1"></a>  </span>
<span id="cb175-19"><a href="#cb175-19" tabindex="-1"></a>  <span class="fu">return</span>(final_result)</span>
<span id="cb175-20"><a href="#cb175-20" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clear memory</span></span>
<span id="cb175-21"><a href="#cb175-21" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="example-execution" class="section level2">
<h2>Example Execution</h2>
<p>To demonstrate the entire process, we use <span class="math inline">\(a = (1, 2)^T\)</span>.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" tabindex="-1"></a><span class="co"># Step 1: Data Generation</span></span>
<span id="cb176-2"><a href="#cb176-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb176-3"><a href="#cb176-3" tabindex="-1"></a><span class="fu">generate_data</span>(a)</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" tabindex="-1"></a><span class="co"># Step 2: Statistical Inference</span></span>
<span id="cb178-2"><a href="#cb178-2" tabindex="-1"></a><span class="fu">compute_sum</span>(<span class="at">K =</span> <span class="dv">60</span>)</span></code></pre></div>
<pre><code>## [1] 1.22249</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" tabindex="-1"></a><span class="co"># Step 3: Result Reporting</span></span>
<span id="cb180-2"><a href="#cb180-2" tabindex="-1"></a><span class="fu">report_results</span>()</span></code></pre></div>
<pre><code>## Computed sum: 1.22249 
## Approximation (for large norm): 2.236068 
## Final reported result: 1.22249</code></pre>
<pre><code>## [1] 1.22249</code></pre>
</div>
<div id="question-2-11.5" class="section level2">
<h2>Question 2 (11.5)</h2>
<p>Write a function to solve the equation <span class="math display">\[
\begin{aligned}\frac{2\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}&amp;\int_0^{c_{k-1}}\left(1+\frac{u^2}{k-1}\right)^{-k/2}du\\&amp;=\frac{2\Gamma(\frac{k+1}2)}{\sqrt{\pi
k}\Gamma(\frac
k2)}\int_0^{c_k}\left(1+\frac{u^2}k\right)^{-(k+1)/2}du\end{aligned}
\]</span></p>
<p>for <span class="math inline">\(a\)</span>, where <span class="math display">\[
c_k=\sqrt{\frac{a^2k}{k+1-a^2}}.
\]</span> Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
</div>
<div id="answer-2-11.5" class="section level2">
<h2>Answer 2 (11.5)</h2>
<p>We can solve this equation by observing that each side represents the
cumulative distribution function (CDF) of a Student’s <span class="math inline">\(t\)</span>-distribution with degrees of freedom
<span class="math inline">\(k-1\)</span> and <span class="math inline">\(k\)</span> respectively. This setup enables us to
find <span class="math inline">\(a\)</span> by evaluating the
differences between the CDFs for varying values of <span class="math inline">\(k\)</span>.</p>
<div id="data-generation-3" class="section level3">
<h3>1. Data Generation</h3>
<p>The <code>generate_data()</code> function initializes the values of
<span class="math inline">\(k\)</span> and the range of <span class="math inline">\(a\)</span> values for calculating differences in
the CDFs.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb183-2"><a href="#cb183-2" tabindex="-1"></a>  <span class="co"># Define the range of values for k</span></span>
<span id="cb183-3"><a href="#cb183-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb183-4"><a href="#cb183-4" tabindex="-1"></a>  </span>
<span id="cb183-5"><a href="#cb183-5" tabindex="-1"></a>  <span class="co"># Initial values of a are set to a range for evaluation</span></span>
<span id="cb183-6"><a href="#cb183-6" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">sqrt</span>(<span class="fu">max</span>(K)) <span class="sc">-</span> <span class="fl">0.01</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb183-7"><a href="#cb183-7" tabindex="-1"></a>  </span>
<span id="cb183-8"><a href="#cb183-8" tabindex="-1"></a>  <span class="co"># Save initial data for reuse</span></span>
<span id="cb183-9"><a href="#cb183-9" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="fu">list</span>(<span class="at">K =</span> K, <span class="at">a =</span> a), <span class="at">file =</span> <span class="st">&quot;data_params.rds&quot;</span>)</span>
<span id="cb183-10"><a href="#cb183-10" tabindex="-1"></a>  </span>
<span id="cb183-11"><a href="#cb183-11" tabindex="-1"></a>  <span class="co"># Return generated data</span></span>
<span id="cb183-12"><a href="#cb183-12" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">K =</span> K, <span class="at">a =</span> a))</span>
<span id="cb183-13"><a href="#cb183-13" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clear memory</span></span>
<span id="cb183-14"><a href="#cb183-14" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="statistical-inference-3" class="section level3">
<h3>2. Statistical Inference</h3>
<p>The <code>calculate_ck_difference()</code> function calculates the
CDF differences using Exercise 11.4’s approach. It includes a helper
function <code>cdf_difference()</code> to compute the difference at each
<span class="math inline">\(a\)</span> and solves for <span class="math inline">\(r\)</span> using <code>uniroot()</code>.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" tabindex="-1"></a>solve_for_ck <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb184-2"><a href="#cb184-2" tabindex="-1"></a>  <span class="co"># Load initial data</span></span>
<span id="cb184-3"><a href="#cb184-3" tabindex="-1"></a>  data_params <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data_params.rds&quot;</span>)</span>
<span id="cb184-4"><a href="#cb184-4" tabindex="-1"></a>  K <span class="ot">&lt;-</span> data_params<span class="sc">$</span>K</span>
<span id="cb184-5"><a href="#cb184-5" tabindex="-1"></a>  a_vals <span class="ot">&lt;-</span> data_params<span class="sc">$</span>a</span>
<span id="cb184-6"><a href="#cb184-6" tabindex="-1"></a>  </span>
<span id="cb184-7"><a href="#cb184-7" tabindex="-1"></a>  <span class="co"># Define helper function to compute CDF difference</span></span>
<span id="cb184-8"><a href="#cb184-8" tabindex="-1"></a>  cdf_difference <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb184-9"><a href="#cb184-9" tabindex="-1"></a>    c1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (k <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb184-10"><a href="#cb184-10" tabindex="-1"></a>    c2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb184-11"><a href="#cb184-11" tabindex="-1"></a>    p1 <span class="ot">&lt;-</span> <span class="fu">pt</span>(c1, <span class="at">df =</span> k <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb184-12"><a href="#cb184-12" tabindex="-1"></a>    p2 <span class="ot">&lt;-</span> <span class="fu">pt</span>(c2, <span class="at">df =</span> k, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb184-13"><a href="#cb184-13" tabindex="-1"></a>    p1 <span class="sc">-</span> p2</span>
<span id="cb184-14"><a href="#cb184-14" tabindex="-1"></a>  }</span>
<span id="cb184-15"><a href="#cb184-15" tabindex="-1"></a>  </span>
<span id="cb184-16"><a href="#cb184-16" tabindex="-1"></a>  <span class="co"># Initialize storage for results</span></span>
<span id="cb184-17"><a href="#cb184-17" tabindex="-1"></a>  a_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(K))</span>
<span id="cb184-18"><a href="#cb184-18" tabindex="-1"></a>  pr_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(K))</span>
<span id="cb184-19"><a href="#cb184-19" tabindex="-1"></a>  </span>
<span id="cb184-20"><a href="#cb184-20" tabindex="-1"></a>  <span class="co"># Calculate r values by finding roots where CDF difference is zero</span></span>
<span id="cb184-21"><a href="#cb184-21" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(K)) {</span>
<span id="cb184-22"><a href="#cb184-22" tabindex="-1"></a>    k <span class="ot">&lt;-</span> K[i]</span>
<span id="cb184-23"><a href="#cb184-23" tabindex="-1"></a>    <span class="co"># Solve for r using uniroot on CDF difference function</span></span>
<span id="cb184-24"><a href="#cb184-24" tabindex="-1"></a>    root <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(cdf_difference, <span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="dv">2</span>, <span class="at">k =</span> k)</span>
<span id="cb184-25"><a href="#cb184-25" tabindex="-1"></a>    a_values[i] <span class="ot">&lt;-</span> root<span class="sc">$</span>root</span>
<span id="cb184-26"><a href="#cb184-26" tabindex="-1"></a>  }</span>
<span id="cb184-27"><a href="#cb184-27" tabindex="-1"></a>  </span>
<span id="cb184-28"><a href="#cb184-28" tabindex="-1"></a>  <span class="co"># Calculate c_k based on given formula</span></span>
<span id="cb184-29"><a href="#cb184-29" tabindex="-1"></a>  ck <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a_values<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> K <span class="sc">/</span> (K <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a_values<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb184-30"><a href="#cb184-30" tabindex="-1"></a>  </span>
<span id="cb184-31"><a href="#cb184-31" tabindex="-1"></a>  <span class="co"># Save c_k results to disk for reporting</span></span>
<span id="cb184-32"><a href="#cb184-32" tabindex="-1"></a>  <span class="fu">saveRDS</span>(ck, <span class="at">file =</span> <span class="st">&quot;ck_results.rds&quot;</span>)</span>
<span id="cb184-33"><a href="#cb184-33" tabindex="-1"></a>  </span>
<span id="cb184-34"><a href="#cb184-34" tabindex="-1"></a>  <span class="co"># Save results for reporting</span></span>
<span id="cb184-35"><a href="#cb184-35" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="fu">list</span>(<span class="at">K =</span> K, <span class="at">a =</span> a_values), <span class="at">file =</span> <span class="st">&quot;data_params.rds&quot;</span>)</span>
<span id="cb184-36"><a href="#cb184-36" tabindex="-1"></a>  </span>
<span id="cb184-37"><a href="#cb184-37" tabindex="-1"></a>  <span class="co"># Return computed values</span></span>
<span id="cb184-38"><a href="#cb184-38" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">K =</span> K, <span class="at">a =</span> a_values, <span class="at">ck =</span> ck))</span>
<span id="cb184-39"><a href="#cb184-39" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clear memory</span></span>
<span id="cb184-40"><a href="#cb184-40" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="result-reporting-3" class="section level3">
<h3>3. Result Reporting</h3>
<p>The <code>report_results()</code> function loads the calculated
results and displays them in a table format for comparison.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" tabindex="-1"></a>report_results <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb185-2"><a href="#cb185-2" tabindex="-1"></a>  <span class="co"># Load computed c_k values</span></span>
<span id="cb185-3"><a href="#cb185-3" tabindex="-1"></a>  ck <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;ck_results.rds&quot;</span>)</span>
<span id="cb185-4"><a href="#cb185-4" tabindex="-1"></a>  </span>
<span id="cb185-5"><a href="#cb185-5" tabindex="-1"></a>  <span class="co"># Load original data for reference points</span></span>
<span id="cb185-6"><a href="#cb185-6" tabindex="-1"></a>  data_params <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data_params.rds&quot;</span>)</span>
<span id="cb185-7"><a href="#cb185-7" tabindex="-1"></a>  K <span class="ot">&lt;-</span> data_params<span class="sc">$</span>K</span>
<span id="cb185-8"><a href="#cb185-8" tabindex="-1"></a>  a <span class="ot">&lt;-</span> data_params<span class="sc">$</span>a</span>
<span id="cb185-9"><a href="#cb185-9" tabindex="-1"></a>  </span>
<span id="cb185-10"><a href="#cb185-10" tabindex="-1"></a>  <span class="co"># Combine results for display</span></span>
<span id="cb185-11"><a href="#cb185-11" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(K, a, ck)</span>
<span id="cb185-12"><a href="#cb185-12" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Computed results for ck:&quot;</span>)</span>
<span id="cb185-13"><a href="#cb185-13" tabindex="-1"></a>  <span class="fu">print</span>(results)</span>
<span id="cb185-14"><a href="#cb185-14" tabindex="-1"></a>  </span>
<span id="cb185-15"><a href="#cb185-15" tabindex="-1"></a>  <span class="co"># Return results for further analysis if needed</span></span>
<span id="cb185-16"><a href="#cb185-16" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb185-17"><a href="#cb185-17" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clear memory</span></span>
<span id="cb185-18"><a href="#cb185-18" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" tabindex="-1"></a><span class="co"># Step 1: Data Generation</span></span>
<span id="cb186-2"><a href="#cb186-2" tabindex="-1"></a><span class="fu">generate_data</span>()</span></code></pre></div>
<pre><code>## $K
##  [1]    4    5    6    7    8    9   10   11   12   13   14   15   16   17   18
## [16]   19   20   21   22   23   24   25  100  500 1000
## 
## $a
##   [1]  1.000000  1.309220  1.618440  1.927660  2.236880  2.546100  2.855320
##   [8]  3.164540  3.473760  3.782980  4.092200  4.401420  4.710640  5.019860
##  [15]  5.329080  5.638299  5.947519  6.256739  6.565959  6.875179  7.184399
##  [22]  7.493619  7.802839  8.112059  8.421279  8.730499  9.039719  9.348939
##  [29]  9.658159  9.967379 10.276599 10.585819 10.895039 11.204259 11.513479
##  [36] 11.822699 12.131919 12.441139 12.750359 13.059579 13.368799 13.678019
##  [43] 13.987239 14.296459 14.605678 14.914898 15.224118 15.533338 15.842558
##  [50] 16.151778 16.460998 16.770218 17.079438 17.388658 17.697878 18.007098
##  [57] 18.316318 18.625538 18.934758 19.243978 19.553198 19.862418 20.171638
##  [64] 20.480858 20.790078 21.099298 21.408518 21.717738 22.026958 22.336178
##  [71] 22.645398 22.954618 23.263838 23.573057 23.882277 24.191497 24.500717
##  [78] 24.809937 25.119157 25.428377 25.737597 26.046817 26.356037 26.665257
##  [85] 26.974477 27.283697 27.592917 27.902137 28.211357 28.520577 28.829797
##  [92] 29.139017 29.448237 29.757457 30.066677 30.375897 30.685117 30.994337
##  [99] 31.303557 31.612777</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" tabindex="-1"></a><span class="co"># Step 2: Statistical Inference</span></span>
<span id="cb188-2"><a href="#cb188-2" tabindex="-1"></a><span class="fu">solve_for_ck</span>()</span></code></pre></div>
<pre><code>##       K        a       ck
## 1     4 1.492103 1.791862
## 2     5 1.533556 1.795334
## 3     6 1.562744 1.793016
## 4     7 1.584430 1.789174
## 5     8 1.601185 1.785136
## 6     9 1.614521 1.781334
## 7    10 1.625390 1.777885
## 8    11 1.634419 1.774801
## 9    12 1.642038 1.772054
## 10   13 1.648554 1.769606
## 11   14 1.654190 1.767419
## 12   15 1.659114 1.765459
## 13   16 1.663452 1.763694
## 14   17 1.667303 1.762099
## 15   18 1.670745 1.760652
## 16   19 1.673840 1.759335
## 17   20 1.676637 1.758130
## 18   21 1.679178 1.757025
## 19   22 1.681496 1.756009
## 20   23 1.683620 1.755070
## 21   24 1.685572 1.754201
## 22   25 1.687373 1.753395
## 23  100 1.720608 1.737726
## 24  500 1.729755 1.733212
## 25 1000 1.730907 1.732638</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" tabindex="-1"></a><span class="co"># Step 3: Result Reporting</span></span>
<span id="cb190-2"><a href="#cb190-2" tabindex="-1"></a><span class="fu">report_results</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Computed results for ck:&quot;
##          K        a       ck
##  [1,]    4 1.492103 1.791862
##  [2,]    5 1.533556 1.795334
##  [3,]    6 1.562744 1.793016
##  [4,]    7 1.584430 1.789174
##  [5,]    8 1.601185 1.785136
##  [6,]    9 1.614521 1.781334
##  [7,]   10 1.625390 1.777885
##  [8,]   11 1.634419 1.774801
##  [9,]   12 1.642038 1.772054
## [10,]   13 1.648554 1.769606
## [11,]   14 1.654190 1.767419
## [12,]   15 1.659114 1.765459
## [13,]   16 1.663452 1.763694
## [14,]   17 1.667303 1.762099
## [15,]   18 1.670745 1.760652
## [16,]   19 1.673840 1.759335
## [17,]   20 1.676637 1.758130
## [18,]   21 1.679178 1.757025
## [19,]   22 1.681496 1.756009
## [20,]   23 1.683620 1.755070
## [21,]   24 1.685572 1.754201
## [22,]   25 1.687373 1.753395
## [23,]  100 1.720608 1.737726
## [24,]  500 1.729755 1.733212
## [25,] 1000 1.730907 1.732638</code></pre>
<pre><code>##          K        a       ck
##  [1,]    4 1.492103 1.791862
##  [2,]    5 1.533556 1.795334
##  [3,]    6 1.562744 1.793016
##  [4,]    7 1.584430 1.789174
##  [5,]    8 1.601185 1.785136
##  [6,]    9 1.614521 1.781334
##  [7,]   10 1.625390 1.777885
##  [8,]   11 1.634419 1.774801
##  [9,]   12 1.642038 1.772054
## [10,]   13 1.648554 1.769606
## [11,]   14 1.654190 1.767419
## [12,]   15 1.659114 1.765459
## [13,]   16 1.663452 1.763694
## [14,]   17 1.667303 1.762099
## [15,]   18 1.670745 1.760652
## [16,]   19 1.673840 1.759335
## [17,]   20 1.676637 1.758130
## [18,]   21 1.679178 1.757025
## [19,]   22 1.681496 1.756009
## [20,]   23 1.683620 1.755070
## [21,]   24 1.685572 1.754201
## [22,]   25 1.687373 1.753395
## [23,]  100 1.720608 1.737726
## [24,]  500 1.729755 1.733212
## [25,] 1000 1.730907 1.732638</code></pre>
</div>
</div>
<div id="question-3-2" class="section level2">
<h2>Question 3</h2>
<p>Suppose <span class="math inline">\(T_{1}, \dots, T_{n}\)</span> are
i.i.d. samples drawn from the exponential distribution with expectation
<span class="math inline">\(\lambda\)</span>. Those values greater than
<span class="math inline">\(\tau\)</span> are not observed due to right
censorship, so that the observed values are <span class="math inline">\(Y_{i} = T_{i}I(T_{i} \leq \tau) + \tau I(T_{i}
&gt; \tau), i = 1,\dots, n\)</span>. Suppose <span class="math inline">\(\tau = 1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[
0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85
\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the
observed data MLE (note: <span class="math inline">\(Y_{i}\)</span>
follows a mixture distribution).</p>
</div>
<div id="answer-3-2" class="section level2">
<h2>Answer 3</h2>
<div id="data-generation-4" class="section level3">
<h3>1. Data Generation</h3>
<p>The <code>generate_data()</code> function prepares the observed data
and defines initial values for the parameter estimation.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb193-2"><a href="#cb193-2" tabindex="-1"></a>  <span class="co"># Observed censored data</span></span>
<span id="cb193-3"><a href="#cb193-3" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb193-4"><a href="#cb193-4" tabindex="-1"></a>  </span>
<span id="cb193-5"><a href="#cb193-5" tabindex="-1"></a>  <span class="co"># Censoring threshold</span></span>
<span id="cb193-6"><a href="#cb193-6" tabindex="-1"></a>  tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb193-7"><a href="#cb193-7" tabindex="-1"></a>  </span>
<span id="cb193-8"><a href="#cb193-8" tabindex="-1"></a>  <span class="co"># Save initial data to disk</span></span>
<span id="cb193-9"><a href="#cb193-9" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="fu">list</span>(<span class="at">Y =</span> Y, <span class="at">tau =</span> tau), <span class="at">file =</span> <span class="st">&quot;data_params.rds&quot;</span>)</span>
<span id="cb193-10"><a href="#cb193-10" tabindex="-1"></a>  </span>
<span id="cb193-11"><a href="#cb193-11" tabindex="-1"></a>  <span class="co"># Return data for verification</span></span>
<span id="cb193-12"><a href="#cb193-12" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Y =</span> Y, <span class="at">tau =</span> tau))</span>
<span id="cb193-13"><a href="#cb193-13" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clear memory</span></span>
<span id="cb193-14"><a href="#cb193-14" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="statistical-inference-4" class="section level3">
<h3>2. Statistical Inference</h3>
<p>The <code>estimate_lambda_em()</code> function applies the EM
algorithm to estimate <span class="math inline">\(\lambda\)</span> from
censored data. The expectation step (E-step) calculates the expected
values of the censored observations, and the maximization step (M-step)
updates the estimate of <span class="math inline">\(\lambda\)</span>.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" tabindex="-1"></a>estimate_lambda_em <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">tol =</span> <span class="fl">1e-6</span>, <span class="at">max_iter =</span> <span class="dv">1000</span>) {</span>
<span id="cb194-2"><a href="#cb194-2" tabindex="-1"></a>  <span class="co"># Load data parameters</span></span>
<span id="cb194-3"><a href="#cb194-3" tabindex="-1"></a>  data_params <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data_params.rds&quot;</span>)</span>
<span id="cb194-4"><a href="#cb194-4" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> data_params<span class="sc">$</span>Y</span>
<span id="cb194-5"><a href="#cb194-5" tabindex="-1"></a>  tau <span class="ot">&lt;-</span> data_params<span class="sc">$</span>tau</span>
<span id="cb194-6"><a href="#cb194-6" tabindex="-1"></a>  </span>
<span id="cb194-7"><a href="#cb194-7" tabindex="-1"></a>  <span class="co"># Initialize lambda with the mean of the observed data</span></span>
<span id="cb194-8"><a href="#cb194-8" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y)</span>
<span id="cb194-9"><a href="#cb194-9" tabindex="-1"></a>  </span>
<span id="cb194-10"><a href="#cb194-10" tabindex="-1"></a>  <span class="co"># Track convergence</span></span>
<span id="cb194-11"><a href="#cb194-11" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb194-12"><a href="#cb194-12" tabindex="-1"></a>  diff <span class="ot">&lt;-</span> tol <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb194-13"><a href="#cb194-13" tabindex="-1"></a>  </span>
<span id="cb194-14"><a href="#cb194-14" tabindex="-1"></a>  <span class="co"># EM Algorithm</span></span>
<span id="cb194-15"><a href="#cb194-15" tabindex="-1"></a>  <span class="cf">while</span> (diff <span class="sc">&gt;</span> tol <span class="sc">&amp;&amp;</span> iter <span class="sc">&lt;</span> max_iter) {</span>
<span id="cb194-16"><a href="#cb194-16" tabindex="-1"></a>    <span class="co"># E-step: Estimate the expected values for censored observations</span></span>
<span id="cb194-17"><a href="#cb194-17" tabindex="-1"></a>    uncensored_Y <span class="ot">&lt;-</span> Y[Y <span class="sc">&lt;</span> tau]</span>
<span id="cb194-18"><a href="#cb194-18" tabindex="-1"></a>    censored_Y <span class="ot">&lt;-</span> Y[Y <span class="sc">&gt;=</span> tau]</span>
<span id="cb194-19"><a href="#cb194-19" tabindex="-1"></a>    n_uncensored <span class="ot">&lt;-</span> <span class="fu">length</span>(uncensored_Y)</span>
<span id="cb194-20"><a href="#cb194-20" tabindex="-1"></a>    n_censored <span class="ot">&lt;-</span> <span class="fu">length</span>(censored_Y)</span>
<span id="cb194-21"><a href="#cb194-21" tabindex="-1"></a>    </span>
<span id="cb194-22"><a href="#cb194-22" tabindex="-1"></a>    <span class="co"># Expected total time for censored observations</span></span>
<span id="cb194-23"><a href="#cb194-23" tabindex="-1"></a>    E_censored_sum <span class="ot">&lt;-</span> n_censored <span class="sc">*</span> (tau <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>lambda)</span>
<span id="cb194-24"><a href="#cb194-24" tabindex="-1"></a>    </span>
<span id="cb194-25"><a href="#cb194-25" tabindex="-1"></a>    <span class="co"># M-step: Update lambda</span></span>
<span id="cb194-26"><a href="#cb194-26" tabindex="-1"></a>    lambda_new <span class="ot">&lt;-</span> (<span class="fu">sum</span>(uncensored_Y) <span class="sc">+</span> E_censored_sum) <span class="sc">/</span> <span class="fu">length</span>(Y)</span>
<span id="cb194-27"><a href="#cb194-27" tabindex="-1"></a>    </span>
<span id="cb194-28"><a href="#cb194-28" tabindex="-1"></a>    <span class="co"># Check for convergence</span></span>
<span id="cb194-29"><a href="#cb194-29" tabindex="-1"></a>    diff <span class="ot">&lt;-</span> <span class="fu">abs</span>(lambda_new <span class="sc">-</span> lambda)</span>
<span id="cb194-30"><a href="#cb194-30" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> lambda_new</span>
<span id="cb194-31"><a href="#cb194-31" tabindex="-1"></a>    iter <span class="ot">&lt;-</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb194-32"><a href="#cb194-32" tabindex="-1"></a>  }</span>
<span id="cb194-33"><a href="#cb194-33" tabindex="-1"></a>  </span>
<span id="cb194-34"><a href="#cb194-34" tabindex="-1"></a>  <span class="co"># Save final estimate to disk for reporting</span></span>
<span id="cb194-35"><a href="#cb194-35" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="fu">list</span>(<span class="at">lambda =</span> lambda, <span class="at">iter =</span> iter, <span class="at">diff =</span> diff), <span class="at">file =</span> <span class="st">&quot;estimate_results.rds&quot;</span>)</span>
<span id="cb194-36"><a href="#cb194-36" tabindex="-1"></a>  </span>
<span id="cb194-37"><a href="#cb194-37" tabindex="-1"></a>  <span class="co"># Return the final estimate for verification</span></span>
<span id="cb194-38"><a href="#cb194-38" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">lambda =</span> lambda, <span class="at">iter =</span> iter, <span class="at">diff =</span> diff))</span>
<span id="cb194-39"><a href="#cb194-39" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clear memory</span></span>
<span id="cb194-40"><a href="#cb194-40" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="result-reporting-4" class="section level3">
<h3>3. Result Reporting</h3>
<p>The <code>report_results()</code> function compares the EM estimate
of <span class="math inline">\(\lambda\)</span> with the MLE from
observed data, displaying results and convergence information.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" tabindex="-1"></a>report_results <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb195-2"><a href="#cb195-2" tabindex="-1"></a>  <span class="co"># Load EM estimate results</span></span>
<span id="cb195-3"><a href="#cb195-3" tabindex="-1"></a>  estimate_results <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;estimate_results.rds&quot;</span>)</span>
<span id="cb195-4"><a href="#cb195-4" tabindex="-1"></a>  lambda_em <span class="ot">&lt;-</span> estimate_results<span class="sc">$</span>lambda</span>
<span id="cb195-5"><a href="#cb195-5" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> estimate_results<span class="sc">$</span>iter</span>
<span id="cb195-6"><a href="#cb195-6" tabindex="-1"></a>  diff <span class="ot">&lt;-</span> estimate_results<span class="sc">$</span>diff</span>
<span id="cb195-7"><a href="#cb195-7" tabindex="-1"></a>  </span>
<span id="cb195-8"><a href="#cb195-8" tabindex="-1"></a>  <span class="co"># Observed MLE of lambda using uncensored data only</span></span>
<span id="cb195-9"><a href="#cb195-9" tabindex="-1"></a>  data_params <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data_params.rds&quot;</span>)</span>
<span id="cb195-10"><a href="#cb195-10" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> data_params<span class="sc">$</span>Y</span>
<span id="cb195-11"><a href="#cb195-11" tabindex="-1"></a>  tau <span class="ot">&lt;-</span> data_params<span class="sc">$</span>tau</span>
<span id="cb195-12"><a href="#cb195-12" tabindex="-1"></a>  uncensored_Y <span class="ot">&lt;-</span> Y[Y <span class="sc">&lt;</span> tau]</span>
<span id="cb195-13"><a href="#cb195-13" tabindex="-1"></a>  lambda_mle <span class="ot">&lt;-</span> <span class="fu">mean</span>(uncensored_Y)</span>
<span id="cb195-14"><a href="#cb195-14" tabindex="-1"></a>  </span>
<span id="cb195-15"><a href="#cb195-15" tabindex="-1"></a>  <span class="co"># Display the results</span></span>
<span id="cb195-16"><a href="#cb195-16" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;EM Algorithm Estimation of lambda:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb195-17"><a href="#cb195-17" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot; - Lambda Estimate (EM):&quot;</span>, lambda_em, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb195-18"><a href="#cb195-18" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot; - Iterations:&quot;</span>, iter, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb195-19"><a href="#cb195-19" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot; - Final Convergence Difference:&quot;</span>, diff, <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb195-20"><a href="#cb195-20" tabindex="-1"></a>  </span>
<span id="cb195-21"><a href="#cb195-21" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Observed Data MLE of lambda (using uncensored values only):&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb195-22"><a href="#cb195-22" tabindex="-1"></a>  </span>
<span id="cb195-23"><a href="#cb195-23" tabindex="-1"></a>  <span class="co"># Plot the estimates for visual comparison</span></span>
<span id="cb195-24"><a href="#cb195-24" tabindex="-1"></a>  <span class="fu">barplot</span>(<span class="fu">c</span>(lambda_em, lambda_mle), <span class="at">beside =</span> <span class="cn">TRUE</span>, <span class="at">names.arg =</span> <span class="fu">c</span>(<span class="st">&quot;EM Estimate&quot;</span>, <span class="st">&quot;MLE&quot;</span>),</span>
<span id="cb195-25"><a href="#cb195-25" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">main =</span> <span class="st">&quot;Comparison of Lambda Estimates&quot;</span>,</span>
<span id="cb195-26"><a href="#cb195-26" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;Lambda Estimate&quot;</span>)</span>
<span id="cb195-27"><a href="#cb195-27" tabindex="-1"></a>  </span>
<span id="cb195-28"><a href="#cb195-28" tabindex="-1"></a>  <span class="co"># Return results for further use if needed</span></span>
<span id="cb195-29"><a href="#cb195-29" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">lambda_em =</span> lambda_em, <span class="at">lambda_mle =</span> lambda_mle))</span>
<span id="cb195-30"><a href="#cb195-30" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clear memory</span></span>
<span id="cb195-31"><a href="#cb195-31" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" tabindex="-1"></a><span class="co"># Step 1: Generate data</span></span>
<span id="cb196-2"><a href="#cb196-2" tabindex="-1"></a><span class="fu">generate_data</span>()</span></code></pre></div>
<pre><code>## $Y
##  [1] 0.54 0.48 0.33 0.43 1.00 1.00 0.91 1.00 0.21 0.85
## 
## $tau
## [1] 1</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" tabindex="-1"></a><span class="co"># Step 2: Estimate lambda using EM algorithm</span></span>
<span id="cb198-2"><a href="#cb198-2" tabindex="-1"></a><span class="fu">estimate_lambda_em</span>()</span></code></pre></div>
<pre><code>## $lambda
## [1] 0.9808556
## 
## $iter
## [1] 13
## 
## $diff
## [1] 4.44839e-07</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" tabindex="-1"></a><span class="co"># Step 3: Report and visualize results</span></span>
<span id="cb200-2"><a href="#cb200-2" tabindex="-1"></a><span class="fu">report_results</span>()</span></code></pre></div>
<pre><code>## EM Algorithm Estimation of lambda:
##  - Lambda Estimate (EM): 0.9808556 
##  - Iterations: 13 
##  - Final Convergence Difference: 4.44839e-07 
## 
## Observed Data MLE of lambda (using uncensored values only): 0.5357143</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## $lambda_em
## [1] 0.9808556
## 
## $lambda_mle
## [1] 0.5357143</code></pre>
</div>
</div>
</div>
<div id="hw-8-th" class="section level1">
<h1>HW 8-th</h1>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb203-2"><a href="#cb203-2" tabindex="-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb203-3"><a href="#cb203-3" tabindex="-1"></a><span class="fu">library</span>(bench)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;bench&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     press</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" tabindex="-1"></a><span class="fu">library</span>(fastmatch)</span></code></pre></div>
<div id="question-1-11.7" class="section level2">
<h2>Question 1 (11.7)</h2>
<p>Use the simplex algorithm to solve the following problem. Minimize
<span class="math inline">\(4x + 2y + 9z\)</span> subject to</p>
<p><span class="math display">\[
2x + y + z ≤ 2\\
x − y + 3z ≤ 3\\
x ≥ 0, y ≥ 0, z ≥ 0.
\]</span></p>
</div>
<div id="answer-1-11.7" class="section level2">
<h2>Answer 1 (11.7)</h2>
<div id="step-1-data-generation-4" class="section level3">
<h3>Step 1: Data Generation</h3>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb207-2"><a href="#cb207-2" tabindex="-1"></a>  objective_coeffs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb207-3"><a href="#cb207-3" tabindex="-1"></a>  </span>
<span id="cb207-4"><a href="#cb207-4" tabindex="-1"></a>  constraint_matrix <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb207-5"><a href="#cb207-5" tabindex="-1"></a>  </span>
<span id="cb207-6"><a href="#cb207-6" tabindex="-1"></a>  rhs_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb207-7"><a href="#cb207-7" tabindex="-1"></a>  </span>
<span id="cb207-8"><a href="#cb207-8" tabindex="-1"></a>  <span class="co"># Return list containing problem data</span></span>
<span id="cb207-9"><a href="#cb207-9" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">objective =</span> objective_coeffs, <span class="at">A =</span> constraint_matrix, <span class="at">b =</span> rhs_values)</span>
<span id="cb207-10"><a href="#cb207-10" tabindex="-1"></a>}</span>
<span id="cb207-11"><a href="#cb207-11" tabindex="-1"></a></span>
<span id="cb207-12"><a href="#cb207-12" tabindex="-1"></a>problem_data <span class="ot">&lt;-</span> <span class="fu">generate_data</span>()</span>
<span id="cb207-13"><a href="#cb207-13" tabindex="-1"></a><span class="fu">save</span>(problem_data, <span class="at">file =</span> <span class="st">&quot;problem_data.RData&quot;</span>)</span></code></pre></div>
</div>
<div id="step-2-statistical-inference-4" class="section level3">
<h3>Step 2: Statistical Inference</h3>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" tabindex="-1"></a>apply_simplex <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb208-2"><a href="#cb208-2" tabindex="-1"></a>  <span class="fu">load</span>(<span class="st">&quot;problem_data.RData&quot;</span>)</span>
<span id="cb208-3"><a href="#cb208-3" tabindex="-1"></a>  </span>
<span id="cb208-4"><a href="#cb208-4" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> problem_data<span class="sc">$</span>objective, <span class="at">A1 =</span> problem_data<span class="sc">$</span>A, <span class="at">b1 =</span> problem_data<span class="sc">$</span>b, <span class="at">maxi =</span> <span class="cn">TRUE</span>)</span>
<span id="cb208-5"><a href="#cb208-5" tabindex="-1"></a>  </span>
<span id="cb208-6"><a href="#cb208-6" tabindex="-1"></a>  <span class="fu">save</span>(solution, <span class="at">file =</span> <span class="st">&quot;solution.RData&quot;</span>)</span>
<span id="cb208-7"><a href="#cb208-7" tabindex="-1"></a>  solution</span>
<span id="cb208-8"><a href="#cb208-8" tabindex="-1"></a>}</span>
<span id="cb208-9"><a href="#cb208-9" tabindex="-1"></a></span>
<span id="cb208-10"><a href="#cb208-10" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">apply_simplex</span>()</span></code></pre></div>
</div>
<div id="step-3-result-reporting-4" class="section level3">
<h3>Step 3: Result Reporting</h3>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" tabindex="-1"></a>report_results <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb209-2"><a href="#cb209-2" tabindex="-1"></a>  <span class="fu">load</span>(<span class="st">&quot;solution.RData&quot;</span>)</span>
<span id="cb209-3"><a href="#cb209-3" tabindex="-1"></a>  </span>
<span id="cb209-4"><a href="#cb209-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Optimal values of decision variables:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb209-5"><a href="#cb209-5" tabindex="-1"></a>  <span class="fu">print</span>(solution<span class="sc">$</span>soln) <span class="co"># Decision variables x, y, z</span></span>
<span id="cb209-6"><a href="#cb209-6" tabindex="-1"></a>  </span>
<span id="cb209-7"><a href="#cb209-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Minimum value of the objective function:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb209-8"><a href="#cb209-8" tabindex="-1"></a>  <span class="fu">print</span>(solution<span class="sc">$</span>value)</span>
<span id="cb209-9"><a href="#cb209-9" tabindex="-1"></a>}</span>
<span id="cb209-10"><a href="#cb209-10" tabindex="-1"></a></span>
<span id="cb209-11"><a href="#cb209-11" tabindex="-1"></a><span class="co"># Run the result reporting function to display the output</span></span>
<span id="cb209-12"><a href="#cb209-12" tabindex="-1"></a><span class="fu">report_results</span>()</span></code></pre></div>
<pre><code>## Optimal values of decision variables:
##   x1   x2   x3 
## 0.00 0.75 1.25 
## 
## Minimum value of the objective function:
##     b 
## 12.75</code></pre>
</div>
</div>
<div id="question-2-p.204-ex.3" class="section level2">
<h2>Question 2 (P.204 Ex.3)</h2>
<p>Use both for loops and <code>lapply()</code> to fit linear models to
the mtcars using the formulas stored in this list:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">eval=</span><span class="cn">FALSE</span>, <span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb211-2"><a href="#cb211-2" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb211-3"><a href="#cb211-3" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb211-4"><a href="#cb211-4" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb211-5"><a href="#cb211-5" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb211-6"><a href="#cb211-6" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb211-7"><a href="#cb211-7" tabindex="-1"></a>)</span></code></pre></div>
<div id="answer-2-p.204-ex.3" class="section level3">
<h3>Answer 2 (P.204 Ex.3)</h3>
<p>We will use <code>lapply()</code> in two different ways: -
<strong>Version 1</strong>: Directly applying <code>lm()</code> to each
formula. - <strong>Version 2</strong>: Using an anonymous function to
pass each formula to <code>lm()</code>.</p>
<p>Both approaches will return a list of <code>lm</code> objects
containing the fitted models.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" tabindex="-1"></a><span class="co"># Version 1: Directly pass the formula list to lapply with lm()</span></span>
<span id="cb212-2"><a href="#cb212-2" tabindex="-1"></a>models_lapply_v1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, lm, <span class="at">data =</span> mtcars)</span>
<span id="cb212-3"><a href="#cb212-3" tabindex="-1"></a></span>
<span id="cb212-4"><a href="#cb212-4" tabindex="-1"></a><span class="co"># Version 2: Use an anonymous function to explicitly pass each formula to lm()</span></span>
<span id="cb212-5"><a href="#cb212-5" tabindex="-1"></a>models_lapply_v2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(formula) <span class="fu">lm</span>(<span class="at">formula =</span> formula, <span class="at">data =</span> mtcars))</span></code></pre></div>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" tabindex="-1"></a><span class="co"># Pre-allocate a list to store results from the for loop</span></span>
<span id="cb213-2"><a href="#cb213-2" tabindex="-1"></a>models_for_loop1 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(formulas))</span>
<span id="cb213-3"><a href="#cb213-3" tabindex="-1"></a></span>
<span id="cb213-4"><a href="#cb213-4" tabindex="-1"></a><span class="co"># Loop through each formula and fit the model</span></span>
<span id="cb213-5"><a href="#cb213-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)) {</span>
<span id="cb213-6"><a href="#cb213-6" tabindex="-1"></a>  models_for_loop1[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb213-7"><a href="#cb213-7" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="output" class="section level3">
<h3>Output</h3>
<p>We can examine the structure of each fitted model to confirm that
they contain the same essential information.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" tabindex="-1"></a><span class="co"># Display the first model from each approach to compare</span></span>
<span id="cb214-2"><a href="#cb214-2" tabindex="-1"></a><span class="fu">str</span>(models_lapply_v1[[<span class="dv">1</span>]])   <span class="co"># From lapply() version 1</span></span>
<span id="cb214-3"><a href="#cb214-3" tabindex="-1"></a><span class="fu">str</span>(models_lapply_v2[[<span class="dv">1</span>]])   <span class="co"># From lapply() version 2</span></span>
<span id="cb214-4"><a href="#cb214-4" tabindex="-1"></a><span class="fu">str</span>(models_for_loop1[[<span class="dv">1</span>]])    <span class="co"># From for loop</span></span></code></pre></div>
</div>
</div>
<div id="question-3-p.204-ex.4" class="section level2">
<h2>Question 3 (P.204 Ex.4)</h2>
<p>Fit the model <code>mpg ~ disp</code> to each of the bootstrap
replicates of mtcars in the list below by using a for loop and
<code>lapply()</code>. Can you do it without an anonymous function?</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">eval=</span><span class="cn">FALSE</span>, <span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb215-2"><a href="#cb215-2" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb215-3"><a href="#cb215-3" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb215-4"><a href="#cb215-4" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb215-5"><a href="#cb215-5" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div id="answer-3-p.204-ex.4" class="section level2">
<h2>Answer 3 (P.204 Ex.4)</h2>
<div id="generating-bootstrap-samples" class="section level3">
<h3>Generating Bootstrap Samples</h3>
<p>We first generate 10 bootstrap samples of the <code>mtcars</code>
dataset. Each bootstrap replicate is created by sampling rows with
replacement, simulating different variations of the original
dataset.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" tabindex="-1"></a><span class="co"># Generate 10 bootstrap samples of the mtcars dataset</span></span>
<span id="cb216-2"><a href="#cb216-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># Set seed for reproducibility</span></span>
<span id="cb216-3"><a href="#cb216-3" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb216-4"><a href="#cb216-4" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="co"># Sample with replacement</span></span>
<span id="cb216-5"><a href="#cb216-5" tabindex="-1"></a>  mtcars[rows, ] <span class="co"># Return the bootstrap sample</span></span>
<span id="cb216-6"><a href="#cb216-6" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div id="approach-1-using-lapply-without-an-anonymous-function" class="section level3">
<h3>Approach 1: Using <code>lapply()</code> Without an Anonymous
Function</h3>
<p>In this approach, we apply the <code>lm()</code> function directly to
each bootstrap sample in <code>bootstraps</code>. Here, we specify the
<code>formula</code> argument in <code>lapply()</code> rather than using
an anonymous function.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" tabindex="-1"></a>models_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, lm, <span class="at">formula =</span> mpg <span class="sc">~</span> disp)</span></code></pre></div>
</div>
<div id="approach-2-using-a-for-loop" class="section level3">
<h3>Approach 2: Using a <code>for</code> Loop</h3>
<p>In this approach, we use a <code>for</code> loop to iterate through
each bootstrap sample in <code>bootstraps</code> and fit the model
<code>mpg ~ disp</code>.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" tabindex="-1"></a>models_for_loop <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(bootstraps))</span>
<span id="cb218-2"><a href="#cb218-2" tabindex="-1"></a></span>
<span id="cb218-3"><a href="#cb218-3" tabindex="-1"></a><span class="co"># Loop through each bootstrap sample and fit the model</span></span>
<span id="cb218-4"><a href="#cb218-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)) {</span>
<span id="cb218-5"><a href="#cb218-5" tabindex="-1"></a>  models_for_loop[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> bootstraps[[i]])</span>
<span id="cb218-6"><a href="#cb218-6" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="output-1" class="section level3">
<h3>Output</h3>
<p>To examine the structure of one of the fitted models, we can use the
<code>str()</code> function. This allows us to confirm that each element
in the lists <code>models_lapply</code> and <code>models_for_loop</code>
contains a fitted <code>lm</code> model.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" tabindex="-1"></a><span class="co"># Display the structure of the first fitted model from each approach</span></span>
<span id="cb219-2"><a href="#cb219-2" tabindex="-1"></a><span class="fu">str</span>(models_lapply[[<span class="dv">1</span>]])   <span class="co"># Model from lapply() approach</span></span>
<span id="cb219-3"><a href="#cb219-3" tabindex="-1"></a><span class="fu">str</span>(models_for_loop[[<span class="dv">1</span>]]) <span class="co"># Model from for loop approach</span></span></code></pre></div>
</div>
</div>
<div id="question-4-p.204-ex.5" class="section level2">
<h2>Question 4 (P.204 Ex.5)</h2>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">eval=</span><span class="cn">FALSE</span>, <span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb220-2"><a href="#cb220-2" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
</div>
<div id="answer-4-p.204-ex.5" class="section level2">
<h2>Answer 4 (P.204 Ex.5)</h2>
<div id="defining-the-r2-extraction-function" class="section level3">
<h3>Defining the <span class="math inline">\(R^2\)</span> Extraction
Function</h3>
<p>We define a custom function <code>rsq</code> that takes a fitted
model as input and returns its <span class="math inline">\(R^2\)</span>
value.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" tabindex="-1"></a><span class="co"># Define a function to extract R-squared from a model</span></span>
<span id="cb221-2"><a href="#cb221-2" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
</div>
<div id="models-from-previous-exercises" class="section level3">
<h3>Models from Previous Exercises</h3>
<p>For reference, we previously created two sets of models: 1. Models in
<strong>Ex.3</strong>, where we fit various linear models to the
<code>mtcars</code> dataset using a <code>for</code> loop and
<code>lapply()</code>. 2. Models in <strong>Ex.4</strong>, where we fit
the <code>mpg ~ disp</code> model to multiple bootstrap samples of
<code>mtcars</code>.</p>
<p>In both cases, the models are stored in lists: <code>la1</code>,
<code>la2</code>, and <code>lf1</code> for Ex.3; <code>la</code> and
<code>lf</code> for Ex.4.</p>
</div>
<div id="extracting-r2-values-for-ex.3-models" class="section level3">
<h3>Extracting <span class="math inline">\(R^2\)</span> Values for Ex.3
Models</h3>
<p>We use <code>sapply()</code> to apply the <code>rsq</code> function
to each list of models created in Exercise 3. This provides a convenient
way to extract and display the <span class="math inline">\(R^2\)</span>
values.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" tabindex="-1"></a><span class="co"># Extract R-squared values from each set of models in Exercise 3</span></span>
<span id="cb222-2"><a href="#cb222-2" tabindex="-1"></a>r_squared_la1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models_lapply_v1, rsq) <span class="co"># R-squared for models in la1</span></span>
<span id="cb222-3"><a href="#cb222-3" tabindex="-1"></a>r_squared_la2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models_lapply_v2, rsq) <span class="co"># R-squared for models in la2</span></span>
<span id="cb222-4"><a href="#cb222-4" tabindex="-1"></a>r_squared_lf1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models_for_loop1, rsq) <span class="co"># R-squared for models in lf1</span></span>
<span id="cb222-5"><a href="#cb222-5" tabindex="-1"></a></span>
<span id="cb222-6"><a href="#cb222-6" tabindex="-1"></a><span class="co"># Display the R-squared values</span></span>
<span id="cb222-7"><a href="#cb222-7" tabindex="-1"></a>r_squared_la1</span>
<span id="cb222-8"><a href="#cb222-8" tabindex="-1"></a>r_squared_la2</span>
<span id="cb222-9"><a href="#cb222-9" tabindex="-1"></a>r_squared_lf1</span></code></pre></div>
</div>
<div id="extracting-r2-values-for-ex.4-models" class="section level3">
<h3>Extracting <span class="math inline">\(R^2\)</span> Values for Ex.4
Models</h3>
<p>Similarly, we use <code>sapply()</code> to extract <span class="math inline">\(R^2\)</span> values from the models fitted to
bootstrap samples in Exercise 4.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" tabindex="-1"></a><span class="co"># Extract R-squared values from each set of models in Exercise 4</span></span>
<span id="cb223-2"><a href="#cb223-2" tabindex="-1"></a>r_squared_la <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models_lapply, rsq) <span class="co"># R-squared for models in la</span></span>
<span id="cb223-3"><a href="#cb223-3" tabindex="-1"></a>r_squared_lf <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models_for_loop, rsq) <span class="co"># R-squared for models in lf</span></span>
<span id="cb223-4"><a href="#cb223-4" tabindex="-1"></a></span>
<span id="cb223-5"><a href="#cb223-5" tabindex="-1"></a><span class="co"># Display the R-squared values</span></span>
<span id="cb223-6"><a href="#cb223-6" tabindex="-1"></a>r_squared_la</span>
<span id="cb223-7"><a href="#cb223-7" tabindex="-1"></a>r_squared_lf</span></code></pre></div>
</div>
</div>
<div id="question-5-p.213-ex.3" class="section level2">
<h2>Question 5 (P.213 Ex.3)</h2>
<p>The following code simulates the performance of a t-test for
non-normal data. Use sapply() and an anonymous function to extract the
p-value from every trial.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">eval=</span><span class="cn">FALSE</span>, <span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb224-2"><a href="#cb224-2" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb224-3"><a href="#cb224-3" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb224-4"><a href="#cb224-4" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb224-5"><a href="#cb224-5" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb224-6"><a href="#cb224-6" tabindex="-1"></a>)</span></code></pre></div>
<p>Extra challenge: get rid of the anonymous function by using
<code>[[</code> directly.</p>
</div>
<div id="answer-5-p.213-ex.3" class="section level2">
<h2>Answer 5 (P.213 Ex.3)</h2>
<div id="simulating-non-normal-data-with-t-tests" class="section level3">
<h3>Simulating Non-normal Data with t-tests</h3>
<p>We simulate 100 trials of independent two-sample t-tests on data
generated from a Poisson distribution, which is non-normal. Each trial
consists of:</p>
<ul>
<li><p>One sample of size 10 generated from a Poisson distribution with
a mean of 10.</p></li>
<li><p>A second sample of size 7, also from a Poisson distribution with
a mean of 10.</p></li>
</ul>
<p>The <code>t.test()</code> function is used to compare the means of
the two samples in each trial, and each result is stored as an element
in a list.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb225-2"><a href="#cb225-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb225-3"><a href="#cb225-3" tabindex="-1"></a></span>
<span id="cb225-4"><a href="#cb225-4" tabindex="-1"></a><span class="co"># Generate 100 trials of t-tests on non-normal data</span></span>
<span id="cb225-5"><a href="#cb225-5" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb225-6"><a href="#cb225-6" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb225-7"><a href="#cb225-7" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb225-8"><a href="#cb225-8" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb225-9"><a href="#cb225-9" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="extracting-p-values-using-sapply-with-an-anonymous-function" class="section level3">
<h3>Extracting <span class="math inline">\(p\)</span>-values Using
<code>sapply()</code> with an Anonymous Function</h3>
<p>We use <code>sapply()</code> to apply an anonymous function that
extracts the <code>p.value</code> element from each <code>t.test</code>
result stored in <code>trials</code>.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" tabindex="-1"></a><span class="co"># Extracting p-values using an anonymous function</span></span>
<span id="cb226-2"><a href="#cb226-2" tabindex="-1"></a>p_values_anon <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="cf">function</span>(x) x[[<span class="st">&quot;p.value&quot;</span>]])</span>
<span id="cb226-3"><a href="#cb226-3" tabindex="-1"></a></span>
<span id="cb226-4"><a href="#cb226-4" tabindex="-1"></a><span class="co"># Display the first few p-values</span></span>
<span id="cb226-5"><a href="#cb226-5" tabindex="-1"></a><span class="fu">head</span>(p_values_anon)</span></code></pre></div>
</div>
<div id="extracting-p-values-using-sapply-without-an-anonymous-function" class="section level3">
<h3>Extracting <span class="math inline">\(p\)</span>-values Using
<code>sapply()</code> Without an Anonymous Function</h3>
<p>An alternative approach to achieve the same result is to use
<code>[[</code> directly in <code>sapply()</code>. Here,
<code>&quot;p.value&quot;</code> is specified as an argument to <code>[[</code>,
eliminating the need for an anonymous function.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" tabindex="-1"></a><span class="co"># Extracting p-values without an anonymous function</span></span>
<span id="cb227-2"><a href="#cb227-2" tabindex="-1"></a>p_values_direct <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;p.value&quot;</span>)</span>
<span id="cb227-3"><a href="#cb227-3" tabindex="-1"></a></span>
<span id="cb227-4"><a href="#cb227-4" tabindex="-1"></a><span class="co"># Display the first few p-values</span></span>
<span id="cb227-5"><a href="#cb227-5" tabindex="-1"></a><span class="fu">head</span>(p_values_direct)</span></code></pre></div>
</div>
<div id="comparison-of-results" class="section level3">
<h3>Comparison of Results</h3>
<p>Both approaches produce identical results: a vector of <span class="math inline">\(p\)</span>-values from each trial. Below, we
compare the first few elements to confirm they are the same.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" tabindex="-1"></a><span class="co"># Compare the two p-value vectors to confirm they are identical</span></span>
<span id="cb228-2"><a href="#cb228-2" tabindex="-1"></a><span class="fu">identical</span>(p_values_anon, p_values_direct)</span></code></pre></div>
</div>
</div>
<div id="question-6-p.214-ex.6" class="section level2">
<h2>Question 6 (P.214 Ex.6)</h2>
<p>Implement a combination of <code>Map()</code> and
<code>vapply()</code> to create an <code>lapply()</code> variant that
iterates in parallel over all of its inputs and stores its outputs in a
vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-6-p.214-ex.6" class="section level2">
<h2>Answer 6 (P.214 Ex.6)</h2>
<p>To illustrate the functionality, we will create a sample list of data
frames. Our goal is to apply the <code>mean</code> function to each
column within each data frame.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" tabindex="-1"></a><span class="co"># Sample list of data frames</span></span>
<span id="cb229-2"><a href="#cb229-2" tabindex="-1"></a>testlist <span class="ot">&lt;-</span> <span class="fu">list</span>(iris, mtcars, cars)</span>
<span id="cb229-3"><a href="#cb229-3" tabindex="-1"></a></span>
<span id="cb229-4"><a href="#cb229-4" tabindex="-1"></a><span class="co"># Inspect the structure of the test list</span></span>
<span id="cb229-5"><a href="#cb229-5" tabindex="-1"></a><span class="fu">str</span>(testlist)</span></code></pre></div>
<div id="implementing-lmapply" class="section level3">
<h3>Implementing <code>lmapply()</code></h3>
<p>The <code>lmapply()</code> function will: 1. Take each element of the
list <code>X</code> (each element could be a data frame or a similar
structure). 2. Use <code>vapply()</code> to apply a function
<code>FUN</code> to each column of the data frame. 3. Optionally, if
<code>simplify = TRUE</code>, convert the results into a more compact
format, such as a matrix, for easier analysis.</p>
<div id="function-arguments" class="section level4">
<h4>Function Arguments</h4>
<p>The <code>lmapply()</code> function includes the following arguments:
- <code>X</code>: A list of objects (e.g., data frames) on which the
function will operate. - <code>FUN</code>: The function to apply to each
column (or element) within each object in <code>X</code>. -
<code>FUN.VALUE</code>: A template specifying the expected type of
output from <code>FUN</code>. - <code>simplify</code>: A logical
argument (default <code>FALSE</code>) that, when <code>TRUE</code>,
simplifies the result into a matrix if possible.</p>
</div>
<div id="function-code" class="section level4">
<h4>Function Code</h4>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" tabindex="-1"></a><span class="co"># Define the custom function using Map() and vapply()</span></span>
<span id="cb230-2"><a href="#cb230-2" tabindex="-1"></a>lmapply <span class="ot">&lt;-</span> <span class="cf">function</span>(X, FUN, FUN.VALUE, <span class="at">simplify =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb230-3"><a href="#cb230-3" tabindex="-1"></a>  <span class="co"># Use Map() to iterate over each element in X, applying vapply() to each</span></span>
<span id="cb230-4"><a href="#cb230-4" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">Map</span>(<span class="cf">function</span>(x) <span class="fu">vapply</span>(x, FUN, FUN.VALUE), X)</span>
<span id="cb230-5"><a href="#cb230-5" tabindex="-1"></a>  </span>
<span id="cb230-6"><a href="#cb230-6" tabindex="-1"></a>  <span class="co"># If simplify = TRUE, attempt to convert to a matrix or array format</span></span>
<span id="cb230-7"><a href="#cb230-7" tabindex="-1"></a>  <span class="cf">if</span> (simplify <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb230-8"><a href="#cb230-8" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">simplify2array</span>(out))</span>
<span id="cb230-9"><a href="#cb230-9" tabindex="-1"></a>  }</span>
<span id="cb230-10"><a href="#cb230-10" tabindex="-1"></a>  </span>
<span id="cb230-11"><a href="#cb230-11" tabindex="-1"></a>  <span class="co"># Return the result as a list if not simplified</span></span>
<span id="cb230-12"><a href="#cb230-12" tabindex="-1"></a>  out</span>
<span id="cb230-13"><a href="#cb230-13" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="example-usage-of-lmapply" class="section level3">
<h3>Example Usage of <code>lmapply()</code></h3>
<p>We now use <code>lmapply()</code> on <code>testlist</code>, applying
the <code>mean</code> function to each column of each data frame in the
list. Since <code>mean</code> returns a single numeric value,
<code>FUN.VALUE</code> is set to <code>numeric(1)</code>.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" tabindex="-1"></a><span class="co"># Apply the lmapply function to compute column means for each data frame</span></span>
<span id="cb231-2"><a href="#cb231-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lmapply</span>(testlist, mean, <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb231-3"><a href="#cb231-3" tabindex="-1"></a></span>
<span id="cb231-4"><a href="#cb231-4" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb231-5"><a href="#cb231-5" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<div id="simplifying-the-output" class="section level4">
<h4>Simplifying the Output</h4>
<p>To demonstrate the <code>simplify = TRUE</code> argument, we will
re-run <code>lmapply()</code> with <code>simplify</code> enabled. This
will attempt to convert the list of results into a matrix for easier
interpretation.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" tabindex="-1"></a><span class="co"># Apply lmapply with simplify = TRUE</span></span>
<span id="cb232-2"><a href="#cb232-2" tabindex="-1"></a>result_simplified <span class="ot">&lt;-</span> <span class="fu">lmapply</span>(testlist, mean, <span class="fu">numeric</span>(<span class="dv">1</span>), <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb232-3"><a href="#cb232-3" tabindex="-1"></a></span>
<span id="cb232-4"><a href="#cb232-4" tabindex="-1"></a><span class="co"># Display the simplified result</span></span>
<span id="cb232-5"><a href="#cb232-5" tabindex="-1"></a><span class="fu">print</span>(result_simplified)</span></code></pre></div>
</div>
</div>
</div>
<div id="question-7-p.365-ex.4" class="section level2">
<h2>Question 7 (P.365 Ex.4)</h2>
<p>Make a faster version of <code>chisq.test()</code> that only computes
the chi-square test statistic when the input is two numeric vectors with
no missing values. You can try simplifying <code>chisq.test()</code> or
by coding from the mathematical definition (<a href="http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test" class="uri">http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test</a>).</p>
</div>
<div id="answer-7-p.365-ex.4" class="section level2">
<h2>Answer 7 (P.365 Ex.4)</h2>
<div id="mathematical-background" class="section level3">
<h3>Mathematical Background</h3>
<p>The Pearson chi-squared test statistic for two categorical variables
is calculated as follows:</p>
<p><span class="math display">\[
\chi^2 = \sum \frac{(O - E)^2}{E}
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(O\)</span> represents the observed
frequencies.</p></li>
<li><p><span class="math inline">\(E\)</span> represents the expected
frequencies, calculated based on the row and column margins.</p></li>
</ul>
<div id="steps-for-optimized-calculation" class="section level4">
<h4>Steps for Optimized Calculation</h4>
<ol style="list-style-type: decimal">
<li><p>Combine the input vectors into a matrix of observed
frequencies.</p></li>
<li><p>Calculate row and column sums to determine marginal
totals.</p></li>
<li><p>Compute expected frequencies.</p></li>
<li><p>Calculate the chi-squared test statistic.</p></li>
<li><p>Compute the p-value using the chi-squared distribution with the
appropriate degrees of freedom.</p></li>
</ol>
</div>
</div>
<div id="implementing-chisq.test2" class="section level3">
<h3>Implementing <code>chisq.test2()</code></h3>
<p>The following function, <code>chisq.test2()</code>, implements these
steps:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" tabindex="-1"></a>chisq.test2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb233-2"><a href="#cb233-2" tabindex="-1"></a>  <span class="co"># Combine x and y into a matrix of observed frequencies</span></span>
<span id="cb233-3"><a href="#cb233-3" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x, y)</span>
<span id="cb233-4"><a href="#cb233-4" tabindex="-1"></a>  </span>
<span id="cb233-5"><a href="#cb233-5" tabindex="-1"></a>  <span class="co"># Calculate row and column sums (margins)</span></span>
<span id="cb233-6"><a href="#cb233-6" tabindex="-1"></a>  margin1 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(m)</span>
<span id="cb233-7"><a href="#cb233-7" tabindex="-1"></a>  margin2 <span class="ot">&lt;-</span> <span class="fu">colSums</span>(m)</span>
<span id="cb233-8"><a href="#cb233-8" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sum</span>(m)</span>
<span id="cb233-9"><a href="#cb233-9" tabindex="-1"></a>  </span>
<span id="cb233-10"><a href="#cb233-10" tabindex="-1"></a>  <span class="co"># Compute expected frequencies matrix using outer product of margins</span></span>
<span id="cb233-11"><a href="#cb233-11" tabindex="-1"></a>  me <span class="ot">&lt;-</span> <span class="fu">tcrossprod</span>(margin1, margin2) <span class="sc">/</span> n</span>
<span id="cb233-12"><a href="#cb233-12" tabindex="-1"></a>  </span>
<span id="cb233-13"><a href="#cb233-13" tabindex="-1"></a>  <span class="co"># Calculate chi-squared statistic</span></span>
<span id="cb233-14"><a href="#cb233-14" tabindex="-1"></a>  x_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((m <span class="sc">-</span> me)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> me)</span>
<span id="cb233-15"><a href="#cb233-15" tabindex="-1"></a>  </span>
<span id="cb233-16"><a href="#cb233-16" tabindex="-1"></a>  <span class="co"># Calculate degrees of freedom</span></span>
<span id="cb233-17"><a href="#cb233-17" tabindex="-1"></a>  df <span class="ot">&lt;-</span> (<span class="fu">length</span>(margin1) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">length</span>(margin2) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb233-18"><a href="#cb233-18" tabindex="-1"></a>  </span>
<span id="cb233-19"><a href="#cb233-19" tabindex="-1"></a>  <span class="co"># Compute p-value</span></span>
<span id="cb233-20"><a href="#cb233-20" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(x_stat, <span class="at">df =</span> df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb233-21"><a href="#cb233-21" tabindex="-1"></a>  </span>
<span id="cb233-22"><a href="#cb233-22" tabindex="-1"></a>  <span class="co"># Return results as a list</span></span>
<span id="cb233-23"><a href="#cb233-23" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">x_stat =</span> x_stat, <span class="at">df =</span> df, <span class="at">p.value =</span> p.value)</span>
<span id="cb233-24"><a href="#cb233-24" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="verification-of-results" class="section level3">
<h3>Verification of Results</h3>
<p>To verify the accuracy of <code>chisq.test2()</code>, we will compare
its results with those from <code>chisq.test()</code>.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb234-2"><a href="#cb234-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">21</span><span class="sc">:</span><span class="dv">25</span></span>
<span id="cb234-3"><a href="#cb234-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">21</span>, <span class="dv">29</span>, <span class="dv">2</span>)</span>
<span id="cb234-4"><a href="#cb234-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">cbind</span>(a, b)</span>
<span id="cb234-5"><a href="#cb234-5" tabindex="-1"></a></span>
<span id="cb234-6"><a href="#cb234-6" tabindex="-1"></a><span class="co"># Results from base chisq.test()</span></span>
<span id="cb234-7"><a href="#cb234-7" tabindex="-1"></a>base_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(m)</span>
<span id="cb234-8"><a href="#cb234-8" tabindex="-1"></a></span>
<span id="cb234-9"><a href="#cb234-9" tabindex="-1"></a><span class="co"># Results from optimized chisq.test2()</span></span>
<span id="cb234-10"><a href="#cb234-10" tabindex="-1"></a>opt_result <span class="ot">&lt;-</span> <span class="fu">chisq.test2</span>(a, b)</span>
<span id="cb234-11"><a href="#cb234-11" tabindex="-1"></a></span>
<span id="cb234-12"><a href="#cb234-12" tabindex="-1"></a><span class="co"># Print results for comparison</span></span>
<span id="cb234-13"><a href="#cb234-13" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Base chisq.test() result:&quot;</span>)</span>
<span id="cb234-14"><a href="#cb234-14" tabindex="-1"></a><span class="fu">print</span>(base_result)</span>
<span id="cb234-15"><a href="#cb234-15" tabindex="-1"></a></span>
<span id="cb234-16"><a href="#cb234-16" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Optimized chisq.test2() result:&quot;</span>)</span>
<span id="cb234-17"><a href="#cb234-17" tabindex="-1"></a><span class="fu">print</span>(opt_result)</span></code></pre></div>
</div>
<div id="benchmarking-performance" class="section level3">
<h3>Benchmarking Performance</h3>
<p>To measure the performance gains, we will benchmark
<code>chisq.test()</code> and <code>chisq.test2()</code> using the
<code>bench</code> package.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" tabindex="-1"></a><span class="co"># Benchmark comparison</span></span>
<span id="cb235-2"><a href="#cb235-2" tabindex="-1"></a>bench<span class="sc">::</span><span class="fu">mark</span>(</span>
<span id="cb235-3"><a href="#cb235-3" tabindex="-1"></a>  <span class="at">base =</span> <span class="fu">chisq.test</span>(m),</span>
<span id="cb235-4"><a href="#cb235-4" tabindex="-1"></a>  <span class="at">optimized =</span> <span class="fu">chisq.test2</span>(a, b),</span>
<span id="cb235-5"><a href="#cb235-5" tabindex="-1"></a>  <span class="at">check =</span> <span class="cn">FALSE</span></span>
<span id="cb235-6"><a href="#cb235-6" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="question-8-p.365-ex.5" class="section level2">
<h2>Question 8 (P.365 Ex.5)</h2>
<p>Can you make a faster version of <code>table()</code> for the case of
an input of two integer vectors with no missing values? Can you use it
to speed up your chi-square test?</p>
</div>
<div id="answer-8-p.365-ex.5" class="section level2">
<h2>Answer 8 (P.365 Ex.5)</h2>
<div id="implementing-table2" class="section level3">
<h3>Implementing <code>table2()</code></h3>
<p>The <code>table2()</code> function below executes these steps,
creating an optimized two-way table for integer vectors.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b) {</span>
<span id="cb236-2"><a href="#cb236-2" tabindex="-1"></a>  </span>
<span id="cb236-3"><a href="#cb236-3" tabindex="-1"></a>  <span class="co"># Obtain sorted unique values of each vector</span></span>
<span id="cb236-4"><a href="#cb236-4" tabindex="-1"></a>  a_s <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(a))</span>
<span id="cb236-5"><a href="#cb236-5" tabindex="-1"></a>  b_s <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(b))</span>
<span id="cb236-6"><a href="#cb236-6" tabindex="-1"></a>  </span>
<span id="cb236-7"><a href="#cb236-7" tabindex="-1"></a>  <span class="co"># Calculate dimensions for output table</span></span>
<span id="cb236-8"><a href="#cb236-8" tabindex="-1"></a>  a_l <span class="ot">&lt;-</span> <span class="fu">length</span>(a_s)</span>
<span id="cb236-9"><a href="#cb236-9" tabindex="-1"></a>  b_l <span class="ot">&lt;-</span> <span class="fu">length</span>(b_s)</span>
<span id="cb236-10"><a href="#cb236-10" tabindex="-1"></a>  dims <span class="ot">&lt;-</span> <span class="fu">c</span>(a_l, b_l)</span>
<span id="cb236-11"><a href="#cb236-11" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> a_l <span class="sc">*</span> b_l</span>
<span id="cb236-12"><a href="#cb236-12" tabindex="-1"></a>  dn <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> a_s, <span class="at">b =</span> b_s)</span>
<span id="cb236-13"><a href="#cb236-13" tabindex="-1"></a>  </span>
<span id="cb236-14"><a href="#cb236-14" tabindex="-1"></a>  <span class="co"># Use fastmatch::fmatch() to quickly map values</span></span>
<span id="cb236-15"><a href="#cb236-15" tabindex="-1"></a>  bin <span class="ot">&lt;-</span> fastmatch<span class="sc">::</span><span class="fu">fmatch</span>(a, a_s) <span class="sc">+</span> a_l <span class="sc">*</span> fastmatch<span class="sc">::</span><span class="fu">fmatch</span>(b, b_s) <span class="sc">-</span> a_l</span>
<span id="cb236-16"><a href="#cb236-16" tabindex="-1"></a>  </span>
<span id="cb236-17"><a href="#cb236-17" tabindex="-1"></a>  <span class="co"># Use tabulate() to count occurrences</span></span>
<span id="cb236-18"><a href="#cb236-18" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">tabulate</span>(bin, pr)</span>
<span id="cb236-19"><a href="#cb236-19" tabindex="-1"></a>  </span>
<span id="cb236-20"><a href="#cb236-20" tabindex="-1"></a>  <span class="co"># Reshape into array format and assign dimension names</span></span>
<span id="cb236-21"><a href="#cb236-21" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">array</span>(y, <span class="at">dim =</span> dims, <span class="at">dimnames =</span> dn)</span>
<span id="cb236-22"><a href="#cb236-22" tabindex="-1"></a>  <span class="fu">class</span>(y) <span class="ot">&lt;-</span> <span class="st">&quot;table&quot;</span></span>
<span id="cb236-23"><a href="#cb236-23" tabindex="-1"></a>  </span>
<span id="cb236-24"><a href="#cb236-24" tabindex="-1"></a>  y</span>
<span id="cb236-25"><a href="#cb236-25" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="verification" class="section level3">
<h3>Verification</h3>
<p>To confirm <code>table2()</code> produces the same results as
<code>table()</code>, we can compare the output for a sample input.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" tabindex="-1"></a><span class="co"># Sample input data</span></span>
<span id="cb237-2"><a href="#cb237-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">50</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb237-3"><a href="#cb237-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">50</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb237-4"><a href="#cb237-4" tabindex="-1"></a></span>
<span id="cb237-5"><a href="#cb237-5" tabindex="-1"></a><span class="co"># Results from standard table()</span></span>
<span id="cb237-6"><a href="#cb237-6" tabindex="-1"></a>result_table <span class="ot">&lt;-</span> <span class="fu">table</span>(a, b)</span>
<span id="cb237-7"><a href="#cb237-7" tabindex="-1"></a></span>
<span id="cb237-8"><a href="#cb237-8" tabindex="-1"></a><span class="co"># Results from optimized table2()</span></span>
<span id="cb237-9"><a href="#cb237-9" tabindex="-1"></a>result_table2 <span class="ot">&lt;-</span> <span class="fu">table2</span>(a, b)</span>
<span id="cb237-10"><a href="#cb237-10" tabindex="-1"></a></span>
<span id="cb237-11"><a href="#cb237-11" tabindex="-1"></a><span class="co"># Display comparison</span></span>
<span id="cb237-12"><a href="#cb237-12" tabindex="-1"></a><span class="fu">identical</span>(result_table, result_table2)</span></code></pre></div>
</div>
<div id="benchmarking-performance-1" class="section level3">
<h3>Benchmarking Performance</h3>
<p>The following benchmark compares the execution time of
<code>table()</code> and <code>table2()</code> with larger input
vectors.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" tabindex="-1"></a><span class="co"># Larger sample data for benchmarking</span></span>
<span id="cb238-2"><a href="#cb238-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">100</span>, <span class="dv">10000</span>, <span class="cn">TRUE</span>)</span>
<span id="cb238-3"><a href="#cb238-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">100</span>, <span class="dv">10000</span>, <span class="cn">TRUE</span>)</span>
<span id="cb238-4"><a href="#cb238-4" tabindex="-1"></a></span>
<span id="cb238-5"><a href="#cb238-5" tabindex="-1"></a><span class="co"># Benchmark</span></span>
<span id="cb238-6"><a href="#cb238-6" tabindex="-1"></a>bench<span class="sc">::</span><span class="fu">mark</span>(</span>
<span id="cb238-7"><a href="#cb238-7" tabindex="-1"></a>  <span class="at">base_table =</span> <span class="fu">table</span>(a, b),</span>
<span id="cb238-8"><a href="#cb238-8" tabindex="-1"></a>  <span class="at">optimized_table2 =</span> <span class="fu">table2</span>(a, b),</span>
<span id="cb238-9"><a href="#cb238-9" tabindex="-1"></a>  <span class="at">check =</span> <span class="cn">FALSE</span></span>
<span id="cb238-10"><a href="#cb238-10" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
</div>
<div id="hw-9-th" class="section level1">
<h1>HW 9-th</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>▶ Write an Rcpp function for Exercise 9.8.</p>
<p>▶ Compare the corresponding generated random numbers with those by
the R function you wrote using the function “qqplot”.</p>
<p>▶ Campare the computation time of the two functions with the function
“microbenchmark”.</p>
<p>▶ Comments your results.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>The target bivariate density is: <span class="math display">\[f(x, y)
\propto \binom{n}{x} y^{x + a - 1}(1-y)^{n-x + b - 1}, \quad x = 0, 1,
\dots, n, \; 0 \leq y \leq 1.\]</span></p>
<p>The conditional distributions are: - <span class="math inline">\(x
\sim \text{Binomial}(n, y)\)</span> - <span class="math inline">\(y \sim
\text{Beta}(x + a, n - x + b)\)</span>.</p>
<div id="rcpp-code" class="section level3">
<h3>Rcpp Code</h3>
<p>We first compile the C++ functions using the <code>Rcpp</code>
package.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" tabindex="-1"></a>Rcpp<span class="sc">::</span><span class="fu">sourceCpp</span>(<span class="st">&quot;gibbs_sampler.cpp&quot;</span>)</span></code></pre></div>
</div>
<div id="gibbs-sampler-function" class="section level3">
<h3>Gibbs Sampler Function</h3>
<p>The <code>gibbs_sampler</code> function generates a Markov chain
using the Gibbs sampling algorithm.</p>
<p><strong>Parameters</strong>: - <code>N</code>: Number of iterations.
- <code>a</code>, <code>b</code>: Shape parameters of the Beta
distribution. - <code>n</code>: Number of trials for the Binomial
distribution.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb240-2"><a href="#cb240-2" tabindex="-1"></a><span class="co"># Generate samples using the Gibbs sampler</span></span>
<span id="cb240-3"><a href="#cb240-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb240-4"><a href="#cb240-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb240-5"><a href="#cb240-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb240-6"><a href="#cb240-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb240-7"><a href="#cb240-7" tabindex="-1"></a>samples_cpp <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(N, a, b, n)</span>
<span id="cb240-8"><a href="#cb240-8" tabindex="-1"></a></span>
<span id="cb240-9"><a href="#cb240-9" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb240-10"><a href="#cb240-10" tabindex="-1"></a><span class="fu">plot</span>(samples_cpp, <span class="at">main =</span> <span class="st">&quot;Scatter Plot of Gibbs Samples (Rcpp)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
</div>
<div id="comparison-with-pure-r-implementation" class="section level3">
<h3>Comparison with Pure R Implementation</h3>
<p>We now implement the same Gibbs sampler in pure R.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" tabindex="-1"></a>gibbs_r <span class="ot">&lt;-</span> <span class="cf">function</span>(N, a, b, n) {</span>
<span id="cb241-2"><a href="#cb241-2" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb241-3"><a href="#cb241-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb241-4"><a href="#cb241-4" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb241-5"><a href="#cb241-5" tabindex="-1"></a>  </span>
<span id="cb241-6"><a href="#cb241-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb241-7"><a href="#cb241-7" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb241-8"><a href="#cb241-8" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb241-9"><a href="#cb241-9" tabindex="-1"></a>    samples[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb241-10"><a href="#cb241-10" tabindex="-1"></a>  }</span>
<span id="cb241-11"><a href="#cb241-11" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb241-12"><a href="#cb241-12" tabindex="-1"></a>}</span>
<span id="cb241-13"><a href="#cb241-13" tabindex="-1"></a></span>
<span id="cb241-14"><a href="#cb241-14" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb241-15"><a href="#cb241-15" tabindex="-1"></a>samples_r <span class="ot">&lt;-</span> <span class="fu">gibbs_r</span>(N, a, b, n)</span>
<span id="cb241-16"><a href="#cb241-16" tabindex="-1"></a></span>
<span id="cb241-17"><a href="#cb241-17" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb241-18"><a href="#cb241-18" tabindex="-1"></a><span class="fu">plot</span>(samples_r, <span class="at">main =</span> <span class="st">&quot;Scatter Plot of Gibbs Samples (Pure R)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
</div>
<div id="qq-plot" class="section level3">
<h3>QQ Plot</h3>
<p>To validate the similarity of the results, we compare the marginal
distributions of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> using <code>qqplot</code>.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" tabindex="-1"></a><span class="fu">qqplot</span>(samples_cpp[, <span class="dv">1</span>], samples_r[, <span class="dv">1</span>], <span class="at">main =</span> <span class="st">&quot;QQ Plot for X (Rcpp vs R)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Rcpp&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R&quot;</span>)</span>
<span id="cb242-2"><a href="#cb242-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb242-3"><a href="#cb242-3" tabindex="-1"></a></span>
<span id="cb242-4"><a href="#cb242-4" tabindex="-1"></a><span class="fu">qqplot</span>(samples_cpp[, <span class="dv">2</span>], samples_r[, <span class="dv">2</span>], <span class="at">main =</span> <span class="st">&quot;QQ Plot for Y (Rcpp vs R)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Rcpp&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R&quot;</span>)</span>
<span id="cb242-5"><a href="#cb242-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
</div>
<div id="performance-comparison" class="section level3">
<h3>Performance Comparison</h3>
<p>We compare the computation times of the Rcpp and pure R
implementations using <code>microbenchmark</code>.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb243-2"><a href="#cb243-2" tabindex="-1"></a>  <span class="at">rcpp =</span> <span class="fu">gibbs_sampler</span>(N, a, b, n),</span>
<span id="cb243-3"><a href="#cb243-3" tabindex="-1"></a>  <span class="at">pure_r =</span> <span class="fu">gibbs_r</span>(N, a, b, n),</span>
<span id="cb243-4"><a href="#cb243-4" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">10</span></span>
<span id="cb243-5"><a href="#cb243-5" tabindex="-1"></a>)</span>
<span id="cb243-6"><a href="#cb243-6" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
</div>
<div id="uniform-sampling-comparison" class="section level3">
<h3>Uniform Sampling Comparison</h3>
<p>As an additional demonstration, we compare random numbers generated
using <code>cpp_runif</code> with those from <code>runif</code>.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb244-2"><a href="#cb244-2" tabindex="-1"></a>cpp_uniform <span class="ot">&lt;-</span> <span class="fu">cpp_runif</span>(<span class="dv">1000</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb244-3"><a href="#cb244-3" tabindex="-1"></a>r_uniform <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb244-4"><a href="#cb244-4" tabindex="-1"></a></span>
<span id="cb244-5"><a href="#cb244-5" tabindex="-1"></a><span class="fu">qqplot</span>(cpp_uniform, r_uniform, <span class="at">main =</span> <span class="st">&quot;QQ Plot for Uniform Samples&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;cpp_runif&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;runif&quot;</span>)</span>
<span id="cb244-6"><a href="#cb244-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<ol style="list-style-type: decimal">
<li><strong>Correctness</strong>: The <code>qqplot</code> comparisons
demonstrate that the results of the Rcpp and pure R implementations are
nearly identical, confirming correctness.</li>
<li><strong>Performance</strong>: The Rcpp implementation is
significantly faster, as shown in the <code>microbenchmark</code>
results, especially for a larger number of iterations.</li>
<li><strong>Practicality</strong>: For computationally intensive tasks,
Rcpp is a valuable tool to optimize performance.</li>
</ol>
</div>
<div id="conclusion" class="section level3">
<h3>Conclusion</h3>
<p>This document shows how to implement a Gibbs sampler in Rcpp,
validate its correctness against a pure R implementation, and compare
computation times. Rcpp significantly reduces computation time, making
it ideal for large-scale simulations.</p>
</div>
</div>
</div>
<div id="classwork-10.14" class="section level1">
<h1>Classwork 10.14</h1>
<div id="class-work" class="section level2">
<h2>Class work</h2>
<p>Use the bootstrap method (R = 10000) to calculate the sample mean
difference for comparing the following two independent samples:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.961</span>, <span class="fl">0.478</span>, <span class="sc">-</span><span class="fl">0.391</span>, <span class="sc">-</span><span class="fl">0.869</span>, <span class="sc">-</span><span class="fl">0.460</span>, </span>
<span id="cb245-2"><a href="#cb245-2" tabindex="-1"></a>        <span class="sc">-</span><span class="fl">0.937</span>, <span class="fl">0.779</span>, <span class="sc">-</span><span class="fl">1.409</span>, <span class="fl">0.027</span>, <span class="sc">-</span><span class="fl">1.569</span>);</span>
<span id="cb245-3"><a href="#cb245-3" tabindex="-1"></a>d2  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.608</span>, <span class="fl">1.009</span>,  <span class="fl">0.878</span>,  <span class="fl">1.600</span>, <span class="sc">-</span><span class="fl">0.263</span>,  </span>
<span id="cb245-4"><a href="#cb245-4" tabindex="-1"></a>         <span class="fl">0.680</span>, <span class="fl">2.280</span>,  <span class="fl">2.390</span>, <span class="fl">1.793</span>,  <span class="fl">8.091</span>, <span class="fl">1.468</span>)</span></code></pre></div>
<p>The outputs should include original statistic, sample standard error,
and bootstrap standard error.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.961</span>, <span class="fl">0.478</span>, <span class="sc">-</span><span class="fl">0.391</span>, <span class="sc">-</span><span class="fl">0.869</span>, <span class="sc">-</span><span class="fl">0.460</span>, </span>
<span id="cb246-2"><a href="#cb246-2" tabindex="-1"></a>        <span class="sc">-</span><span class="fl">0.937</span>, <span class="fl">0.779</span>, <span class="sc">-</span><span class="fl">1.409</span>, <span class="fl">0.027</span>, <span class="sc">-</span><span class="fl">1.569</span>)</span>
<span id="cb246-3"><a href="#cb246-3" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.608</span>, <span class="fl">1.009</span>, <span class="fl">0.878</span>, <span class="fl">1.600</span>, <span class="sc">-</span><span class="fl">0.263</span>, </span>
<span id="cb246-4"><a href="#cb246-4" tabindex="-1"></a>        <span class="fl">0.680</span>, <span class="fl">2.280</span>, <span class="fl">2.390</span>, <span class="fl">1.793</span>, <span class="fl">8.091</span>, <span class="fl">1.468</span>)</span>
<span id="cb246-5"><a href="#cb246-5" tabindex="-1"></a></span>
<span id="cb246-6"><a href="#cb246-6" tabindex="-1"></a>original_mean_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(d1) <span class="sc">-</span> <span class="fu">mean</span>(d2)</span>
<span id="cb246-7"><a href="#cb246-7" tabindex="-1"></a></span>
<span id="cb246-8"><a href="#cb246-8" tabindex="-1"></a>sample_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(d1) <span class="sc">/</span> <span class="fu">length</span>(d1) <span class="sc">+</span> <span class="fu">var</span>(d2) <span class="sc">/</span> <span class="fu">length</span>(d2))</span>
<span id="cb246-9"><a href="#cb246-9" tabindex="-1"></a></span>
<span id="cb246-10"><a href="#cb246-10" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb246-11"><a href="#cb246-11" tabindex="-1"></a>bootstrap_diffs <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb246-12"><a href="#cb246-12" tabindex="-1"></a></span>
<span id="cb246-13"><a href="#cb246-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb246-14"><a href="#cb246-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb246-15"><a href="#cb246-15" tabindex="-1"></a>  sample_d1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(d1, <span class="fu">length</span>(d1), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb246-16"><a href="#cb246-16" tabindex="-1"></a>  sample_d2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(d2, <span class="fu">length</span>(d2), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb246-17"><a href="#cb246-17" tabindex="-1"></a>  bootstrap_diffs[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample_d1) <span class="sc">-</span> <span class="fu">mean</span>(sample_d2)</span>
<span id="cb246-18"><a href="#cb246-18" tabindex="-1"></a>}</span>
<span id="cb246-19"><a href="#cb246-19" tabindex="-1"></a></span>
<span id="cb246-20"><a href="#cb246-20" tabindex="-1"></a>bootstrap_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(bootstrap_diffs)</span>
<span id="cb246-21"><a href="#cb246-21" tabindex="-1"></a></span>
<span id="cb246-22"><a href="#cb246-22" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Original Mean Difference: &quot;</span>, original_mean_diff, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb246-23"><a href="#cb246-23" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Sample Standard Error: &quot;</span>, sample_se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb246-24"><a href="#cb246-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap Standard Error: &quot;</span>, bootstrap_se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
