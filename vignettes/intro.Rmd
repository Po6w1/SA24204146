---
title: "Introduction to the High-Dimensional Random Matrix Package"
author: "SA24204146"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to SA24204146}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Overview

The `SA24204146` package provides a collection of functions designed to analyze the spectrum of high-dimensional random matrices and simulate matrix properties such as diagonal dominance. These functions are useful for applications in random matrix theory and high-dimensional data analysis.

## Features

- **`analyze_random_matrix_spectrum`**: Analyzes the spectrum of a random matrix, including eigenvalue distributions and the Marcenko-Pastur density.
- **`monte_carlo_diagonal_dominance`**: Performs Monte Carlo simulations to estimate the proportion of diagonally dominant rows in random matrices.

---

# Functionality

## `analyze_random_matrix_spectrum`

### **Function Description**

The `analyze_random_matrix_spectrum` function computes the eigenvalues of a random matrix and compares the empirical spectral density to the theoretical Marcenko-Pastur distribution. It optionally plots the results for visual comparison.

- **Inputs**:
  - `n`: Number of rows in the random matrix.
  - `p`: Number of columns in the random matrix.
  - `mean`: Mean of the random entries (default is 0).
  - `sd`: Standard deviation of the random entries (default is 1).
  - `bandwidth`: Bandwidth parameter for kernel density estimation (default is 0.1).
  - `plot`: Whether to plot the results (default is TRUE).

- **Outputs**:
  - A list containing the eigenvalues, the Marcenko-Pastur density, and the kernel density estimate.

### **Example Usage**:

```{r}
library(SA24204146)

# Analyze the spectrum of a random matrix with 500 rows and 400 columns
result <- analyze_random_matrix_spectrum(n = 500, p = 400, bandwidth = 0.1)
```

---

## `monte_carlo_diagonal_dominance`

### **Function Description**

The function `monte_carlo_diagonal_dominance` estimates the distribution of diagonally dominant row proportions in a square random matrix. 

A row is considered **diagonally dominant** if the magnitude of its diagonal entry is strictly greater than the sum of the magnitudes of all its other entries in that row.

### Parameters:
- `n`: Number of rows (and columns) in the square matrix.
- `num_sim`: Number of Monte Carlo simulations (default: 1000).
- `dist`: Distribution for generating random matrix entries. Options:
  - `"normal"`: Entries follow the standard normal distribution.
  - `"uniform"`: Entries follow a uniform distribution in \([-1, 1]\).

### Return Value:
- A **ggplot2 object** visualizing the histogram and density of diagonally dominant row proportions.

---

### **Example Usage**

To simulate and analyze the diagonally dominant row proportions for matrices with different distributions:

```{R}
library(SA24204146)

# Example 1: Normal distribution
set.seed(123)
p1 <- monte_carlo_diagonal_dominance(n = 5, num_sim = 1000, dist = "normal")
print(p1)

# Example 2: Uniform distribution
set.seed(123)
p2 <- monte_carlo_diagonal_dominance(n = 5, num_sim = 1000, dist = "uniform")
print(p2)
```

---

# Visualizations

### Example Plot 1:

Here is an example plot generated by the `analyze_random_matrix_spectrum` function, which shows the comparison between the empirical kernel density estimate and the theoretical Marcenko-Pastur distribution.


```{r}
# Define the range of the theoretical Marcenko-Pastur distribution
q <- 400 / 500  # p / n
lambda_min <- (1 - sqrt(q))^2
lambda_max <- (1 + sqrt(q))^2

# Compute the Marcenko-Pastur density over the theoretical range
x_seq <- seq(lambda_min, lambda_max, length.out = 1000)
mp_values <- sapply(x_seq, result$mp_density)

# Plot the results
plot(result$kernel_density, main = "Spectral Density of Random Matrix",
     xlab = "Eigenvalue", ylab = "Density", col = "blue", lwd = 2)
lines(x_seq, mp_values, col = "red", lwd = 2, lty = 2)
legend("topright", legend = c("Empirical (KDE)", "Marcenko-Pastur"),
       col = c("blue", "red"), lwd = 2, lty = c(1, 2))


```

### Example Plot 2:

The following is an example visualization showing the distribution of diagonally dominant row proportions when `n = 5` and the matrix entries are generated from a **normal distribution**.

```{R}
library(SA24204146)

# Generate and visualize the distribution
set.seed(123)
p <- monte_carlo_diagonal_dominance(n = 5, num_sim = 1000, dist = "normal")
print(p)
```

---

# Implementation Details

### Rcpp Integration

The package utilizes `Rcpp` to optimize matrix computations, particularly for the calculation of diagonal dominance in random matrices. Below is the C++ implementation for calculating the proportion of diagonally dominant rows in a matrix.

```cpp
#include <RcppArmadillo.h>

// [[Rcpp::export]]
double diagonal_dominance_cpp(const Rcpp::NumericMatrix& mat) {

  // Convert Rcpp matrix to Armadillo matrix
  arma::mat A = Rcpp::as<arma::mat>(mat);
  
  // Check if the matrix is square
  if (A.n_rows != A.n_cols) {
    Rcpp::stop("Input matrix must be square.");
  }
  
  int n = A.n_rows;
  int dominant_rows = 0; // Count of diagonally dominant rows

  for (int i = 0; i < n; ++i) {
    double diag_value = std::abs(A(i, i)); // Absolute value of diagonal element
    double row_sum = 0.0;

    for (int j = 0; j < n; ++j) {
      if (i != j) {
        row_sum += std::abs(A(i, j)); // Sum of absolute values of off-diagonal elements
      }
    }

    // Check diagonal dominance
    if (diag_value > row_sum) {
      dominant_rows++;
    }
  }

  // Return the proportion of diagonally dominant rows
  return static_cast<double>(dominant_rows) / n;
}
```

This function calculates the proportion of diagonally dominant rows in a square matrix by checking if the absolute value of the diagonal element in each row exceeds the sum of the absolute values of the off-diagonal elements.

---

# Conclusion

The `SA24204146` package offers powerful tools for analyzing high-dimensional random matrices, particularly in terms of their spectral properties and diagonal dominance. By leveraging `Rcpp` for performance optimization, the package ensures efficient handling of large matrices, making it a valuable tool for researchers and practitioners working in random matrix theory and high-dimensional data analysis.

